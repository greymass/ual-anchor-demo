(window["webpackJsonpual-anchor-demo"]=window["webpackJsonpual-anchor-demo"]||[]).push([[0],{163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Name="Anchor"},164:function(e,t,n){"use strict";var r=n(2),a=n(5),o=n(7),c=n(14),i=n(12),s=n(15),u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var l=n(94),h=n(24),d=n(165),f=function(e){function t(e,n){var r;a(this,t),(r=c(this,i(t).call(this))).accountName="",r.requestPermission="",r.chain=e,r.accountName=n.auth.actor,r.requestPermission=n.auth.permission,r.authorityProvider=n.makeAuthorityProvider(),r.signatureProvider=n.makeSignatureProvider();var o=r.chain.rpcEndpoints[0],s="".concat(o.protocol,"://").concat(o.host,":").concat(o.port);return r.rpc=new h.JsonRpc(s),r.api=new h.Api({authorityProvider:r.authorityProvider,rpc:r.rpc,signatureProvider:r.signatureProvider}),r}return s(t,e),o(t,[{key:"signTransaction",value:function(e,t){var n=t.broadcast,a=void 0===n||n,o=t.blocksBehind,c=void 0===o?3:o,i=t.expireSeconds,s=void 0===i?30:i;return u(this,void 0,void 0,r.mark((function t(){var n,o,i,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.api.transact(e,{broadcast:a,blocksBehind:c,expireSeconds:s});case 3:return n=t.sent,t.abrupt("return",this.returnEosjsTransaction(a,n));case 7:throw t.prev=7,t.t0=t.catch(0),o=t.t0.message?t.t0.message:"Unable to sign transaction",i=l.UALErrorType.Signing,u=t.t0,new d.UALAnchorError(o,i,u);case 13:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"signArbitrary",value:function(e,t,n){return u(this,void 0,void 0,r.mark((function n(){return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:throw console.log("signArbitrary",e,t),new d.UALAnchorError("Anchor does not currently support signArbitrary",l.UALErrorType.Unsupported,null);case 2:case"end":return n.stop()}}),n)})))}},{key:"verifyKeyOwnership",value:function(e){return u(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw console.log("verifyKeyOwnership",e),new d.UALAnchorError("Anchor does not currently support verifyKeyOwnership",l.UALErrorType.Unsupported,null);case 2:case"end":return t.stop()}}),t)})))}},{key:"getAccountName",value:function(){return u(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.accountName);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getChainId",value:function(){return u(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.chain.chainId);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getKeys",value:function(){return u(this,void 0,void 0,r.mark((function e(){var t,n,a,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getKeys"),e.prev=1,e.next=4,this.signatureProvider.getAvailableKeys(this.requestPermission);case 4:return t=e.sent,e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(1),n="Unable to getKeys for account ".concat(this.accountName,".\n        Please make sure your wallet is running."),a=l.UALErrorType.DataRequest,o=e.t0,new d.UALAnchorError(n,a,o);case 14:case"end":return e.stop()}}),e,this,[[1,8]])})))}},{key:"isAccountValid",value:function(){return u(this,void 0,void 0,r.mark((function e(){var t,n,a,o,c,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("isAccountValid"),e.prev=1,e.t0=this.rpc,!e.t0){e.next=7;break}return e.next=6,this.rpc.get_account(this.accountName);case 6:e.t0=e.sent;case 7:return t=e.t0,n=this.extractAccountKeys(t),e.next=11,this.getKeys();case 11:return a=e.sent,e.abrupt("return",n.filter((function(e){return-1!==a.indexOf(e)})).length>0);case 15:if(e.prev=15,e.t1=e.catch(1),"UALAnchorError"!==e.t1.constructor.name){e.next=19;break}throw e.t1;case 19:throw o="Account validation failed for account ".concat(this.accountName,"."),c=l.UALErrorType.Validation,i=e.t1,new d.UALAnchorError(o,c,i);case 23:case"end":return e.stop()}}),e,this,[[1,15]])})))}},{key:"extractAccountKeys",value:function(e){console.log("extractAccountKeys",e);var t=e.permissions.map((function(e){return e.required_auth.keys.map((function(e){return e.key}))})),n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done);r=!0){var s=c.value;n=n.concat(s)}}catch(u){a=!0,o=u}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}}]),t}(l.User);t.AnchorUser=f},165:function(e,t,n){"use strict";var r=n(5),a=n(14),o=n(12),c=n(15);Object.defineProperty(t,"__esModule",{value:!0});var i=n(94),s=n(163),u=function(e){function t(e,n,c){return r(this,t),a(this,o(t).call(this,e,n,c,s.Name))}return c(t,e),t}(i.UALError);t.UALAnchorError=u},222:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(239)),r(n(164))},233:function(e,t,n){e.exports=n(542)},239:function(e,t,n){"use strict";var r=n(2),a=n(92),o=n(5),c=n(7),i=n(14),s=n(12),u=n(15),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function c(e){try{s(r.next(e))}catch(t){o(t)}}function i(e){try{s(r.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((r=r.apply(e,t||[])).next())}))},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(94),f=n(251),p=n(163),g=n(164),m=n(323),v=n(165),y=h(n(543)),b=function(e){function t(e,n){var r;if(o(this,t),(r=i(this,s(t).call(this,e))).users=[],r.anchorIsLoading=!0,r.storage=n.sessionStorage||new I,r.service=n.service||"https://cb.anchor.link",r.sessionId=e[0].chainId,r.users=[],!n||!n.appName)throw new v.UALAnchorError("Anchor requires the appName property to be set on the `options` argument.",d.UALErrorType.Initialization,null);return r.appName="".concat(n.appName,"-").concat(e[0].chainId),r}return u(t,e),c(t,[{key:"init",value:function(){return l(this,void 0,void 0,r.mark((function e(){var t,n,o,c,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.anchorIsLoading=!0,t=a(this.chains,1),n=t[0],o=a(n.rpcEndpoints,1),c=o[0],this.link=new f.Link({chainId:n.chainId,rpc:"".concat(c.protocol,"://").concat(c.host,":").concat(c.port),service:this.service,transport:new y.default}),(i=this.storage.restore(this.link,this.sessionId))&&(this.users=[new g.AnchorUser(n,i)]),this.anchorIsLoading=!1;case 7:case"end":return e.stop()}}),e,this)})))}},{key:"reset",value:function(){this.users=[]}},{key:"isErrored",value:function(){return!1}},{key:"getOnboardingLink",value:function(){return"https://github.com/greymass/anchor/"}},{key:"getError",value:function(){return null}},{key:"isLoading",value:function(){return this.anchorIsLoading}},{key:"getStyle",value:function(){return{icon:m.AnchorLogo,text:p.Name,textColor:"white",background:"#3650A2"}}},{key:"shouldRender",value:function(){return this.isLoading()}},{key:"shouldAutoLogin",value:function(){return this.users.length>0}},{key:"shouldRequestAccountName",value:function(){return l(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})))}},{key:"login",value:function(){return l(this,void 0,void 0,r.mark((function e(){var t,n,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.chains.length>1)){e.next=2;break}throw new v.UALAnchorError("UAL-Anchor does not yet support providing multiple chains to UAL. Please initialize the UAL provider with a single chain.",d.UALErrorType.Unsupported,null);case 2:if(e.prev=2,0!==this.users.length){e.next=11;break}return t=a(this.chains,1),n=t[0],e.next=7,this.link.login(this.appName);case 7:return o=e.sent,e.next=10,this.storage.store(o.session,this.sessionId);case 10:this.users=[new g.AnchorUser(n,o.session)];case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(2),new v.UALAnchorError(e.t0.message,d.UALErrorType.Login,e.t0);case 16:return e.abrupt("return",this.users);case 17:case"end":return e.stop()}}),e,this,[[2,13]])})))}},{key:"logout",value:function(){return l(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.remove(this.sessionId);case 2:this.reset();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"requiresGetKeyConfirmation",value:function(){return!1}}]),t}(d.Authenticator);t.Anchor=b;var I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"anchorlink";o(this,e),this.keyPrefix=t}return c(e,[{key:"sessionKey",value:function(e,t){return[this.keyPrefix,e,t].filter((function(e){return"string"===typeof e&&e.length>0})).join("-")}},{key:"store",value:function(e,t,n){return l(this,void 0,void 0,r.mark((function a(){var o,c;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=this.sessionKey(t,n),c=e.serialize(),localStorage.setItem(o,JSON.stringify(c));case 3:case"end":return r.stop()}}),a,this)})))}},{key:"restore",value:function(e,t,n){var r=this.sessionKey(t,n),a=JSON.parse(localStorage.getItem(r)||"null");return a?f.LinkSession.restore(e,a):null}},{key:"remove",value:function(e,t){return l(this,void 0,void 0,r.mark((function n(){return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:localStorage.removeItem(this.sessionKey(e,t));case 1:case"end":return n.stop()}}),n,this)})))}}]),e}()},273:function(e,t){},275:function(e,t){},323:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnchorLogo="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS40NCwgMCwgMCwgMS40NCwgLTguNTAxOTI1LCAtNTcuMDc0NTcpIiBzdHlsZT0iIj4KICAgIDx0aXRsZT5XaGl0ZTwvdGl0bGU+CiAgICA8Y2lyY2xlIGN4PSI5NC43OTMiIGN5PSIxMjguNTI0IiByPSI4MCIgZmlsbD0iI0ZCRkRGRiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0gOTQuNzk5IDc4LjUyNCBDIDk3LjA5OCA3OC41MjQgOTkuMTk1IDc5LjgzNyAxMDAuMTk4IDgxLjkwNiBMIDEyNC4yMDQgMTMxLjQwNiBMIDEyNC43NDYgMTMyLjUyNCBMIDExMS40MDkgMTMyLjUyNCBMIDEwNy41MyAxMjQuNTI0IEwgODIuMDY5IDEyNC41MjQgTCA3OC4xODkgMTMyLjUyNCBMIDY0Ljg1MyAxMzIuNTI0IEwgNjUuMzk1IDEzMS40MDYgTCA4OS40MDEgODEuOTA2IEMgOTAuNDA0IDc5LjgzNyA5Mi41MDEgNzguNTI0IDk0Ljc5OSA3OC41MjQgWiBNIDg2LjkxOSAxMTQuNTI0IEwgMTAyLjY4IDExNC41MjQgTCA5NC43OTkgOTguMjc0IEwgODYuOTE5IDExNC41MjQgWiBNIDExMi43OTMgMTQ5LjUyNCBMIDEyNC43OTggMTQ5LjUyNCBDIDEyNC40MzcgMTY1LjY3NiAxMTEuMDY3IDE3OC41MjQgOTQuNzk5IDE3OC41MjQgQyA3OC41MzIgMTc4LjUyNCA2NS4xNjIgMTY1LjY3NiA2NC44MDEgMTQ5LjUyNCBMIDc2LjgwNiAxNDkuNTI0IEMgNzcuMDg3IDE1Ni44NzggODEuOTc0IDE2My4xNTUgODguNzkzIDE2NS41MiBMIDg4Ljc5MyAxNDEuNTI0IEMgODguNzkzIDEzOC4yMSA5MS40OCAxMzUuNTI0IDk0Ljc5MyAxMzUuNTI0IEMgOTguMTA3IDEzNS41MjQgMTAwLjc5MyAxMzguMjEgMTAwLjc5MyAxNDEuNTI0IEwgMTAwLjc5MyAxNjUuNTI0IEMgMTA3LjYyIDE2My4xNjIgMTEyLjUxMSAxNTYuODgzIDExMi43OTMgMTQ5LjUyNCBaIiBmaWxsPSIjMzY1MEEyIi8+CiAgPC9nPgo8L3N2Zz4="},421:function(e,t){},442:function(e,t){},443:function(e,t){},542:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),o=n(221),c=n.n(o),i=n(231),s=n(32),u=n(2),l=n.n(u),h=n(16),d=n(18),f=n(26),p=n(29),g=n(23),m=n(28),v=n(222),y=n(227),b=n(228),I=n(122),w=[{chainId:"0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72",name:"Block.one Testnet",rpcEndpoints:[{protocol:"https",host:"api.testnet.eos.io",port:443}]},{chainId:"b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e",name:"FIO (Testnet)",rpcEndpoints:[{protocol:"https",host:"fiotestnet.greymass.com",port:443}]},{chainId:"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473",name:"Jungle 2 (Testnet)",rpcEndpoints:[{protocol:"https",host:"jungle.greymass.com",port:443}]},{chainId:"2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840",name:"Jungle 3 (Testnet)",rpcEndpoints:[{protocol:"https",host:"jungle3.greymass.com",port:443}]},{chainId:"f11d5128e07177823924a07df63bf59fbd07e52c44bc77d16acc1c6e9d22d37b",name:"Lynx (Testnet)",rpcEndpoints:[{protocol:"https",host:"lynxtestnet.greymass.com",port:443}]},{chainId:"1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f",name:"Telos (Testnet)",rpcEndpoints:[{protocol:"https",host:"testnet.eos.miami",port:443}]},{chainId:"f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12",name:"WAX (Testnet)",rpcEndpoints:[{protocol:"https",host:"waxtestnet.greymass.com",port:443}]}],A=function(e,t,n){var r="eosio.token",a="transfer",o={from:e,to:"teamgreymass",quantity:k(n),memo:"ual-anchor-demo"};switch(n){case"0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72":o={from:e,to:"csxdbqrkklmm",quantity:k(n),memo:"ual-anchor-demo"};break;case"b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e":r="fio.token",a="trnsfiopubky",o={payee_public_key:"FIO6smr7ThQMWYBHzEvkzTZdxNNmUwxqh2VXdXZdDdzYHgakgqCeb",amount:k(n),max_fee:2e9,actor:e,tpid:null}}return{actions:[{account:r,name:a,authorization:[{actor:e,permission:t}],data:o}]}},k=function(e){var t="EOS",n="0.0001";switch(e){case"0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72":t="TNT";break;case"f11d5128e07177823924a07df63bf59fbd07e52c44bc77d16acc1c6e9d22d37b":t="LNX",n="0.00000001";break;case"1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f":t="TLOS";break;case"f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12":t="WAX",n="0.00000001";break;case"b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e":return parseInt(1e-8,10)}return"".concat(n," ").concat(t)},M=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).purchase=Object(h.a)(l.a.mark((function e(){var t,r,a,o,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.ual.activeUser,e.prev=1,r=t.accountName,a=t.chain,o=t.requestPermission,c=a.chainId,i=A(r,o,c),e.next=7,t.signTransaction(i,{expireSeconds:120,blocksBehind:3});case 7:s=e.sent,n.setState({message:"Transfer Successful!"},(function(){setTimeout(n.resetMessage,5e3)})),console.info("SUCCESS:",s),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("ERROR:",e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])}))),n.resetMessage=function(){return n.setState({message:""})},n.renderLoggedInView=function(){return a.a.createElement(a.a.Fragment,null,!!n.state.message&&a.a.createElement("div",{style:x.announcementBar},a.a.createElement("p",{style:x.baseText},n.state.message)),a.a.createElement("button",{type:"button",onClick:n.purchase,style:Object(s.a)({},x.button,{},x.blueBG)},a.a.createElement("p",{style:x.baseText},"Transfer 0.0001")),a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",{style:x.td},"Blockchain"),a.a.createElement("td",{style:x.td},n.props.ual.chains[0].name)),a.a.createElement("tr",null,a.a.createElement("td",{style:x.td},"Account"),a.a.createElement("td",{style:x.td},n.props.ual.activeUser.accountName)),a.a.createElement("tr",null,a.a.createElement("td",{style:x.td},"Permission"),a.a.createElement("td",{style:x.td},n.props.ual.activeUser.requestPermission)))),a.a.createElement("button",{type:"button",onClick:n.props.ual.logout,style:x.logout},a.a.createElement("p",null,"Logout")))},n.renderLoginButton=function(){return a.a.createElement("button",{type:"button",onClick:n.props.ual.showModal,style:x.button},a.a.createElement("p",{style:{buttonText:x.buttonText,baseText:x.baseText}},"Login using ",n.props.ual.chains[0].name))},n.state={chainId:e.chainId,message:""},n}return Object(m.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return this.props.ual.activeUser?this.renderLoggedInView():this.renderLoginButton()}}]),t}(r.Component),E=function(e){function t(e){var n;Object(d.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).setChain=function(e){return n.setState({chainId:e.target.value})};var r=window.location.search,a=new URLSearchParams(r).get("chain");return n.state={chainId:a||w[0].chainId},n}return Object(m.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state.chainId,t=this.props.available.filter((function(t){return t.chainId===e})),n=Object(i.a)(t,1)[0];if(!n)return a.a.createElement("div",null,"Invalid Chain ID");var r=new v.Anchor([n],{appName:"ual-anchor-demo",service:"https://cb.anchor.link"}),o=new y.Ledger([n]),c=new b.Scatter([n],{appName:"ual-anchor-demo"});return a.a.createElement("div",{style:x.container},a.a.createElement("p",null,a.a.createElement("select",{defaultValue:e,onChange:this.setChain,style:x.select},w.map((function(e){return a.a.createElement("option",{key:e.chainId,value:e.chainId},e.name)})))),a.a.createElement(I.UALProvider,{appName:"Anchor + Authenticator Test App",authenticators:[r,o,c],chains:[n],key:n.chainId},a.a.createElement(N,null)))}}]),t}(r.Component),x={container:{display:"flex",backgroundColor:"#fff",alignItems:"center",justifyContent:"top",height:"100vh",marginTop:"10vh",flexDirection:"column"},button:{padding:"10px 60px",backgroundColor:"#EA2E2E",textAlign:"center",borderRadius:5,color:"#FFFFFF",fontSize:18,fontWeight:"bold",marginBottom:"2em"},select:{textAlign:"center",borderRadius:5,fontSize:24,fontWeight:"bold",width:"200px"},logout:{marginTop:20},baseText:{color:"#fff",fontSize:18},blueBG:{backgroundColor:"#447DD8"},announcementBar:{width:"100%",padding:"10px 50px 10px 20px",textAlign:"center",backgroundColor:"#3de13d",top:0,position:"absolute",alignItems:"center"}},N=Object(I.withUAL)(M),T=function(){return a.a.createElement(E,{available:w})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[233,1,2]]]);
//# sourceMappingURL=main.6b7f5368.chunk.js.map