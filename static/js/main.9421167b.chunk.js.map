{"version":3,"sources":["../../../eosjs-ecc/lib/aes.js","../../../eosjs-ecc/lib/signature.js","../../../eosjs-ecc/lib/enforce_types.js","../../ual-anchor/dist/interfaces.js","../../ual-anchor/dist/AnchorUser.js","../../ual-anchor/dist/UALAnchorError.js","../../ual-anchor/dist/index.js","../../anchor-link/lib/link-abi-data.js","../../anchor-link/lib/errors.js","../../ual-anchor/dist/Anchor.js","../../anchor-link/lib/index.js","../../../eosjs-ecc/lib/api_common.js","../../../eosjs-ecc/lib/promise-async.js","../../../eosjs-ecc/lib/ecdsa.js","../../../eosjs-ecc/lib/ecsignature.js","../../../eosjs-ecc/lib/api_object.js","../../ual-anchor/dist/AnchorLogo.js","../../anchor-link/lib/utils.js","../../../eosjs-ecc/lib/index.js","../../../eosjs-ecc/lib/hash.js","App.js","serviceWorker.js","index.js","../../anchor-link-browser-transport/lib/index.js","../../anchor-link-browser-transport/lib/styles.js","../../anchor-link/lib/link-session.js","../../../eosjs-ecc/lib/key_public.js","../../../eosjs-ecc/lib/key_utils.js","../../../eosjs-ecc/lib/key_private.js","../../anchor-link/lib/link.js","../../anchor-link/lib/link-options.js"],"names":["randomBytes","ByteBuffer","crypto","assert","PublicKey","PrivateKey","hash","Long","crypt","private_key","public_key","nonce","message","checksum","TypeError","toLongObj","Buffer","isBuffer","S","getSharedSecret","ebuf","DEFAULT_CAPACITY","LITTLE_ENDIAN","writeUint64","append","toString","copy","offset","toBinary","encryption_key","sha512","iv","slice","key","check","sha256","cbuf","fromBinary","readUint32","Error","toBinaryBuffer","decipher","createDecipheriv","concat","update","cryptoJsDecrypt","cipher","createCipheriv","cryptoJsEncrypt","uniqueNonce","unique_nonce_entropy","b","Uint8Array","parseInt","_long","fromNumber","Date","now","entropy","shiftLeft","or","module","exports","encrypt","arguments","length","undefined","decrypt","o","isLong","fromString","_interopRequireDefault","_slicedToArray2","_typeof2","ecdsa","curve","getCurveByName","BigInteger","keyUtils","Signature","r","s","i","verify","data","pubkey","encoding","from","verifyHash","dataSha256","publicKey","Q","recover","console","log","recoverHash","e","fromBuffer","i2","recoverPubKey","fromPoint","toBuffer","buf","writeUInt8","signatureCache","equal","verifyHex","hex","toHex","checkEncode","verifyBuffer","apply","recoverPublicKey","recoverPublicKeyFromBuffer","sign","privateKey","signHash","der","ecsignature","lenR","lenS","d","toDER","calcPubKeyRecoveryParam","toPublic","readUInt8","fromHex","signature","fromStringOrThrow","match","_match","keyType","keyString","checkDecode","getName","fn","type","value","Array","isArray","constructor","Object","defineProperty","Name","_regeneratorRuntime","_classCallCheck","_createClass","_possibleConstructorReturn","_getPrototypeOf","_inherits","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","universal_authenticator_library_1","UALAnchorError_1","AnchorUser","_universal_authentica","rpc","session","_this","call","accountName","requestPermission","chainId","link","auth","actor","permission","transaction","options","mark","_callee","completedTransaction","cause","wrap","_context","prev","transact","sent","abrupt","returnEosjsTransaction","broadcast","t0","UALErrorType","Signing","UALAnchorError","stop","_","_callee2","_context2","Unsupported","challenge","_callee3","_context3","_callee4","_context4","_callee5","_context5","_callee6","keys","_context6","signatureProvider","getAvailableKeys","DataRequest","_callee7","account","actualKeys","authorizationKeys","_context7","get_account","extractAccountKeys","getKeys","filter","indexOf","t1","name","Validation","keySubsets","permissions","map","required_auth","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","keySubset","err","return","User","interfaces_1","UALError","__export","m","p","hasOwnProperty","version","types","structs","base","fields","actions","ricardian_clauses","error_messages","tables","abi_extensions","CancelError","_Error","reason","code","IdentityError","_Error2","_this2","SessionError","_Error3","_this3","_slicedToArray","__importDefault","mod","__esModule","anchor_link_1","AnchorUser_1","AnchorLogo_1","anchor_link_browser_transport_1","Anchor","chains","users","service","chain","rpcEndpoints","protocol","host","port","appName","Initialization","_rpc","fetchBuiltin","bind","window","default","transport","requestStatus","restoreSession","icon","AnchorLogo","text","textColor","background","isLoading","identity","login","Login","_this$users","user","removeSession","reset","Authenticator","ecc","initialize","unsafeRandomKey","randomKey","cpuEntropyBits","seedPrivate","seed","fromSeed","privateToPublic","wif","pubkey_prefix","isValidPublic","isValid","isValidPrivate","resultEncoding","func","_len","args","_key","setTimeout","enforceType","ECSignature","deterministicGenerateK","checkSig","x","k","v","fill","HmacSHA256","T","signum","compareTo","n","verifyRaw","G","c","modInverse","u1","multiply","u2","R","multiplyTwo","isInfinity","affineX","equals","strictEqual","isYOdd","add","pointFromX","nR","eNeg","negate","rInv","validate","N_OVER_TWO","shiftRight","subtract","rBa","toDERInteger","sBa","sequence","push","unshift","toCompact","compressed","buffer","toScriptSignature","hashType","hashTypeBuffer","parseCompact","fromDER","rLen","sLen","rB","sB","fromDERInteger","parseScriptSignature","hashTypeMod","Aes","key_utils","getTypesFromAbi","createInitialTypes","abiEncode","typeName","get","SerialBuffer","serialize","asUint8Array","sealMessage","res","ciphertext","normalizePublicKey","startsWith","publicKeyToString","stringToPublicKey","substr","publicKeyEqual","keyA","keyB","generatePrivateKey","_generatePrivateKey","Uint32Array","getRandomValues","commonApi","objectApi","assign","createHash","createHmac","sha1","digest","secret","ripemd160","getActionData","to","quantity","getTransactionAmount","memo","payee_public_key","amount","max_fee","tpid","getContractData","getActions","authorization","symbol","TestApp","props","purchase","a","activeUser","ual","scatter","accounts","authority","demoActions","signTransaction","expireSeconds","blocksBehind","setState","resetMessage","info","error","renderLoggedInView","state","style","styles","announcementBar","baseText","onClick","button","blueBG","td","logout","renderLoginButton","showModal","buttonText","Component","UALWrapper","setChain","event","target","search","location","URLSearchParams","available","anchor","ledger","Ledger","Scatter","container","defaultValue","onChange","select","authenticators","TestAppConsumer","display","backgroundColor","alignItems","justifyContent","height","marginTop","flexDirection","padding","textAlign","borderRadius","color","fontSize","fontWeight","marginBottom","width","top","position","withUAL","App","Boolean","hostname","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","Storage","keyPrefix","_write","localStorage","setItem","storageKey","_x","_x2","_read","getItem","_x3","_remove","removeItem","_x4","BrowserTransport","classPrefix","injectStyles","storage","storagePrefix","styleEl","createElement","css","replace","appendChild","createTextNode","head","containerEl","createEl","className","onclick","stopPropagation","hide","activeCancel","activeRequest","body","requestEl","wrapper","class","attrs","el","tag","_i","_Object$keys","attr","setAttribute","classList","remove","clearTimers","_displayRequest","request","sameDeviceRequest","sameDeviceUri","crossDeviceUri","isIdentity","title","subtitle","qrEl","linkEl","linkA","infoEl","infoTitle","infoSubtitle","actionEl","logoEl","setupElements","clone","setInfoKey","returnUrl","encode","margin","errorCorrectionLevel","innerHTML","href","addEventListener","preventDefault","emptyElement","show","_x5","cancel","displayRequest","catch","metadata","sameDevice","onRequest","timeout","deviceName","start","updateCountdown","timeLeft","timeFormatted","toISOString","textContent","countdownTimer","setInterval","test","userAgent","closeTimer","clearTimeout","String","firstChild","removeChild","returnUrlAlphabet","returnUrlAlphabetLen","rv","split","charAt","Math","floor","random","LinkSession","identifier","LinkChannelSession","LinkFallbackSession","_LinkSession","channel","requestKey","onSuccess","onFailure","expiration","onSessionRequest","url","method","headers","toFixed","response","status","makeSignatureProvider","makeAuthorityProvider","tx","_LinkSession2","ecurve","secp256k1","getEncoded","toUncompressed","point","Point","decodeFrom","child","cG","Qprime","bin","prefix_match","RegExp","substring","fromStringHex","base58","random32ByteBuffer","_ref","_ref$cpuEntropyBits","_ref$safe","safe","_entropyCount","hash_array","cpuEntropy","externalEntropyArray","browserEntropy","addEntropy","ints","_ints","pos","entropyPos","entropyCount","newCheck","decode","keyBuffer","_checksum","collected","lastCount","lowEntropySamples","count","floatingPointCount","delta","abs","bits","log2","pct","Number","warn","sin","sqrt","LN2","entropyStr","join","screen","colorDepth","availHeight","availWidth","pixelDepth","language","history","mimeType","mimeTypes","description","suffixes","start_t","_toConsumableArray2","promiseAsync","isBigInteger","toWif","KB","KBP","fromAffine","size","getChildKey","parseKey","privateStr","versionKey","format","isWif","fromWif","str","initialized","pvt","pvtError","pub","doesNotThrow","unitTest","cb","msg","fetch","Link","abiCache","Map","serviceAddress","trim","requestOptions","abiProvider","textDecoder","TextDecoder","textEncoder","TextEncoder","zlib","_getAbi","get_abi","abi","set","_createRequest","create","callback","createCallbackUrl","_sendRequest","t","linkUrl","ctx","socket","payload","signer","signatures","resolved","serializedTransaction","_args3","flags","waitForCallback","race","sa","sp","fromPayload","push_transaction","processed","_transact","_ref$broadcast","_ref$sign","_args4","action","linkTransact","_linkTransact","createRequest","sendRequest","_x6","_x7","_identify","signerKey","keyAuth","getChainId","alloc","find","_ref2","perm_name","_ref3","formatAuth","threshold","weight","_x8","_x9","_login","createInfo","session_name","request_key","identify","getRawInfo","link_ch","link_key","link_name","storeSession","_x10","_restoreSession","_callee8","latest","sessionData","_context8","sessionKey","listSessions","read","JSON","parse","restore","touchSession","_x11","_x12","_listSessions","_callee9","list","_context9","t2","t3","_x13","_removeSession","_callee10","_context10","_x14","_x15","_clearSessions","_callee11","_context11","finish","_x16","availableKeys","_getAvailableKeys","_callee12","_context12","_sign","_callee13","_ref4","_context13","fromTransaction","setCallback","setBroadcast","_x17","getRequiredKeys","_callee14","_context14","available_keys","required_keys","_touchSession","_callee15","auths","formattedAuth","existing","_args15","_context15","findIndex","splice","write","stringify","_x18","_x19","_storeSession","_callee16","_context16","_x20","_x21","suffix","active","retries","socketUrl","handleResponse","connect","readyState","OPEN","CONNECTING","close","onmessage","Blob","reader","FileReader","onload","onerror","readAsText","onopen","onclose","tries","min","pow","defaults"],"mappings":"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","file":"static/js/main.9421167b.chunk.js","sourcesContent":["\"use strict\";\n\nvar randomBytes = require('randombytes');\n\nvar ByteBuffer = require('bytebuffer');\n\nvar crypto = require('browserify-aes');\n\nvar assert = require('assert');\n\nvar PublicKey = require('./key_public');\n\nvar PrivateKey = require('./key_private');\n\nvar hash = require('./hash');\n\nvar Long = ByteBuffer.Long;\nmodule.exports = {\n  encrypt: encrypt,\n  decrypt: decrypt\n};\n/**\n    Spec: http://localhost:3002/steem/@dantheman/how-to-encrypt-a-memo-when-transferring-steem\n\n    @throws {Error|TypeError} - \"Invalid Key, ...\"\n\n    @arg {PrivateKey} private_key - required and used for decryption\n    @arg {PublicKey} public_key - required and used to calcualte the shared secret\n    @arg {string} [nonce = uniqueNonce()] - assigned a random unique uint64\n\n    @return {object}\n    @property {string} nonce - random or unique uint64, provides entropy when re-using the same private/public keys.\n    @property {Buffer} message - Plain text message\n    @property {number} checksum - shared secret checksum\n*/\n\nfunction encrypt(private_key, public_key, message) {\n  var nonce = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : uniqueNonce();\n  return crypt(private_key, public_key, nonce, message);\n}\n/**\n    Spec: http://localhost:3002/steem/@dantheman/how-to-encrypt-a-memo-when-transferring-steem\n\n    @arg {PrivateKey} private_key - required and used for decryption\n    @arg {PublicKey} public_key - required and used to calcualte the shared secret\n    @arg {string} nonce - random or unique uint64, provides entropy when re-using the same private/public keys.\n    @arg {Buffer} message - Encrypted or plain text message\n    @arg {number} checksum - shared secret checksum\n\n    @throws {Error|TypeError} - \"Invalid Key, ...\"\n\n    @return {Buffer} - message\n*/\n\n\nfunction decrypt(private_key, public_key, nonce, message, checksum) {\n  return crypt(private_key, public_key, nonce, message, checksum).message;\n}\n/**\n    @arg {Buffer} message - Encrypted or plain text message (see checksum)\n    @arg {number} checksum - shared secret checksum (null to encrypt, non-null to decrypt)\n    @private\n*/\n\n\nfunction crypt(private_key, public_key, nonce, message, checksum) {\n  private_key = PrivateKey(private_key);\n  if (!private_key) throw new TypeError('private_key is required');\n  public_key = PublicKey(public_key);\n  if (!public_key) throw new TypeError('public_key is required');\n  nonce = toLongObj(nonce);\n  if (!nonce) throw new TypeError('nonce is required');\n\n  if (!Buffer.isBuffer(message)) {\n    if (typeof message !== 'string') throw new TypeError('message should be buffer or string');\n    message = new Buffer(message, 'binary');\n  }\n\n  if (checksum && typeof checksum !== 'number') throw new TypeError('checksum should be a number');\n  var S = private_key.getSharedSecret(public_key);\n  var ebuf = new ByteBuffer(ByteBuffer.DEFAULT_CAPACITY, ByteBuffer.LITTLE_ENDIAN);\n  ebuf.writeUint64(nonce);\n  ebuf.append(S.toString('binary'), 'binary');\n  ebuf = new Buffer(ebuf.copy(0, ebuf.offset).toBinary(), 'binary');\n  var encryption_key = hash.sha512(ebuf); // D E B U G\n  // console.log('crypt', {\n  //     priv_to_pub: private_key.toPublic().toString(),\n  //     pub: public_key.toString(),\n  //     nonce: nonce.toString(),\n  //     message: message.length,\n  //     checksum,\n  //     S: S.toString('hex'),\n  //     encryption_key: encryption_key.toString('hex'),\n  // })\n\n  var iv = encryption_key.slice(32, 48);\n  var key = encryption_key.slice(0, 32); // check is first 64 bit of sha256 hash treated as uint64_t truncated to 32 bits.\n\n  var check = hash.sha256(encryption_key);\n  check = check.slice(0, 4);\n  var cbuf = ByteBuffer.fromBinary(check.toString('binary'), ByteBuffer.DEFAULT_CAPACITY, ByteBuffer.LITTLE_ENDIAN);\n  check = cbuf.readUint32();\n\n  if (checksum) {\n    if (check !== checksum) throw new Error('Invalid key');\n    message = cryptoJsDecrypt(message, key, iv);\n  } else {\n    message = cryptoJsEncrypt(message, key, iv);\n  }\n\n  return {\n    nonce: nonce,\n    message: message,\n    checksum: check\n  };\n}\n/** This method does not use a checksum, the returned data must be validated some other way.\n\n    @arg {string|Buffer} message - ciphertext binary format\n    @arg {string<utf8>|Buffer} key - 256bit\n    @arg {string<utf8>|Buffer} iv - 128bit\n\n    @return {Buffer}\n*/\n\n\nfunction cryptoJsDecrypt(message, key, iv) {\n  assert(message, \"Missing cipher text\");\n  message = toBinaryBuffer(message);\n  var decipher = crypto.createDecipheriv('aes-256-cbc', key, iv); // decipher.setAutoPadding(true)\n\n  message = Buffer.concat([decipher.update(message), decipher[\"final\"]()]);\n  return message;\n}\n/** This method does not use a checksum, the returned data must be validated some other way.\n    @arg {string|Buffer} message - plaintext binary format\n    @arg {string<utf8>|Buffer} key - 256bit\n    @arg {string<utf8>|Buffer} iv - 128bit\n\n    @return {Buffer}\n*/\n\n\nfunction cryptoJsEncrypt(message, key, iv) {\n  assert(message, \"Missing plain text\");\n  message = toBinaryBuffer(message);\n  var cipher = crypto.createCipheriv('aes-256-cbc', key, iv); // cipher.setAutoPadding(true)\n\n  message = Buffer.concat([cipher.update(message), cipher[\"final\"]()]);\n  return message;\n}\n/** @return {string} unique 64 bit unsigned number string.  Being time based, this is careful to never choose the same nonce twice.  This value could be recorded in the blockchain for a long time.\n*/\n\n\nfunction uniqueNonce() {\n  if (unique_nonce_entropy === null) {\n    var b = new Uint8Array(randomBytes(2));\n    unique_nonce_entropy = parseInt(b[0] << 8 | b[1], 10);\n  }\n\n  var _long = Long.fromNumber(Date.now());\n\n  var entropy = ++unique_nonce_entropy % 0xFFFF; // console.log('uniqueNonce date\\t', ByteBuffer.allocate(8).writeUint64(long).toHex(0))\n  // console.log('uniqueNonce entropy\\t', ByteBuffer.allocate(8).writeUint64(Long.fromNumber(entropy)).toHex(0))\n\n  _long = _long.shiftLeft(16).or(Long.fromNumber(entropy)); // console.log('uniqueNonce final\\t', ByteBuffer.allocate(8).writeUint64(long).toHex(0))\n\n  return _long.toString();\n}\n\nvar unique_nonce_entropy = null; // for(let i=1; i < 10; i++) key.uniqueNonce()\n\nvar toLongObj = function toLongObj(o) {\n  return o ? Long.isLong(o) ? o : Long.fromString(o) : o;\n};\n\nvar toBinaryBuffer = function toBinaryBuffer(o) {\n  return o ? Buffer.isBuffer(o) ? o : new Buffer(o, 'binary') : o;\n};","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar ecdsa = require('./ecdsa');\n\nvar hash = require('./hash');\n\nvar curve = require('ecurve').getCurveByName('secp256k1');\n\nvar assert = require('assert');\n\nvar BigInteger = require('bigi');\n\nvar keyUtils = require('./key_utils');\n\nvar PublicKey = require('./key_public');\n\nvar PrivateKey = require('./key_private');\n\nmodule.exports = Signature;\n\nfunction Signature(r, s, i) {\n  assert.equal(r != null, true, 'Missing parameter');\n  assert.equal(s != null, true, 'Missing parameter');\n  assert.equal(i != null, true, 'Missing parameter');\n  /**\n      Verify signed data.\n       @arg {String|Buffer} data - full data\n      @arg {pubkey|PublicKey} pubkey - EOSKey..\n      @arg {String} [encoding = 'utf8'] - data encoding (if data is a string)\n       @return {boolean}\n  */\n\n  function verify(data, pubkey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n    if (typeof data === 'string') {\n      data = Buffer.from(data, encoding);\n    }\n\n    assert(Buffer.isBuffer(data), 'data is a required String or Buffer');\n    data = hash.sha256(data);\n    return verifyHash(data, pubkey);\n  }\n  /**\n      Verify a buffer of exactally 32 bytes in size (sha256(text))\n       @arg {String|Buffer} dataSha256 - 32 byte buffer or string\n      @arg {String|PublicKey} pubkey - EOSKey..\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n       @return {boolean}\n  */\n\n\n  function verifyHash(dataSha256, pubkey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n\n    if (typeof dataSha256 === 'string') {\n      dataSha256 = Buffer.from(dataSha256, encoding);\n    }\n\n    if (dataSha256.length !== 32 || !Buffer.isBuffer(dataSha256)) throw new Error(\"dataSha256: 32 bytes required\");\n    var publicKey = PublicKey(pubkey);\n    assert(publicKey, 'pubkey required');\n    return ecdsa.verify(curve, dataSha256, {\n      r: r,\n      s: s\n    }, publicKey.Q);\n  }\n\n  ;\n  /** @deprecated\n       Verify hex data by converting to a buffer then hashing.\n       @return {boolean}\n  */\n\n  function verifyHex(hex, pubkey) {\n    console.log('Deprecated: use verify(data, pubkey, \"hex\")');\n    var buf = Buffer.from(hex, 'hex');\n    return verify(buf, pubkey);\n  }\n\n  ;\n  /**\n      Recover the public key used to create this signature using full data.\n       @arg {String|Buffer} data - full data\n      @arg {String} [encoding = 'utf8'] - data encoding (if string)\n       @return {PublicKey}\n  */\n\n  function recover(data) {\n    var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'utf8';\n\n    if (typeof data === 'string') {\n      data = Buffer.from(data, encoding);\n    }\n\n    console.log(data);\n    assert(Buffer.isBuffer(data), 'data is a required String or Buffer');\n    data = hash.sha256(data);\n    return recoverHash(data);\n  }\n\n  ;\n  /**\n      @arg {String|Buffer} dataSha256 - sha256 hash 32 byte buffer or hex string\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n       @return {PublicKey}\n  */\n\n  function recoverHash(dataSha256) {\n    var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'hex';\n\n    if (typeof dataSha256 === 'string') {\n      dataSha256 = Buffer.from(dataSha256, encoding);\n    }\n\n    if (dataSha256.length !== 32 || !Buffer.isBuffer(dataSha256)) {\n      throw new Error(\"dataSha256: 32 byte String or buffer requred\");\n    }\n\n    var e = BigInteger.fromBuffer(dataSha256);\n    var i2 = i;\n    i2 -= 27;\n    i2 = i2 & 3;\n    var Q = ecdsa.recoverPubKey(curve, e, {\n      r: r,\n      s: s,\n      i: i\n    }, i2);\n    return PublicKey.fromPoint(Q);\n  }\n\n  ;\n\n  function toBuffer() {\n    var buf;\n    buf = new Buffer(65);\n    buf.writeUInt8(i, 0);\n    r.toBuffer(32).copy(buf, 1);\n    s.toBuffer(32).copy(buf, 33);\n    return buf;\n  }\n\n  ;\n\n  function toHex() {\n    return toBuffer().toString(\"hex\");\n  }\n\n  ;\n  var signatureCache;\n\n  function toString() {\n    if (signatureCache) {\n      return signatureCache;\n    }\n\n    signatureCache = 'SIG_K1_' + keyUtils.checkEncode(toBuffer(), 'K1');\n    return signatureCache;\n  }\n\n  return {\n    r: r,\n    s: s,\n    i: i,\n    toBuffer: toBuffer,\n    verify: verify,\n    verifyHash: verifyHash,\n    verifyHex: verifyHex,\n    // deprecated\n    recover: recover,\n    recoverHash: recoverHash,\n    toHex: toHex,\n    toString: toString,\n\n    /** @deprecated use verify (same arguments and return) */\n    verifyBuffer: function verifyBuffer() {\n      console.log('Deprecated: use signature.verify instead (same arguments)');\n      return verify.apply(void 0, arguments);\n    },\n\n    /** @deprecated use recover (same arguments and return) */\n    recoverPublicKey: function recoverPublicKey() {\n      console.log('Deprecated: use signature.recover instead (same arguments)');\n      return recover.apply(void 0, arguments);\n    },\n\n    /** @deprecated use recoverHash (same arguments and return) */\n    recoverPublicKeyFromBuffer: function recoverPublicKeyFromBuffer() {\n      console.log('Deprecated: use signature.recoverHash instead (same arguments)');\n      return recoverHash.apply(void 0, arguments);\n    }\n  };\n}\n/**\n    Hash and sign arbitrary data.\n\n    @arg {string|Buffer} data - full data\n    @arg {wif|PrivateKey} privateKey\n    @arg {String} [encoding = 'utf8'] - data encoding (if string)\n\n    @return {Signature}\n*/\n\n\nSignature.sign = function (data, privateKey) {\n  var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n  if (typeof data === 'string') {\n    data = Buffer.from(data, encoding);\n  }\n\n  assert(Buffer.isBuffer(data), 'data is a required String or Buffer');\n  data = hash.sha256(data);\n  return Signature.signHash(data, privateKey);\n};\n/**\n    Sign a buffer of exactally 32 bytes in size (sha256(text))\n\n    @arg {string|Buffer} dataSha256 - 32 byte buffer or string\n    @arg {wif|PrivateKey} privateKey\n    @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n\n    @return {Signature}\n*/\n\n\nSignature.signHash = function (dataSha256, privateKey) {\n  var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n\n  if (typeof dataSha256 === 'string') {\n    dataSha256 = Buffer.from(dataSha256, encoding);\n  }\n\n  if (dataSha256.length !== 32 || !Buffer.isBuffer(dataSha256)) throw new Error(\"dataSha256: 32 byte buffer requred\");\n  privateKey = PrivateKey(privateKey);\n  assert(privateKey, 'privateKey required');\n  var der, e, ecsignature, i, lenR, lenS, nonce;\n  i = null;\n  nonce = 0;\n  e = BigInteger.fromBuffer(dataSha256);\n\n  while (true) {\n    ecsignature = ecdsa.sign(curve, dataSha256, privateKey.d, nonce++);\n    der = ecsignature.toDER();\n    lenR = der[3];\n    lenS = der[5 + lenR];\n\n    if (lenR === 32 && lenS === 32) {\n      i = ecdsa.calcPubKeyRecoveryParam(curve, e, ecsignature, privateKey.toPublic().Q);\n      i += 4; // compressed\n\n      i += 27; // compact  //  24 or 27 :( forcing odd-y 2nd key candidate)\n\n      break;\n    }\n\n    if (nonce % 10 === 0) {\n      console.log(\"WARN: \" + nonce + \" attempts to find canonical signature\");\n    }\n  }\n\n  return Signature(ecsignature.r, ecsignature.s, i);\n};\n\nSignature.fromBuffer = function (buf) {\n  var i, r, s;\n  assert(Buffer.isBuffer(buf), 'Buffer is required');\n  assert.equal(buf.length, 65, 'Invalid signature length');\n  i = buf.readUInt8(0);\n  assert.equal(i - 27, i - 27 & 7, 'Invalid signature parameter');\n  r = BigInteger.fromBuffer(buf.slice(1, 33));\n  s = BigInteger.fromBuffer(buf.slice(33));\n  return Signature(r, s, i);\n};\n\nSignature.fromHex = function (hex) {\n  return Signature.fromBuffer(Buffer.from(hex, \"hex\"));\n};\n/**\n    @arg {string} signature - like SIG_K1_base58signature..\n    @return {Signature} or `null` (invalid)\n*/\n\n\nSignature.fromString = function (signature) {\n  try {\n    return Signature.fromStringOrThrow(signature);\n  } catch (e) {\n    return null;\n  }\n};\n/**\n    @arg {string} signature - like SIG_K1_base58signature..\n    @throws {Error} invalid\n    @return {Signature}\n*/\n\n\nSignature.fromStringOrThrow = function (signature) {\n  assert.equal((0, _typeof2[\"default\"])(signature), 'string', 'signature');\n  var match = signature.match(/^SIG_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);\n  assert(match != null && match.length === 3, 'Expecting signature like: SIG_K1_base58signature..');\n\n  var _match = (0, _slicedToArray2[\"default\"])(match, 3),\n      keyType = _match[1],\n      keyString = _match[2];\n\n  assert.equal(keyType, 'K1', 'K1 signature expected');\n  return Signature.fromBuffer(keyUtils.checkDecode(keyString, keyType));\n};\n/**\n    @arg {String|Signature} o - hex string\n    @return {Signature}\n*/\n\n\nSignature.from = function (o) {\n  var signature = o ? o.r && o.s && o.i ? o : typeof o === 'string' && o.length === 130 ? Signature.fromHex(o) : typeof o === 'string' && o.length !== 130 ? Signature.fromStringOrThrow(o) : Buffer.isBuffer(o) ? Signature.fromBuffer(o) : null : o;\n  /*null or undefined*/\n\n  if (!signature) {\n    throw new TypeError('signature should be a hex string or buffer');\n  }\n\n  return signature;\n};","\"use strict\";\n\nmodule.exports = function enforce(type, value) {\n  // Copied from https://github.com/bitcoinjs/bitcoinjs-lib\n  switch (type) {\n    case 'Array':\n      {\n        if (Array.isArray(value)) return;\n        break;\n      }\n\n    case 'Boolean':\n      {\n        if (typeof value === 'boolean') return;\n        break;\n      }\n\n    case 'Buffer':\n      {\n        if (Buffer.isBuffer(value)) return;\n        break;\n      }\n\n    case 'Number':\n      {\n        if (typeof value === 'number') return;\n        break;\n      }\n\n    case 'String':\n      {\n        if (typeof value === 'string') return;\n        break;\n      }\n\n    default:\n      {\n        if (getName(value.constructor) === getName(type)) return;\n      }\n  }\n\n  throw new TypeError('Expected ' + (getName(type) || type) + ', got ' + value);\n};\n\nfunction getName(fn) {\n  // Why not fn.name: https://kangax.github.io/compat-table/es6/#function_name_property\n  var match = fn.toString().match(/function (.*?)\\(/);\n  return match ? match[1] : null;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Name = 'Anchor';","\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/regenerator\");\n\nvar _classCallCheck = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/inherits\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar universal_authenticator_library_1 = require(\"universal-authenticator-library\");\n\nvar UALAnchorError_1 = require(\"./UALAnchorError\");\n\nvar AnchorUser =\n/*#__PURE__*/\nfunction (_universal_authentica) {\n  _inherits(AnchorUser, _universal_authentica);\n\n  function AnchorUser(rpc, session) {\n    var _this;\n\n    _classCallCheck(this, AnchorUser);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AnchorUser).call(this));\n    _this.accountName = '';\n    _this.requestPermission = '';\n    _this.chainId = session.link.chainId;\n    _this.accountName = session.auth.actor;\n    _this.requestPermission = session.auth.permission;\n    _this.session = session;\n    _this.rpc = rpc;\n    return _this;\n  }\n\n  _createClass(AnchorUser, [{\n    key: \"signTransaction\",\n    value: function signTransaction(transaction, options) {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var completedTransaction, message, type, cause;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.session.transact(transaction, options);\n\n              case 3:\n                completedTransaction = _context.sent;\n                return _context.abrupt(\"return\", this.returnEosjsTransaction(options.broadcast, completedTransaction));\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                message = _context.t0.message ? _context.t0.message : 'Unable to sign transaction';\n                type = universal_authenticator_library_1.UALErrorType.Signing;\n                cause = _context.t0;\n                throw new UALAnchorError_1.UALAnchorError(message, type, cause);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n    }\n  }, {\n    key: \"signArbitrary\",\n    value: function signArbitrary(publicKey, data, _) {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                console.log(\"signArbitrary\", publicKey, data);\n                throw new UALAnchorError_1.UALAnchorError(\"Anchor does not currently support signArbitrary\", universal_authenticator_library_1.UALErrorType.Unsupported, null);\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n    }\n  }, {\n    key: \"verifyKeyOwnership\",\n    value: function verifyKeyOwnership(challenge) {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                console.log(\"verifyKeyOwnership\", challenge);\n                throw new UALAnchorError_1.UALAnchorError(\"Anchor does not currently support verifyKeyOwnership\", universal_authenticator_library_1.UALErrorType.Unsupported, null);\n\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n    }\n  }, {\n    key: \"getAccountName\",\n    value: function getAccountName() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt(\"return\", this.accountName);\n\n              case 1:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n    }\n  }, {\n    key: \"getChainId\",\n    value: function getChainId() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5() {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt(\"return\", this.chainId);\n\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n    }\n  }, {\n    key: \"getKeys\",\n    value: function getKeys() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6() {\n        var keys, message, type, cause;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                console.log(\"getKeys\");\n                _context6.prev = 1;\n                _context6.next = 4;\n                return this.signatureProvider.getAvailableKeys(this.requestPermission);\n\n              case 4:\n                keys = _context6.sent;\n                return _context6.abrupt(\"return\", keys);\n\n              case 8:\n                _context6.prev = 8;\n                _context6.t0 = _context6[\"catch\"](1);\n                message = \"Unable to getKeys for account \".concat(this.accountName, \".\\n        Please make sure your wallet is running.\");\n                type = universal_authenticator_library_1.UALErrorType.DataRequest;\n                cause = _context6.t0;\n                throw new UALAnchorError_1.UALAnchorError(message, type, cause);\n\n              case 14:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[1, 8]]);\n      }));\n    }\n  }, {\n    key: \"isAccountValid\",\n    value: function isAccountValid() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7() {\n        var account, actualKeys, authorizationKeys, message, type, cause;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                console.log(\"isAccountValid\");\n                _context7.prev = 1;\n                _context7.t0 = this.rpc;\n\n                if (!_context7.t0) {\n                  _context7.next = 7;\n                  break;\n                }\n\n                _context7.next = 6;\n                return this.rpc.get_account(this.accountName);\n\n              case 6:\n                _context7.t0 = _context7.sent;\n\n              case 7:\n                account = _context7.t0;\n                actualKeys = this.extractAccountKeys(account);\n                _context7.next = 11;\n                return this.getKeys();\n\n              case 11:\n                authorizationKeys = _context7.sent;\n                return _context7.abrupt(\"return\", actualKeys.filter(function (key) {\n                  return authorizationKeys.indexOf(key) !== -1;\n                }).length > 0);\n\n              case 15:\n                _context7.prev = 15;\n                _context7.t1 = _context7[\"catch\"](1);\n\n                if (!(_context7.t1.constructor.name === 'UALAnchorError')) {\n                  _context7.next = 19;\n                  break;\n                }\n\n                throw _context7.t1;\n\n              case 19:\n                message = \"Account validation failed for account \".concat(this.accountName, \".\");\n                type = universal_authenticator_library_1.UALErrorType.Validation;\n                cause = _context7.t1;\n                throw new UALAnchorError_1.UALAnchorError(message, type, cause);\n\n              case 23:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[1, 15]]);\n      }));\n    }\n  }, {\n    key: \"extractAccountKeys\",\n    value: function extractAccountKeys(account) {\n      console.log(\"extractAccountKeys\", account);\n      var keySubsets = account.permissions.map(function (permission) {\n        return permission.required_auth.keys.map(function (key) {\n          return key.key;\n        });\n      });\n      var keys = [];\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = keySubsets[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var keySubset = _step.value;\n          keys = keys.concat(keySubset);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return keys;\n    }\n  }]);\n\n  return AnchorUser;\n}(universal_authenticator_library_1.User);\n\nexports.AnchorUser = AnchorUser;","\"use strict\";\n\nvar _classCallCheck = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _possibleConstructorReturn = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/inherits\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar universal_authenticator_library_1 = require(\"universal-authenticator-library\");\n\nvar interfaces_1 = require(\"./interfaces\");\n\nvar UALAnchorError =\n/*#__PURE__*/\nfunction (_universal_authentica) {\n  _inherits(UALAnchorError, _universal_authentica);\n\n  function UALAnchorError(message, type, cause) {\n    _classCallCheck(this, UALAnchorError);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(UALAnchorError).call(this, message, type, cause, interfaces_1.Name));\n  }\n\n  return UALAnchorError;\n}(universal_authenticator_library_1.UALError);\n\nexports.UALAnchorError = UALAnchorError;","\"use strict\";\n\nfunction __export(m) {\n  for (var p in m) {\n    if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n  }\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__export(require(\"./Anchor\"));\n\n__export(require(\"./AnchorUser\"));","export default {\n  version: 'eosio::abi/1.1',\n  types: [],\n  structs: [{\n    name: 'sealed_message',\n    base: '',\n    fields: [{\n      name: 'from',\n      type: 'public_key'\n    }, {\n      name: 'nonce',\n      type: 'uint64'\n    }, {\n      name: 'ciphertext',\n      type: 'bytes'\n    }, {\n      name: 'checksum',\n      type: 'uint32'\n    }]\n  }, {\n    name: 'link_create',\n    base: '',\n    fields: [{\n      name: 'session_name',\n      type: 'name'\n    }, {\n      name: 'request_key',\n      type: 'public_key'\n    }]\n  }, {\n    name: 'link_info',\n    base: '',\n    fields: [{\n      name: 'expiration',\n      type: 'time_point_sec'\n    }]\n  }],\n  actions: [],\n  ricardian_clauses: [],\n  error_messages: [],\n  tables: [],\n  abi_extensions: []\n};","import _classCallCheck from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\n\n/**\n * Error that is thrown if a [[LinkTransport]] cancels a request.\n * @internal\n */\nexport var CancelError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(CancelError, _Error);\n\n  function CancelError(reason) {\n    var _this;\n\n    _classCallCheck(this, CancelError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CancelError).call(this, \"User canceled request \".concat(reason ? '(' + reason + ')' : '')));\n    _this.code = 'E_CANCEL';\n    return _this;\n  }\n\n  return CancelError;\n}(_wrapNativeSuper(Error));\n/**\n * Error that is thrown if an identity request fails to verify.\n * @internal\n */\n\nexport var IdentityError =\n/*#__PURE__*/\nfunction (_Error2) {\n  _inherits(IdentityError, _Error2);\n\n  function IdentityError(reason) {\n    var _this2;\n\n    _classCallCheck(this, IdentityError);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(IdentityError).call(this, \"Unable to verify identity \".concat(reason ? '(' + reason + ')' : '')));\n    _this2.code = 'E_IDENTITY';\n    return _this2;\n  }\n\n  return IdentityError;\n}(_wrapNativeSuper(Error));\n/**\n * Error originating from a [[LinkSession]].\n * @internal\n */\n\nexport var SessionError =\n/*#__PURE__*/\nfunction (_Error3) {\n  _inherits(SessionError, _Error3);\n\n  function SessionError(reason, code) {\n    var _this3;\n\n    _classCallCheck(this, SessionError);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(SessionError).call(this, reason));\n    _this3.code = code;\n    return _this3;\n  }\n\n  return SessionError;\n}(_wrapNativeSuper(Error));","\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/regenerator\");\n\nvar _slicedToArray = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _classCallCheck = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/inherits\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar universal_authenticator_library_1 = require(\"universal-authenticator-library\");\n\nvar anchor_link_1 = __importDefault(require(\"anchor-link\"));\n\nvar interfaces_1 = require(\"./interfaces\");\n\nvar AnchorUser_1 = require(\"./AnchorUser\");\n\nvar AnchorLogo_1 = require(\"./AnchorLogo\");\n\nvar UALAnchorError_1 = require(\"./UALAnchorError\");\n\nvar anchor_link_browser_transport_1 = __importDefault(require(\"anchor-link-browser-transport\"));\n\nvar Anchor =\n/*#__PURE__*/\nfunction (_universal_authentica) {\n  _inherits(Anchor, _universal_authentica);\n\n  /**\n   * Anchor Constructor.\n   *\n   * @param chains\n   * @param options { appName } appName is a required option to use Scatter\n   */\n  function Anchor(chains, options) {\n    var _this;\n\n    _classCallCheck(this, Anchor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Anchor).call(this, chains)); // Storage for AnchorUser instances\n\n    _this.users = []; // Establish initial values\n\n    _this.chainId = chains[0].chainId;\n    _this.service = options.service || 'https://cb.anchor.link';\n    _this.users = []; // Determine the default rpc endpoint for this chain\n\n    var _chains = _slicedToArray(chains, 1),\n        chain = _chains[0];\n\n    var _chain$rpcEndpoints = _slicedToArray(chain.rpcEndpoints, 1),\n        rpc = _chain$rpcEndpoints[0];\n\n    _this.rpc = \"\".concat(rpc.protocol, \"://\").concat(rpc.host, \":\").concat(rpc.port); // Ensure the appName is set properly\n\n    if (options && options.appName) {\n      _this.appName = options.appName;\n    } else {\n      throw new UALAnchorError_1.UALAnchorError('ual-anchor requires the appName property to be set on the `options` argument during initialization.', universal_authenticator_library_1.UALErrorType.Initialization, null);\n    } // Allow overriding the JsonRpc client\n\n\n    if (options && options.rpc) {\n      var _rpc = options.rpc; // A hack for eosjs to resolve the \"illegal invocation\" errors while fetching\n      //    this can be removed in the future once the issue is resolve in anchor-link, but shouldn't cause harm in the mean time\n\n      if (_rpc.fetchBuiltin) {\n        _rpc.fetchBuiltin = _rpc.fetchBuiltin.bind(window);\n      }\n\n      _this.rpc = _rpc;\n    }\n\n    return _this;\n  }\n  /**\n   * Called after `shouldRender` and should be used to handle any async actions required to initialize the authenticator\n   */\n\n\n  _createClass(Anchor, [{\n    key: \"init\",\n    value: function init() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var session;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // establish anchor-link\n                this.link = new anchor_link_1.default({\n                  chainId: this.chainId,\n                  rpc: this.rpc,\n                  service: this.service,\n                  transport: new anchor_link_browser_transport_1.default({\n                    // disable browser transport UI status messages, ual has its own\n                    requestStatus: false\n                  })\n                }); // attempt to restore any existing session for this app\n\n                _context.next = 3;\n                return this.link.restoreSession(this.appName);\n\n              case 3:\n                session = _context.sent;\n\n                if (session) {\n                  this.users = [new AnchorUser_1.AnchorUser(this.rpc, session)];\n                }\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    }\n    /**\n     * Resets the authenticator to its initial, default state then calls `init` method\n     */\n\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.users = [];\n    }\n    /**\n     * Returns true if the authenticator has errored while initializing.\n     */\n\n  }, {\n    key: \"isErrored\",\n    value: function isErrored() {\n      return false;\n    }\n    /**\n     * Returns a URL where the user can download and install the underlying authenticator\n     * if it is not found by the UAL Authenticator.\n     */\n\n  }, {\n    key: \"getOnboardingLink\",\n    value: function getOnboardingLink() {\n      return 'https://github.com/greymass/anchor/';\n    }\n    /**\n     * Returns error (if available) if the authenticator has errored while initializing.\n     */\n\n  }, {\n    key: \"getError\",\n    value: function getError() {\n      return null;\n    }\n    /**\n     * Returns true if the authenticator is loading while initializing its internal state.\n     */\n\n  }, {\n    key: \"isLoading\",\n    value: function isLoading() {\n      return false;\n    }\n    /**\n     * Returns the style of the Button that will be rendered.\n     */\n\n  }, {\n    key: \"getStyle\",\n    value: function getStyle() {\n      return {\n        icon: AnchorLogo_1.AnchorLogo,\n        text: interfaces_1.Name,\n        textColor: 'white',\n        background: '#3650A2'\n      };\n    }\n    /**\n     * Returns whether or not the button should render based on the operating environment and other factors.\n     * ie. If your Authenticator App does not support mobile, it returns false when running in a mobile browser.\n     */\n\n  }, {\n    key: \"shouldRender\",\n    value: function shouldRender() {\n      return !this.isLoading();\n    }\n    /**\n     * Returns whether or not the dapp should attempt to auto login with the Authenticator app.\n     * Auto login will only occur when there is only one Authenticator that returns shouldRender() true and\n     * shouldAutoLogin() true.\n     */\n\n  }, {\n    key: \"shouldAutoLogin\",\n    value: function shouldAutoLogin() {\n      return this.users.length > 0;\n    }\n    /**\n     * Returns whether or not the button should show an account name input field.\n     * This is for Authenticators that do not have a concept of account names.\n     */\n\n  }, {\n    key: \"shouldRequestAccountName\",\n    value: function shouldRequestAccountName() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", false);\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n    }\n    /**\n     * Login using the Authenticator App. This can return one or more users depending on multiple chain support.\n     *\n     * @param accountName  The account name of the user for Authenticators that do not store accounts (optional)\n     */\n\n  }, {\n    key: \"login\",\n    value: function login() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var identity;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(this.chains.length > 1)) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                throw new UALAnchorError_1.UALAnchorError('UAL-Anchor does not yet support providing multiple chains to UAL. Please initialize the UAL provider with a single chain.', universal_authenticator_library_1.UALErrorType.Unsupported, null);\n\n              case 2:\n                _context3.prev = 2;\n\n                if (!(this.users.length === 0)) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                _context3.next = 6;\n                return this.link.login(this.appName);\n\n              case 6:\n                identity = _context3.sent;\n                this.users = [new AnchorUser_1.AnchorUser(this.rpc, identity.session)];\n\n              case 8:\n                _context3.next = 13;\n                break;\n\n              case 10:\n                _context3.prev = 10;\n                _context3.t0 = _context3[\"catch\"](2);\n                throw new UALAnchorError_1.UALAnchorError(_context3.t0.message, universal_authenticator_library_1.UALErrorType.Login, _context3.t0);\n\n              case 13:\n                return _context3.abrupt(\"return\", this.users);\n\n              case 14:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[2, 10]]);\n      }));\n    }\n    /**\n     * Logs the user out of the dapp. This will be strongly dependent on each Authenticator app's patterns.\n     */\n\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      return __awaiter(this, void 0, void 0,\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var _this$users, user, auth;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                // retrieve the current user\n                _this$users = _slicedToArray(this.users, 1), user = _this$users[0]; // retrieve the auth from the current user\n\n                auth = user.session.auth; // remove the session from anchor-link\n\n                _context4.next = 4;\n                return this.link.removeSession(this.appName, auth);\n\n              case 4:\n                // reset the authenticator\n                this.reset();\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n    }\n    /**\n     * Returns true if user confirmation is required for `getKeys`\n     */\n\n  }, {\n    key: \"requiresGetKeyConfirmation\",\n    value: function requiresGetKeyConfirmation() {\n      return false;\n    }\n  }]);\n\n  return Anchor;\n}(universal_authenticator_library_1.Authenticator);\n\nexports.Anchor = Anchor;","export * from './link';\nexport * from './link-session';\nexport * from './errors'; // default export is Link class for convenience\n\nimport { Link } from './link';\nexport default Link; // convenience re-exports from esr\n\nexport { PlaceholderAuth, PlaceholderName, PlaceholderPermission } from 'eosio-signing-request';","\"use strict\";\n\nvar Aes = require(\"./aes\");\n\nvar PrivateKey = require(\"./key_private\");\n\nvar PublicKey = require(\"./key_public\");\n\nvar Signature = require(\"./signature\");\n\nvar key_utils = require(\"./key_utils\");\n\nvar hash = require(\"./hash\");\n/**\n    [Wallet Import Format](https://en.bitcoin.it/wiki/Wallet_import_format)\n    @typedef {string} wif\n*/\n\n/**\n    EOSKey..\n    @typedef {string} pubkey\n*/\n\n/** @namespace */\n\n\nvar ecc = {\n  /**\n    Initialize by running some self-checking code.  This should take a\n    second to gather additional CPU entropy used during private key\n    generation.\n     Initialization happens once even if called multiple times.\n     @return {Promise}\n  */\n  initialize: PrivateKey.initialize,\n\n  /**\n    Does not pause to gather CPU entropy.\n    @return {Promise<PrivateKey>} test key\n  */\n  unsafeRandomKey: function unsafeRandomKey() {\n    return PrivateKey.unsafeRandomKey().then(function (key) {\n      return key.toString();\n    });\n  },\n\n  /**\n      @arg {number} [cpuEntropyBits = 0] gather additional entropy\n      from a CPU mining algorithm.  This will already happen once by\n      default.\n       @return {Promise<wif>}\n       @example\n  ecc.randomKey().then(privateKey => {\n  console.log('Private Key:\\t', privateKey) // wif\n  console.log('Public Key:\\t', ecc.privateToPublic(privateKey)) // EOSkey...\n  })\n  */\n  randomKey: function randomKey(cpuEntropyBits) {\n    return PrivateKey.randomKey(cpuEntropyBits).then(function (key) {\n      return key.toString();\n    });\n  },\n\n  /**\n       @arg {string} seed - any length string.  This is private.  The same\n      seed produces the same private key every time.  At least 128 random\n      bits should be used to produce a good private key.\n      @return {wif}\n       @example ecc.seedPrivate('secret') === wif\n  */\n  seedPrivate: function seedPrivate(seed) {\n    return PrivateKey.fromSeed(seed).toString();\n  },\n\n  /**\n      @arg {wif} wif\n      @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n       @return {pubkey}\n       @example ecc.privateToPublic(wif) === pubkey\n  */\n  privateToPublic: function privateToPublic(wif) {\n    var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n    return PrivateKey(wif).toPublic().toString(pubkey_prefix);\n  },\n\n  /**\n      @arg {pubkey} pubkey - like EOSKey..\n      @arg {string} [pubkey_prefix = 'EOS']\n       @return {boolean} valid\n       @example ecc.isValidPublic(pubkey) === true\n  */\n  isValidPublic: function isValidPublic(pubkey) {\n    var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n    return PublicKey.isValid(pubkey, pubkey_prefix);\n  },\n\n  /**\n      @arg {wif} wif\n      @return {boolean} valid\n       @example ecc.isValidPrivate(wif) === true\n  */\n  isValidPrivate: function isValidPrivate(wif) {\n    return PrivateKey.isValid(wif);\n  },\n\n  /**\n      Create a signature using data or a hash.\n       @arg {string|Buffer} data\n      @arg {wif|PrivateKey} privateKey\n      @arg {String} [encoding = 'utf8'] - data encoding (if string)\n       @return {string} string signature\n       @example ecc.sign('I am alive', wif)\n  */\n  sign: function sign(data, privateKey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n    if (encoding === true) {\n      throw new TypeError('API changed, use signHash(..) instead');\n    } else {\n      if (encoding === false) {\n        console.log('Warning: ecc.sign hashData parameter was removed');\n      }\n    }\n\n    return Signature.sign(data, privateKey, encoding).toString();\n  },\n\n  /**\n      @arg {String|Buffer} dataSha256 - sha256 hash 32 byte buffer or string\n      @arg {wif|PrivateKey} privateKey\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n       @return {string} string signature\n  */\n  signHash: function signHash(dataSha256, privateKey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n    return Signature.signHash(dataSha256, privateKey, encoding).toString();\n  },\n\n  /**\n      Verify signed data.\n       @arg {string|Buffer} signature - buffer or hex string\n      @arg {string|Buffer} data\n      @arg {pubkey|PublicKey} pubkey\n      @arg {boolean} [hashData = true] - sha256 hash data before verify\n      @return {boolean}\n       @example ecc.verify(signature, 'I am alive', pubkey) === true\n  */\n  verify: function verify(signature, data, pubkey) {\n    var encoding = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'utf8';\n\n    if (encoding === true) {\n      throw new TypeError('API changed, use verifyHash(..) instead');\n    } else {\n      if (encoding === false) {\n        console.log('Warning: ecc.verify hashData parameter was removed');\n      }\n    }\n\n    signature = Signature.from(signature);\n    return signature.verify(data, pubkey, encoding);\n  },\n  verifyHash: function verifyHash(signature, dataSha256, pubkey) {\n    var encoding = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'hex';\n    signature = Signature.from(signature);\n    return signature.verifyHash(dataSha256, pubkey, encoding);\n  },\n\n  /**\n      Recover the public key used to create the signature.\n       @arg {String|Buffer} signature (EOSbase58sig.., Hex, Buffer)\n      @arg {String|Buffer} data - full data\n      @arg {String} [encoding = 'utf8'] - data encoding (if data is a string)\n       @return {pubkey}\n       @example ecc.recover(signature, 'I am alive') === pubkey\n  */\n  recover: function recover(signature, data) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n    if (encoding === true) {\n      throw new TypeError('API changed, use recoverHash(signature, data) instead');\n    } else {\n      if (encoding === false) {\n        console.log('Warning: ecc.recover hashData parameter was removed');\n      }\n    }\n\n    signature = Signature.from(signature);\n    return signature.recover(data, encoding).toString();\n  },\n\n  /**\n      @arg {String|Buffer} signature (EOSbase58sig.., Hex, Buffer)\n      @arg {String|Buffer} dataSha256 - sha256 hash 32 byte buffer or hex string\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if dataSha256 is a string)\n       @return {PublicKey}\n  */\n  recoverHash: function recoverHash(signature, dataSha256) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n    signature = Signature.from(signature);\n    return signature.recoverHash(dataSha256, encoding).toString();\n  },\n\n  /** @arg {string|Buffer} data - always binary, you may need Buffer.from(data, 'hex')\n      @arg {string} [encoding = 'hex'] - result encoding 'hex', 'binary' or 'base64'\n      @return {string|Buffer} - Buffer when encoding is null, or string\n       @example ecc.sha256('hashme') === '02208b..'\n      @example ecc.sha256(Buffer.from('02208b', 'hex')) === '29a23..'\n  */\n  sha256: function sha256(data) {\n    var resultEncoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'hex';\n    return hash.sha256(data, resultEncoding);\n  }\n};\nmodule.exports = ecc;","\"use strict\";\n/**\n  Convert a synchronous function into a asynchronous one (via setTimeout)\n  wrapping it in a promise.  This does not expect the function to have a\n  callback paramter.\n\n  @arg {function} func - non-callback function\n\n  @example promiseAsync(myfunction)\n*/\n\nmodule.exports = function (func) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return new Promise(function (resolve, reject) {\n      setTimeout(function () {\n        try {\n          resolve(func.apply(void 0, args));\n        } catch (err) {\n          reject(err);\n        }\n      });\n    });\n  };\n};","\"use strict\";\n\nvar assert = require('assert'); // from github.com/bitcoinjs/bitcoinjs-lib from github.com/cryptocoinjs/ecdsa\n\n\nvar crypto = require('./hash');\n\nvar enforceType = require('./enforce_types');\n\nvar BigInteger = require('bigi');\n\nvar ECSignature = require('./ecsignature'); // https://tools.ietf.org/html/rfc6979#section-3.2\n\n\nfunction deterministicGenerateK(curve, hash, d, checkSig, nonce) {\n  enforceType('Buffer', hash);\n  enforceType(BigInteger, d);\n\n  if (nonce) {\n    hash = crypto.sha256(Buffer.concat([hash, new Buffer(nonce)]));\n  } // sanity check\n\n\n  assert.equal(hash.length, 32, 'Hash must be 256 bit');\n  var x = d.toBuffer(32);\n  var k = new Buffer(32);\n  var v = new Buffer(32); // Step B\n\n  v.fill(1); // Step C\n\n  k.fill(0); // Step D\n\n  k = crypto.HmacSHA256(Buffer.concat([v, new Buffer([0]), x, hash]), k); // Step E\n\n  v = crypto.HmacSHA256(v, k); // Step F\n\n  k = crypto.HmacSHA256(Buffer.concat([v, new Buffer([1]), x, hash]), k); // Step G\n\n  v = crypto.HmacSHA256(v, k); // Step H1/H2a, ignored as tlen === qlen (256 bit)\n  // Step H2b\n\n  v = crypto.HmacSHA256(v, k);\n  var T = BigInteger.fromBuffer(v); // Step H3, repeat until T is within the interval [1, n - 1]\n\n  while (T.signum() <= 0 || T.compareTo(curve.n) >= 0 || !checkSig(T)) {\n    k = crypto.HmacSHA256(Buffer.concat([v, new Buffer([0])]), k);\n    v = crypto.HmacSHA256(v, k); // Step H1/H2a, again, ignored as tlen === qlen (256 bit)\n    // Step H2b again\n\n    v = crypto.HmacSHA256(v, k);\n    T = BigInteger.fromBuffer(v);\n  }\n\n  return T;\n}\n\nfunction sign(curve, hash, d, nonce) {\n  var e = BigInteger.fromBuffer(hash);\n  var n = curve.n;\n  var G = curve.G;\n  var r, s;\n  var k = deterministicGenerateK(curve, hash, d, function (k) {\n    // find canonically valid signature\n    var Q = G.multiply(k);\n    if (curve.isInfinity(Q)) return false;\n    r = Q.affineX.mod(n);\n    if (r.signum() === 0) return false;\n    s = k.modInverse(n).multiply(e.add(d.multiply(r))).mod(n);\n    if (s.signum() === 0) return false;\n    return true;\n  }, nonce);\n  var N_OVER_TWO = n.shiftRight(1); // enforce low S values, see bip62: 'low s values in signatures'\n\n  if (s.compareTo(N_OVER_TWO) > 0) {\n    s = n.subtract(s);\n  }\n\n  return ECSignature(r, s);\n}\n\nfunction verifyRaw(curve, e, signature, Q) {\n  var n = curve.n;\n  var G = curve.G;\n  var r = signature.r;\n  var s = signature.s; // 1.4.1 Enforce r and s are both integers in the interval [1, n − 1]\n\n  if (r.signum() <= 0 || r.compareTo(n) >= 0) return false;\n  if (s.signum() <= 0 || s.compareTo(n) >= 0) return false; // c = s^-1 mod n\n\n  var c = s.modInverse(n); // 1.4.4 Compute u1 = es^−1 mod n\n  //               u2 = rs^−1 mod n\n\n  var u1 = e.multiply(c).mod(n);\n  var u2 = r.multiply(c).mod(n); // 1.4.5 Compute R = (xR, yR) = u1G + u2Q\n\n  var R = G.multiplyTwo(u1, Q, u2); // 1.4.5 (cont.) Enforce R is not at infinity\n\n  if (curve.isInfinity(R)) return false; // 1.4.6 Convert the field element R.x to an integer\n\n  var xR = R.affineX; // 1.4.7 Set v = xR mod n\n\n  var v = xR.mod(n); // 1.4.8 If v = r, output \"valid\", and if v != r, output \"invalid\"\n\n  return v.equals(r);\n}\n\nfunction verify(curve, hash, signature, Q) {\n  // 1.4.2 H = Hash(M), already done by the user\n  // 1.4.3 e = H\n  var e = BigInteger.fromBuffer(hash);\n  return verifyRaw(curve, e, signature, Q);\n}\n/**\n  * Recover a public key from a signature.\n  *\n  * See SEC 1: Elliptic Curve Cryptography, section 4.1.6, \"Public\n  * Key Recovery Operation\".\n  *\n  * http://www.secg.org/download/aid-780/sec1-v2.pdf\n  */\n\n\nfunction recoverPubKey(curve, e, signature, i) {\n  assert.strictEqual(i & 3, i, 'Recovery param is more than two bits');\n  var n = curve.n;\n  var G = curve.G;\n  var r = signature.r;\n  var s = signature.s;\n  assert(r.signum() > 0 && r.compareTo(n) < 0, 'Invalid r value');\n  assert(s.signum() > 0 && s.compareTo(n) < 0, 'Invalid s value'); // A set LSB signifies that the y-coordinate is odd\n\n  var isYOdd = i & 1; // The more significant bit specifies whether we should use the\n  // first or second candidate key.\n\n  var isSecondKey = i >> 1; // 1.1 Let x = r + jn\n\n  var x = isSecondKey ? r.add(n) : r;\n  var R = curve.pointFromX(isYOdd, x); // 1.4 Check that nR is at infinity\n\n  var nR = R.multiply(n);\n  assert(curve.isInfinity(nR), 'nR is not a valid curve point'); // Compute -e from e\n\n  var eNeg = e.negate().mod(n); // 1.6.1 Compute Q = r^-1 (sR -  eG)\n  //               Q = r^-1 (sR + -eG)\n\n  var rInv = r.modInverse(n);\n  var Q = R.multiplyTwo(s, G, eNeg).multiply(rInv);\n  curve.validate(Q);\n  return Q;\n}\n/**\n  * Calculate pubkey extraction parameter.\n  *\n  * When extracting a pubkey from a signature, we have to\n  * distinguish four different cases. Rather than putting this\n  * burden on the verifier, Bitcoin includes a 2-bit value with the\n  * signature.\n  *\n  * This function simply tries all four cases and returns the value\n  * that resulted in a successful pubkey recovery.\n  */\n\n\nfunction calcPubKeyRecoveryParam(curve, e, signature, Q) {\n  for (var i = 0; i < 4; i++) {\n    var Qprime = recoverPubKey(curve, e, signature, i); // 1.6.2 Verify Q\n\n    if (Qprime.equals(Q)) {\n      return i;\n    }\n  }\n\n  throw new Error('Unable to find valid recovery factor');\n}\n\nmodule.exports = {\n  calcPubKeyRecoveryParam: calcPubKeyRecoveryParam,\n  deterministicGenerateK: deterministicGenerateK,\n  recoverPubKey: recoverPubKey,\n  sign: sign,\n  verify: verify,\n  verifyRaw: verifyRaw\n};","\"use strict\";\n\nvar assert = require('assert'); // from https://github.com/bitcoinjs/bitcoinjs-lib\n\n\nvar enforceType = require('./enforce_types');\n\nvar BigInteger = require('bigi');\n\nfunction ECSignature(r, s) {\n  enforceType(BigInteger, r);\n  enforceType(BigInteger, s);\n\n  function toCompact(i, compressed) {\n    if (compressed) i += 4;\n    i += 27;\n    var buffer = new Buffer(65);\n    buffer.writeUInt8(i, 0);\n    r.toBuffer(32).copy(buffer, 1);\n    s.toBuffer(32).copy(buffer, 33);\n    return buffer;\n  }\n\n  function toDER() {\n    var rBa = r.toDERInteger();\n    var sBa = s.toDERInteger();\n    var sequence = []; // INTEGER\n\n    sequence.push(0x02, rBa.length);\n    sequence = sequence.concat(rBa); // INTEGER\n\n    sequence.push(0x02, sBa.length);\n    sequence = sequence.concat(sBa); // SEQUENCE\n\n    sequence.unshift(0x30, sequence.length);\n    return new Buffer(sequence);\n  }\n\n  function toScriptSignature(hashType) {\n    var hashTypeBuffer = new Buffer(1);\n    hashTypeBuffer.writeUInt8(hashType, 0);\n    return Buffer.concat([toDER(), hashTypeBuffer]);\n  }\n\n  return {\n    r: r,\n    s: s,\n    toCompact: toCompact,\n    toDER: toDER,\n    toScriptSignature: toScriptSignature\n  };\n} // Import operations\n\n\nECSignature.parseCompact = function (buffer) {\n  assert.equal(buffer.length, 65, 'Invalid signature length');\n  var i = buffer.readUInt8(0) - 27; // At most 3 bits\n\n  assert.equal(i, i & 7, 'Invalid signature parameter');\n  var compressed = !!(i & 4); // Recovery param only\n\n  i = i & 3;\n  var r = BigInteger.fromBuffer(buffer.slice(1, 33));\n  var s = BigInteger.fromBuffer(buffer.slice(33));\n  return {\n    compressed: compressed,\n    i: i,\n    signature: ECSignature(r, s)\n  };\n};\n\nECSignature.fromDER = function (buffer) {\n  assert.equal(buffer.readUInt8(0), 0x30, 'Not a DER sequence');\n  assert.equal(buffer.readUInt8(1), buffer.length - 2, 'Invalid sequence length');\n  assert.equal(buffer.readUInt8(2), 0x02, 'Expected a DER integer');\n  var rLen = buffer.readUInt8(3);\n  assert(rLen > 0, 'R length is zero');\n  var offset = 4 + rLen;\n  assert.equal(buffer.readUInt8(offset), 0x02, 'Expected a DER integer (2)');\n  var sLen = buffer.readUInt8(offset + 1);\n  assert(sLen > 0, 'S length is zero');\n  var rB = buffer.slice(4, offset);\n  var sB = buffer.slice(offset + 2);\n  offset += 2 + sLen;\n\n  if (rLen > 1 && rB.readUInt8(0) === 0x00) {\n    assert(rB.readUInt8(1) & 0x80, 'R value excessively padded');\n  }\n\n  if (sLen > 1 && sB.readUInt8(0) === 0x00) {\n    assert(sB.readUInt8(1) & 0x80, 'S value excessively padded');\n  }\n\n  assert.equal(offset, buffer.length, 'Invalid DER encoding');\n  var r = BigInteger.fromDERInteger(rB);\n  var s = BigInteger.fromDERInteger(sB);\n  assert(r.signum() >= 0, 'R value is negative');\n  assert(s.signum() >= 0, 'S value is negative');\n  return ECSignature(r, s);\n}; // FIXME: 0x00, 0x04, 0x80 are SIGHASH_* boundary constants, importing Transaction causes a circular dependency\n\n\nECSignature.parseScriptSignature = function (buffer) {\n  var hashType = buffer.readUInt8(buffer.length - 1);\n  var hashTypeMod = hashType & ~0x80;\n  assert(hashTypeMod > 0x00 && hashTypeMod < 0x04, 'Invalid hashType');\n  return {\n    signature: ECSignature.fromDER(buffer.slice(0, -1)),\n    hashType: hashType\n  };\n};\n\nmodule.exports = ECSignature;","\"use strict\";\n\nvar Aes = require(\"./aes\");\n\nvar PrivateKey = require(\"./key_private\");\n\nvar PublicKey = require(\"./key_public\");\n\nvar Signature = require(\"./signature\");\n\nvar key_utils = require(\"./key_utils\");\n\nmodule.exports = {\n  Aes: Aes,\n  PrivateKey: PrivateKey,\n  PublicKey: PublicKey,\n  Signature: Signature,\n  key_utils: key_utils\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AnchorLogo = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS40NCwgMCwgMCwgMS40NCwgLTguNTAxOTI1LCAtNTcuMDc0NTcpIiBzdHlsZT0iIj4KICAgIDx0aXRsZT5XaGl0ZTwvdGl0bGU+CiAgICA8Y2lyY2xlIGN4PSI5NC43OTMiIGN5PSIxMjguNTI0IiByPSI4MCIgZmlsbD0iI0ZCRkRGRiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0gOTQuNzk5IDc4LjUyNCBDIDk3LjA5OCA3OC41MjQgOTkuMTk1IDc5LjgzNyAxMDAuMTk4IDgxLjkwNiBMIDEyNC4yMDQgMTMxLjQwNiBMIDEyNC43NDYgMTMyLjUyNCBMIDExMS40MDkgMTMyLjUyNCBMIDEwNy41MyAxMjQuNTI0IEwgODIuMDY5IDEyNC41MjQgTCA3OC4xODkgMTMyLjUyNCBMIDY0Ljg1MyAxMzIuNTI0IEwgNjUuMzk1IDEzMS40MDYgTCA4OS40MDEgODEuOTA2IEMgOTAuNDA0IDc5LjgzNyA5Mi41MDEgNzguNTI0IDk0Ljc5OSA3OC41MjQgWiBNIDg2LjkxOSAxMTQuNTI0IEwgMTAyLjY4IDExNC41MjQgTCA5NC43OTkgOTguMjc0IEwgODYuOTE5IDExNC41MjQgWiBNIDExMi43OTMgMTQ5LjUyNCBMIDEyNC43OTggMTQ5LjUyNCBDIDEyNC40MzcgMTY1LjY3NiAxMTEuMDY3IDE3OC41MjQgOTQuNzk5IDE3OC41MjQgQyA3OC41MzIgMTc4LjUyNCA2NS4xNjIgMTY1LjY3NiA2NC44MDEgMTQ5LjUyNCBMIDc2LjgwNiAxNDkuNTI0IEMgNzcuMDg3IDE1Ni44NzggODEuOTc0IDE2My4xNTUgODguNzkzIDE2NS41MiBMIDg4Ljc5MyAxNDEuNTI0IEMgODguNzkzIDEzOC4yMSA5MS40OCAxMzUuNTI0IDk0Ljc5MyAxMzUuNTI0IEMgOTguMTA3IDEzNS41MjQgMTAwLjc5MyAxMzguMjEgMTAwLjc5MyAxNDEuNTI0IEwgMTAwLjc5MyAxNjUuNTI0IEMgMTA3LjYyIDE2My4xNjIgMTEyLjUxMSAxNTYuODgzIDExMi43OTMgMTQ5LjUyNCBaIiBmaWxsPSIjMzY1MEEyIi8+CiAgPC9nPgo8L3N2Zz4=\";","import _regeneratorRuntime from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Numeric, Serialize } from 'eosjs';\nimport * as ecc from 'eosjs-ecc';\nimport linkAbi from './link-abi-data';\n/** @internal */\n\nvar types = Serialize.getTypesFromAbi(Serialize.createInitialTypes(), linkAbi);\n/**\n * Helper to ABI encode value.\n * @internal\n */\n\nexport function abiEncode(value, typeName) {\n  var type = types.get(typeName);\n\n  if (!type) {\n    throw new Error(\"No such type: \".concat(typeName));\n  }\n\n  var buf = new Serialize.SerialBuffer();\n  type.serialize(buf, value);\n  return buf.asUint8Array();\n}\n/**\n * Helper to ABI decode data.\n * @internal\n */\n\nexport function abiDecode(data, typeName) {\n  var type = types.get(typeName);\n\n  if (!type) {\n    throw new Error(\"No such type: \".concat(typeName));\n  }\n\n  if (typeof data === 'string') {\n    data = Serialize.hexToUint8Array(data);\n  } else if (!(data instanceof Uint8Array)) {\n    data = new Uint8Array(data);\n  }\n\n  var buf = new Serialize.SerialBuffer({\n    array: data\n  });\n  return type.deserialize(buf);\n}\n/**\n * Encrypt a message using AES and shared secret derived from given keys.\n * @internal\n */\n\nexport function sealMessage(message, privateKey, publicKey) {\n  var res = ecc.Aes.encrypt(privateKey, publicKey, message);\n  var data = {\n    from: ecc.privateToPublic(privateKey),\n    nonce: res.nonce.toString(),\n    ciphertext: res.message,\n    checksum: res.checksum\n  };\n  return abiEncode(data, 'sealed_message');\n}\n/**\n * Ensure public key is in new PUB_ format.\n * @internal\n */\n\nexport function normalizePublicKey(key) {\n  if (key.startsWith('PUB_')) {\n    return key;\n  }\n\n  return Numeric.publicKeyToString(Numeric.stringToPublicKey('EOS' + key.substr(-50)));\n}\n/**\n * Return true if given public keys are equal.\n * @internal\n */\n\nexport function publicKeyEqual(keyA, keyB) {\n  return normalizePublicKey(keyA) === normalizePublicKey(keyB);\n}\n/**\n * Generate a random private key.\n * Uses browser crypto if available, otherwise falls back to slow eosjs-ecc.\n * @internal\n */\n\nexport function generatePrivateKey() {\n  return _generatePrivateKey.apply(this, arguments);\n}\n\nfunction _generatePrivateKey() {\n  _generatePrivateKey = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee() {\n    var data;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(typeof window !== 'undefined' && window.crypto)) {\n              _context.next = 6;\n              break;\n            }\n\n            data = new Uint32Array(32);\n            window.crypto.getRandomValues(data);\n            return _context.abrupt(\"return\", ecc.PrivateKey.fromBuffer(Buffer.from(data)).toString());\n\n          case 6:\n            _context.next = 8;\n            return ecc.randomKey();\n\n          case 8:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _generatePrivateKey.apply(this, arguments);\n}","\"use strict\";\n\nvar commonApi = require('./api_common');\n\nvar objectApi = require('./api_object');\n\nvar ecc = Object.assign({}, commonApi, objectApi);\nmodule.exports = ecc;","\"use strict\";\n\nvar createHash = require('create-hash');\n\nvar createHmac = require('create-hmac');\n/** @namespace hash */\n\n/** @arg {string|Buffer} data\n    @arg {string} [resultEncoding = null] - 'hex', 'binary' or 'base64'\n    @return {string|Buffer} - Buffer when resultEncoding is null, or string\n*/\n\n\nfunction sha1(data, resultEncoding) {\n  return createHash('sha1').update(data).digest(resultEncoding);\n}\n/** @arg {string|Buffer} data\n    @arg {string} [resultEncoding = null] - 'hex', 'binary' or 'base64'\n    @return {string|Buffer} - Buffer when resultEncoding is null, or string\n*/\n\n\nfunction sha256(data, resultEncoding) {\n  return createHash('sha256').update(data).digest(resultEncoding);\n}\n/** @arg {string|Buffer} data\n    @arg {string} [resultEncoding = null] - 'hex', 'binary' or 'base64'\n    @return {string|Buffer} - Buffer when resultEncoding is null, or string\n*/\n\n\nfunction sha512(data, resultEncoding) {\n  return createHash('sha512').update(data).digest(resultEncoding);\n}\n\nfunction HmacSHA256(buffer, secret) {\n  return createHmac('sha256', secret).update(buffer).digest();\n}\n\nfunction ripemd160(data) {\n  try {\n    return createHash('rmd160').update(data).digest();\n  } catch (e) {\n    return createHash('ripemd160').update(data).digest();\n  }\n} // function hash160(buffer) {\n//   return ripemd160(sha256(buffer))\n// }\n//\n// function hash256(buffer) {\n//   return sha256(sha256(buffer))\n// }\n//\n// function HmacSHA512(buffer, secret) {\n//   return crypto.createHmac('sha512', secret).update(buffer).digest()\n// }\n\n\nmodule.exports = {\n  sha1: sha1,\n  sha256: sha256,\n  sha512: sha512,\n  HmacSHA256: HmacSHA256,\n  ripemd160: ripemd160 // hash160: hash160,\n  // hash256: hash256,\n  // HmacSHA512: HmacSHA512\n\n};","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { Anchor } from 'ual-anchor'\nimport { Ledger } from 'ual-ledger'\nimport { Scatter } from 'ual-scatter'\nimport { UALProvider, withUAL } from 'ual-reactjs-renderer'\n\nconst chains = [{\n  chainId: '0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72',\n  name: 'Block.one Testnet',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'api.testnet.eos.io',\n    port: 443,\n  }]\n},{\n  chainId: 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e',\n  name: 'FIO (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'fiotestnet.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: 'e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473',\n  name: 'Jungle 2 (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'jungle.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: '2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840',\n  name: 'Jungle 3 (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'jungle3.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: 'f11d5128e07177823924a07df63bf59fbd07e52c44bc77d16acc1c6e9d22d37b',\n  name: 'Lynx (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'lynxtestnet.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: '1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f',\n  name: 'Telos (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'testnet.eos.miami',\n    port: 443,\n  }]\n},{\n  chainId: 'f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12',\n  name: 'WAX (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'waxtestnet.greymass.com',\n    port: 443,\n  }]\n}]\n\nconst getActionData = (actor, permission, chainId) => {\n  // default data\n  let data = {\n    from: actor,\n    to: 'teamgreymass',\n    quantity: getTransactionAmount(chainId),\n    memo: 'ual-anchor-demo'\n  }\n  switch (chainId) {\n    case '0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72': {\n      data = {\n        from: actor,\n        to: 'csxdbqrkklmm',\n        quantity: getTransactionAmount(chainId),\n        memo: 'ual-anchor-demo'\n      }\n      break\n    }\n    case 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e': {\n      data = {\n        payee_public_key: 'FIO6smr7ThQMWYBHzEvkzTZdxNNmUwxqh2VXdXZdDdzYHgakgqCeb',\n        amount: getTransactionAmount(chainId),\n        max_fee: 2000000000,\n        actor,\n        tpid: null,\n      }\n      break\n    }\n  }\n  return data\n}\n\nconst getContractData = (chainId) => {\n  // default contract/action\n  let account = 'eosio.token'\n  let name = 'transfer'\n  switch (chainId) {\n    case 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e': {\n      account = 'fio.token'\n      name = 'trnsfiopubky'\n      break\n    }\n  }\n  return { account, name }\n}\n\nconst getActions = (actor, permission, chainId) => {\n  const { account, name } = getContractData(chainId)\n  const data = getActionData(actor, permission, chainId)\n  return {\n    actions: [\n      {\n        account,\n        name,\n        authorization: [{ actor, permission }],\n        data,\n      }\n    ],\n  }\n}\n\nconst getTransaction = async (activeUser, actor, permission, chainId) => {\n  const { account, name } = getContractData(chainId)\n  const data = getActionData(actor, permission, chainId)\n  const actions = [{\n    account,\n    name,\n    authorization: [{ actor, permission }],\n    data,\n  }]\n  const info = await activeUser.rpc.get_info()\n  const height = info.last_irreversible_block_num - 3\n  const blockInfo = await activeUser.rpc.get_block(height)\n  const timePlus = new Date().getTime() + (60 * 1000)\n  const timeInISOString = (new Date(timePlus)).toISOString()\n  const expiration = timeInISOString.substr(0, timeInISOString.length - 1)\n  return {\n    actions,\n    context_free_actions: [],\n    transaction_extensions: [],\n    expiration,\n    ref_block_num: blockInfo.block_num & 0xffff,\n    ref_block_prefix: blockInfo.ref_block_prefix,\n    max_cpu_usage_ms: 0,\n    max_net_usage_words: 0,\n    delay_sec: 0,\n  }\n}\n\nconst getTransactionAmount = (chainId) => {\n  let symbol = 'EOS'\n  let quantity = '0.0001'\n  switch (chainId) {\n    case '0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72': {\n      symbol = 'TNT'\n      break\n    }\n    case 'f11d5128e07177823924a07df63bf59fbd07e52c44bc77d16acc1c6e9d22d37b': {\n      symbol = 'LNX'\n      quantity = '0.00000001'\n      break\n    }\n    case '1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f': {\n      symbol = 'TLOS'\n      break\n    }\n    case 'f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12': {\n      symbol = 'WAX'\n      quantity = '0.00000001'\n      break\n    }\n    case 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e': {\n      return parseInt(0.00000001, 10)\n    }\n  }\n  return `${quantity} ${symbol}`\n}\n\nclass TestApp extends Component {\n  static propTypes = {\n    ual: PropTypes.shape({\n      activeUser: PropTypes.object,\n      activeAuthenticator: PropTypes.object,\n      logout: PropTypes.func,\n      showModal: PropTypes.func,\n    }).isRequired,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      chainId: props.chainId,\n      message: '',\n    }\n  }\n\n  purchase = async () => {\n    const { ual: { activeUser } } = this.props\n    try {\n      const { accountName, chainId } = activeUser\n      let { requestPermission } = activeUser\n      if (!requestPermission && activeUser.scatter) {\n        requestPermission = activeUser.scatter.identity.accounts[0].authority\n      }\n      const demoActions = getActions(accountName, requestPermission, chainId)\n      const result = await activeUser.signTransaction(demoActions, { expireSeconds: 120, blocksBehind: 3 })\n      this.setState({\n        message: `Transfer Successful!`,\n      }, () => {\n        setTimeout(this.resetMessage, 5000)\n      })\n      console.info('SUCCESS:', result)\n    } catch (e) {\n      console.error('ERROR:', e)\n    }\n  }\n\n  resetMessage = () => this.setState({ message: '' })\n\n  renderLoggedInView = () => (\n    <>\n      {!!this.state.message\n        && (\n          <div style={styles.announcementBar}>\n            <p style={styles.baseText}>{this.state.message}</p>\n          </div>\n        )\n      }\n      <button type='button' onClick={this.purchase} style={{ ...styles.button, ...styles.blueBG }}>\n        <p style={styles.baseText}>{`Transfer 0.0001`}</p>\n      </button>\n      <table>\n        <tbody>\n          <tr>\n            <td style={styles.td}>Blockchain</td>\n            <td style={styles.td}>{this.props.ual.chains[0].name}</td>\n          </tr>\n          <tr>\n            <td style={styles.td}>Account</td>\n            <td style={styles.td}>{this.props.ual.activeUser.accountName}</td>\n          </tr>\n          <tr>\n            <td style={styles.td}>Permission</td>\n            <td style={styles.td}>{this.props.ual.activeUser.requestPermission}</td>\n          </tr>\n        </tbody>\n      </table>\n      <button type='button' onClick={this.props.ual.logout} style={styles.logout}>\n        <p>Logout</p>\n      </button>\n    </>\n  )\n\n  renderLoginButton = () => (\n    <button type='button' onClick={this.props.ual.showModal} style={styles.button}>\n      <p style={{buttonText: styles.buttonText, baseText: styles.baseText}}>Login using {this.props.ual.chains[0].name}</p>\n    </button>\n  )\n\n  render() {\n    const { ual: { activeUser } } = this.props\n    return (activeUser) ? this.renderLoggedInView() : this.renderLoginButton()\n  }\n}\n\nclass UALWrapper extends Component {\n  constructor(props) {\n    super(props)\n    const search = window.location.search\n    const params = new URLSearchParams(search)\n    const chainId = params.get('chain')\n    this.state = {\n      chainId: chainId || chains[0].chainId\n    }\n  }\n  setChain = (event) => this.setState({ chainId: event.target.value })\n  render () {\n    const { chainId } = this.state\n    const { available } = this.props\n    const [ chain ] = available.filter((c) => c.chainId === chainId)\n    if (!chain) {\n      return (\n        <div>Invalid Chain ID</div>\n      )\n    }\n    const anchor = new Anchor([chain], {\n      // Required: The name of the app requesting a session\n      appName: 'ual-anchor-demo',\n      // Optional: define your own endpoint or eosjs JsonRpc client\n      // rpc: new JsonRpc('https://jungle.greymass.com'),\n      // Optional: define API for session management, defaults to cb.anchor.link\n      service: 'https://cb.anchor.link'\n    })\n    const ledger = new Ledger([chain])\n    const scatter = new Scatter([chain], { appName: 'ual-anchor-demo' })\n    return (\n      <div style={styles.container}>\n        <p>\n          <select\n            defaultValue={chainId}\n            onChange={this.setChain}\n            style={styles.select}\n          >\n            {chains.map((chain) => (\n              <option\n                key={chain.chainId}\n                value={chain.chainId}\n              >\n                {chain.name}\n              </option>\n            ))}\n          </select>\n        </p>\n        <UALProvider\n          appName='Anchor + Authenticator Test App'\n          authenticators={[anchor, ledger, scatter]}\n          chains={[chain]}\n          key={chain.chainId}\n        >\n          <TestAppConsumer />\n        </UALProvider>\n      </div>\n    )\n  }\n}\n\nconst styles = {\n  container: {\n    display: 'flex',\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'top',\n    height: '100vh',\n    marginTop: '10vh',\n    flexDirection: 'column',\n  },\n  button: {\n    padding: '10px 60px',\n    backgroundColor: '#EA2E2E',\n    textAlign: 'center',\n    borderRadius: 5,\n    color: '#FFFFFF',\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: '2em',\n  },\n  select: {\n    textAlign: 'center',\n    borderRadius: 5,\n    fontSize: 24,\n    fontWeight: 'bold',\n    width: '200px',\n  },\n  logout: {\n    marginTop: 20,\n  },\n  baseText: {\n    color: '#fff',\n    fontSize: 18,\n  },\n  blueBG: {\n    backgroundColor: '#447DD8',\n  },\n  announcementBar: {\n    width: '100%',\n    padding: '10px 50px 10px 20px',\n    textAlign: 'center',\n    backgroundColor: '#3de13d',\n    top: 0,\n    position: 'absolute',\n    alignItems: 'center',\n  },\n}\n\nconst TestAppConsumer = withUAL(TestApp)\n\nconst App = () => (\n  <UALWrapper available={chains} />\n)\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import _regeneratorRuntime from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport * as qrcode from 'qrcode';\nimport styleText from './styles';\n\nvar Storage =\n/*#__PURE__*/\nfunction () {\n  function Storage(keyPrefix) {\n    _classCallCheck(this, Storage);\n\n    this.keyPrefix = keyPrefix;\n  }\n\n  _createClass(Storage, [{\n    key: \"write\",\n    value: function () {\n      var _write = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(key, data) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                localStorage.setItem(this.storageKey(key), data);\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function write(_x, _x2) {\n        return _write.apply(this, arguments);\n      }\n\n      return write;\n    }()\n  }, {\n    key: \"read\",\n    value: function () {\n      var _read = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(key) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", localStorage.getItem(this.storageKey(key)));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function read(_x3) {\n        return _read.apply(this, arguments);\n      }\n\n      return read;\n    }()\n  }, {\n    key: \"remove\",\n    value: function () {\n      var _remove = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(key) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                localStorage.removeItem(this.storageKey(key));\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function remove(_x4) {\n        return _remove.apply(this, arguments);\n      }\n\n      return remove;\n    }()\n  }, {\n    key: \"storageKey\",\n    value: function storageKey(key) {\n      return \"\".concat(this.keyPrefix, \"-\").concat(key);\n    }\n  }]);\n\n  return Storage;\n}();\n\nvar BrowserTransport =\n/*#__PURE__*/\nfunction () {\n  function BrowserTransport() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, BrowserTransport);\n\n    this.options = options;\n    this.classPrefix = options.classPrefix || 'anchor-link';\n    this.injectStyles = !(options.injectStyles === false);\n    this.requestStatus = !(options.requestStatus === false);\n    this.storage = new Storage(options.storagePrefix || 'anchor-link');\n  }\n\n  _createClass(BrowserTransport, [{\n    key: \"setupElements\",\n    value: function setupElements() {\n      var _this = this;\n\n      if (this.injectStyles && !this.styleEl) {\n        this.styleEl = document.createElement('style');\n        this.styleEl.type = 'text/css';\n        var css = styleText.replace(/%prefix%/g, this.classPrefix);\n        this.styleEl.appendChild(document.createTextNode(css));\n        document.head.appendChild(this.styleEl);\n      }\n\n      if (!this.containerEl) {\n        this.containerEl = this.createEl();\n        this.containerEl.className = this.classPrefix;\n\n        this.containerEl.onclick = function (event) {\n          if (event.target === _this.containerEl) {\n            event.stopPropagation();\n\n            _this.hide();\n\n            if (_this.activeCancel) {\n              _this.activeRequest = undefined;\n\n              _this.activeCancel('Modal closed');\n\n              _this.activeCancel = undefined;\n            }\n          }\n        };\n\n        document.body.appendChild(this.containerEl);\n      }\n\n      if (!this.requestEl) {\n        var wrapper = this.createEl({\n          class: 'inner'\n        });\n        this.requestEl = this.createEl({\n          class: 'request'\n        });\n        wrapper.appendChild(this.requestEl);\n        this.containerEl.appendChild(wrapper);\n      }\n    }\n  }, {\n    key: \"createEl\",\n    value: function createEl(attrs) {\n      if (!attrs) attrs = {};\n      var el = document.createElement(attrs.tag || 'div');\n\n      if (attrs) {\n        for (var _i = 0, _Object$keys = Object.keys(attrs); _i < _Object$keys.length; _i++) {\n          var attr = _Object$keys[_i];\n          var value = attrs[attr];\n\n          switch (attr) {\n            case 'tag':\n              break;\n\n            case 'text':\n              el.appendChild(document.createTextNode(value));\n              break;\n\n            case 'class':\n              el.className = \"\".concat(this.classPrefix, \"-\").concat(value);\n              break;\n\n            default:\n              el.setAttribute(attr, value);\n          }\n        }\n      }\n\n      return el;\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      if (this.containerEl) {\n        this.containerEl.classList.remove(\"\".concat(this.classPrefix, \"-active\"));\n      }\n\n      this.clearTimers();\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      if (this.containerEl) {\n        this.containerEl.classList.add(\"\".concat(this.classPrefix, \"-active\"));\n      }\n    }\n  }, {\n    key: \"displayRequest\",\n    value: function () {\n      var _displayRequest = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(request) {\n        var sameDeviceRequest, sameDeviceUri, crossDeviceUri, isIdentity, title, subtitle, qrEl, linkEl, linkA, infoEl, infoTitle, infoSubtitle, actionEl, logoEl;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.setupElements();\n                sameDeviceRequest = request.clone();\n                sameDeviceRequest.setInfoKey('same_device', true);\n                sameDeviceRequest.setInfoKey('return_path', returnUrl());\n                sameDeviceUri = sameDeviceRequest.encode(true, false);\n                crossDeviceUri = request.encode(true, false);\n                isIdentity = request.isIdentity();\n                title = isIdentity ? 'Login' : 'Sign';\n                subtitle = 'Scan the QR-code with your Anchor app.';\n                qrEl = this.createEl({\n                  class: 'qr'\n                });\n                _context4.next = 12;\n                return qrcode.toString(crossDeviceUri, {\n                  margin: 0,\n                  errorCorrectionLevel: 'L'\n                });\n\n              case 12:\n                qrEl.innerHTML = _context4.sent;\n                linkEl = this.createEl({\n                  class: 'uri'\n                });\n                linkA = this.createEl({\n                  tag: 'a',\n                  href: crossDeviceUri,\n                  text: 'Open Anchor app'\n                });\n                linkA.addEventListener('click', function (event) {\n                  event.preventDefault();\n                  window.location.href = sameDeviceUri;\n                });\n                linkEl.appendChild(linkA);\n                infoEl = this.createEl({\n                  class: 'info'\n                });\n                infoTitle = this.createEl({\n                  class: 'title',\n                  tag: 'span',\n                  text: title\n                });\n                infoSubtitle = this.createEl({\n                  class: 'subtitle',\n                  tag: 'span',\n                  text: subtitle\n                });\n                infoEl.appendChild(infoTitle);\n                infoEl.appendChild(infoSubtitle);\n                actionEl = this.createEl({\n                  class: 'actions'\n                });\n                actionEl.appendChild(qrEl);\n                actionEl.appendChild(linkEl);\n                emptyElement(this.requestEl);\n                logoEl = this.createEl({\n                  class: 'logo'\n                });\n                this.requestEl.appendChild(logoEl);\n                this.requestEl.appendChild(infoEl);\n                this.requestEl.appendChild(actionEl);\n                this.show();\n\n              case 31:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function displayRequest(_x5) {\n        return _displayRequest.apply(this, arguments);\n      }\n\n      return displayRequest;\n    }()\n  }, {\n    key: \"onRequest\",\n    value: function onRequest(request, cancel) {\n      this.activeRequest = request;\n      this.activeCancel = cancel;\n      this.displayRequest(request).catch(cancel);\n    }\n  }, {\n    key: \"onSessionRequest\",\n    value: function onSessionRequest(session, request, cancel) {\n      if (session.metadata.sameDevice) {\n        request.setInfoKey('return_path', returnUrl());\n      }\n\n      if (session.type === 'fallback') {\n        this.onRequest(request, cancel);\n\n        if (session.metadata.sameDevice) {\n          // trigger directly on a fallback same-device session\n          window.location.href = request.encode();\n        }\n\n        return;\n      }\n\n      this.activeRequest = request;\n      this.activeCancel = cancel;\n      this.setupElements();\n      var timeout = session.metadata.timeout || 60 * 1000 * 2;\n      var deviceName = session.metadata.name;\n      var start = Date.now();\n      var infoTitle = this.createEl({\n        class: 'title',\n        tag: 'span',\n        text: 'Sign'\n      });\n\n      var updateCountdown = function updateCountdown() {\n        var timeLeft = timeout + start - Date.now();\n        var timeFormatted = timeLeft > 0 ? new Date(timeLeft).toISOString().substr(14, 5) : '00:00';\n        infoTitle.textContent = \"Sign - \".concat(timeFormatted);\n      };\n\n      this.countdownTimer = setInterval(updateCountdown, 500);\n      updateCountdown();\n      var infoEl = this.createEl({\n        class: 'info'\n      });\n      infoEl.appendChild(infoTitle);\n      var subtitle;\n\n      if (deviceName && deviceName.length > 0) {\n        subtitle = \"Please open Anchor app on \\u201C\".concat(deviceName, \"\\u201D to review and sign the transaction.\");\n      } else {\n        subtitle = 'Please review and sign the transaction in the linked wallet.';\n      }\n\n      var infoSubtitle = this.createEl({\n        class: 'subtitle',\n        tag: 'span',\n        text: subtitle\n      });\n      infoEl.appendChild(infoSubtitle);\n      emptyElement(this.requestEl);\n      var logoEl = this.createEl({\n        class: 'logo'\n      });\n      this.requestEl.appendChild(logoEl);\n      this.requestEl.appendChild(infoEl);\n      this.show();\n\n      if (isAppleHandheld() && session.metadata.sameDevice) {\n        window.location.href = 'anchor://link';\n      }\n    }\n  }, {\n    key: \"clearTimers\",\n    value: function clearTimers() {\n      if (this.closeTimer) {\n        clearTimeout(this.closeTimer);\n        this.closeTimer = undefined;\n      }\n\n      if (this.countdownTimer) {\n        clearTimeout(this.countdownTimer);\n        this.countdownTimer = undefined;\n      }\n    }\n  }, {\n    key: \"onSuccess\",\n    value: function onSuccess(request) {\n      var _this2 = this;\n\n      if (request === this.activeRequest) {\n        this.clearTimers();\n\n        if (this.requestStatus) {\n          this.setupElements();\n          var infoEl = this.createEl({\n            class: 'info'\n          });\n          var logoEl = this.createEl({\n            class: 'logo'\n          });\n          logoEl.classList.add('success');\n          var infoTitle = this.createEl({\n            class: 'title',\n            tag: 'span',\n            text: 'Success!'\n          });\n          var subtitle = request.isIdentity() ? 'Identity signed.' : 'Transaction signed.';\n          var infoSubtitle = this.createEl({\n            class: 'subtitle',\n            tag: 'span',\n            text: subtitle\n          });\n          infoEl.appendChild(infoTitle);\n          infoEl.appendChild(infoSubtitle);\n          emptyElement(this.requestEl);\n          this.requestEl.appendChild(logoEl);\n          this.requestEl.appendChild(infoEl);\n          this.show();\n          this.closeTimer = setTimeout(function () {\n            _this2.hide();\n          }, 1.5 * 1000);\n        } else {\n          this.hide();\n        }\n      }\n    }\n  }, {\n    key: \"onFailure\",\n    value: function onFailure(request, error) {\n      var _this3 = this;\n\n      if (request === this.activeRequest) {\n        this.clearTimers();\n\n        if (this.requestStatus) {\n          this.setupElements();\n          var infoEl = this.createEl({\n            class: 'info'\n          });\n          var logoEl = this.createEl({\n            class: 'logo'\n          });\n          logoEl.classList.add('error');\n          var infoTitle = this.createEl({\n            class: 'title',\n            tag: 'span',\n            text: 'Transaction error'\n          });\n          var infoSubtitle = this.createEl({\n            class: 'subtitle',\n            tag: 'span',\n            text: error.message || String(error)\n          });\n          infoEl.appendChild(infoTitle);\n          infoEl.appendChild(infoSubtitle);\n          emptyElement(this.requestEl);\n          this.requestEl.appendChild(logoEl);\n          this.requestEl.appendChild(infoEl);\n          this.show();\n          this.closeTimer = setTimeout(function () {\n            _this3.hide();\n          }, 5 * 1000);\n        } else {\n          this.hide();\n        }\n      }\n    }\n  }]);\n\n  return BrowserTransport;\n}();\n\nexport { BrowserTransport as default };\n\nfunction emptyElement(el) {\n  while (el.firstChild) {\n    el.removeChild(el.firstChild);\n  }\n}\n\nvar returnUrlAlphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\nvar returnUrlAlphabetLen = returnUrlAlphabet.length;\n/** Generate a return url with a random #fragment so mobile safari will redirect back w/o reload. */\n\nfunction returnUrl() {\n  var rv = window.location.href.split('#')[0] + '#';\n\n  for (var i = 0; i < 8; i++) {\n    rv += returnUrlAlphabet.charAt(Math.floor(Math.random() * returnUrlAlphabetLen));\n  }\n\n  return rv;\n}\n\nfunction isAppleHandheld() {\n  return /iP(ad|od|hone)/i.test(navigator.userAgent);\n}","export default \"\\n/* Anchor Link */\\n\\n.%prefix% * {\\n    box-sizing: border-box;\\n    line-height: 1;\\n}\\n\\n.%prefix% {\\n    font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\\n        Arial, sans-serif;\\n    font-size: 13px;\\n    background: rgba(0, 0, 0, 0.5);\\n    backdrop-filter: blur(5px);\\n    -webkit-backdrop-filter: blur(5px);\\n    position: fixed;\\n    top: 0px;\\n    left: 0px;\\n    width: 100%;\\n    height: 100%;\\n    z-index: 2147483647;\\n    display: none;\\n    align-items: center;\\n    justify-content: center;\\n}\\n\\n.%prefix%-active {\\n    display: flex;\\n}\\n\\n.%prefix%-inner {\\n    background: #F1F1F1;\\n    margin: 1em;\\n    padding-top: 3.5em;\\n    border-radius: 1.5em;\\n    box-shadow: 0px 4px 100px rgba(0, 0, 0, .5);\\n    width: 24em;\\n}\\n\\n.%prefix%-logo {\\n    width: 5em;\\n    height: 5em;\\n    margin: 0 auto;\\n    margin-top: -3.75em;;\\n    background-image: url(\\\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg viewBox='0 0 160 160' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='80' cy='80' r='80' fill='%233650A2'/%3E%3Cpath d='m80.006 30c2.2988 0 4.3956 1.3134 5.3987 3.3818l24.006 49.5 0.542 1.1178h-13.337l-3.8797-8h-25.461l-3.8798 8h-13.337l0.5423-1.1182 24.006-49.5c1.0031-2.0684 3.0998-3.3818 5.3986-3.3818zm-7.8807 36h15.761l-7.8807-16.25-7.8807 16.25zm25.874 35h12.006c-0.361 16.152-13.731 29-29.999 29s-29.638-12.848-29.998-29h12.005c0.281 7.354 5.1673 13.631 11.987 15.996v-23.996c0-3.3137 2.6863-6 6-6s6 2.6863 6 6v24c6.8262-2.362 11.718-8.641 11.999-16z' clip-rule='evenodd' fill='%23fff' fill-rule='evenodd'/%3E%3C/svg%3E%0A\\\");\\n}\\n\\n.%prefix%-logo.error {\\n    background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%23FC3D39'/%3E%3Cpath fill='%23fff' d='M22.3 48h25.4c2.5 0 4-1.7 4-4a4 4 0 00-.5-2L38.5 19.3a4 4 0 00-3.5-2 4 4 0 00-3.5 2L18.8 42.1c-.3.6-.5 1.3-.5 2 0 2.2 1.6 4 4 4zM35 37c-.9 0-1.4-.6-1.4-1.5l-.2-7.7c0-.9.6-1.6 1.6-1.6s1.7.7 1.7 1.6l-.3 7.7c0 1-.5 1.5-1.4 1.5zm0 6c-1 0-1.9-.8-1.9-1.8s.9-1.8 2-1.8c1 0 1.8.7 1.8 1.8 0 1-.9 1.8-1.9 1.8z'/%3E%3C/svg%3E\\\");\\n}\\n\\n.%prefix%-logo.success {\\n    background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%233DC55D'/%3E%3Cpath fill='%23fff' d='M30.9 49.7a2 2 0 001.8-1L48 24.9c.3-.5.4-1 .4-1.4 0-1-.7-1.7-1.7-1.7-.8 0-1.2.3-1.6 1L30.8 45.4 23.5 36c-.5-.6-1-.9-1.6-.9-1 0-1.8.8-1.8 1.8 0 .4.2.9.6 1.3L29 48.7c.6.7 1.1 1 1.9 1z'/%3E%3C/svg%3E\\\");\\n}\\n\\n.%prefix%-request {\\n    padding: 1.5em;\\n    border-radius: 1.5em;\\n    border-top-left-radius: 0;\\n    border-top-right-radius: 0;\\n    background: white;\\n}\\n\\n.%prefix%-info {\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n    line-height: 2em;\\n}\\n\\n.%prefix%-title {\\n    font-size: 1.8em;\\n    margin-top: 0.5em;\\n    font-weight: bold;\\n}\\n\\n.%prefix%-subtitle {\\n    margin-top: 1em;\\n    color: #5C5C5C;\\n    text-align: center;\\n    margin-bottom: 0.5em;\\n}\\n\\n.%prefix%-actions {\\n    display: flex;\\n    flex-direction: column;\\n    align-items: center;\\n}\\n\\n.%prefix%-uri {\\n    width: 100%;\\n\\n}\\n.%prefix%-uri a {\\n    color: #007AFF;\\n    background: rgba(116, 116, 128, 0.08);\\n    text-decoration: none;\\n    font-size: 1.3em;\\n    flex-grow: 1;\\n    flex: 1;\\n    width: 100%;\\n    padding: 1.5em;\\n    border-radius: 0.75em;\\n    font-weight: 500;\\n    letter-spacing: .01em;\\n    text-align: center;\\n    display: block;\\n    margin-top: 1em;\\n}\\n\\n.%prefix%-qr {\\n    margin-top: 1em;\\n}\\n\\n.%prefix%-qr svg {\\n    width: 100%;\\n}\\n\";","import _objectSpread from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _possibleConstructorReturn from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _regeneratorRuntime from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { SessionError } from './errors';\nimport { abiEncode, sealMessage } from './utils';\n/**\n * Type describing a link session that can create a eosjs compatible\n * signature provider and transact for a specific auth.\n */\n\nexport var LinkSession =\n/*#__PURE__*/\nfunction () {\n  function LinkSession() {\n    _classCallCheck(this, LinkSession);\n  }\n\n  _createClass(LinkSession, [{\n    key: \"remove\",\n\n    /**\n     * Convenience, remove this session from associated [[Link]] storage if set.\n     * Equivalent to:\n     * ```ts\n     * session.link.removeSession(session.identifier, session.auth)\n     * ```\n     */\n    value: function () {\n      var _remove = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.link.storage) {\n                  _context.next = 3;\n                  break;\n                }\n\n                _context.next = 3;\n                return this.link.removeSession(this.identifier, this.auth);\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function remove() {\n        return _remove.apply(this, arguments);\n      }\n\n      return remove;\n    }()\n    /** Restore a previously serialized session. */\n\n  }], [{\n    key: \"restore\",\n    value: function restore(link, data) {\n      switch (data.type) {\n        case 'channel':\n          return new LinkChannelSession(link, data.data, data.metadata);\n\n        case 'fallback':\n          return new LinkFallbackSession(link, data.data, data.metadata);\n\n        default:\n          throw new Error('Unable to restore, session data invalid');\n      }\n    }\n  }]);\n\n  return LinkSession;\n}();\n/**\n * Link session that pushes requests over a channel.\n * @internal\n */\n\nexport var LinkChannelSession =\n/*#__PURE__*/\nfunction (_LinkSession) {\n  _inherits(LinkChannelSession, _LinkSession);\n\n  function LinkChannelSession(link, data, metadata) {\n    var _this;\n\n    _classCallCheck(this, LinkChannelSession);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LinkChannelSession).call(this));\n    _this.type = 'channel';\n    _this.timeout = 2 * 60 * 1000; // ms\n\n    _this.link = link;\n    _this.auth = data.auth;\n    _this.publicKey = data.publicKey;\n    _this.channel = data.channel;\n    _this.identifier = data.identifier;\n\n    _this.encrypt = function (request) {\n      return sealMessage(request.encode(true, false), data.requestKey, data.channel.key);\n    };\n\n    _this.metadata = _objectSpread({}, metadata || {}, {\n      timeout: _this.timeout,\n      name: _this.channel.name\n    });\n\n    _this.serialize = function () {\n      return {\n        type: 'channel',\n        data: data,\n        metadata: _this.metadata\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(LinkChannelSession, [{\n    key: \"onSuccess\",\n    value: function onSuccess(request, result) {\n      if (this.link.transport.onSuccess) {\n        this.link.transport.onSuccess(request, result);\n      }\n    }\n  }, {\n    key: \"onFailure\",\n    value: function onFailure(request, error) {\n      if (this.link.transport.onFailure) {\n        this.link.transport.onFailure(request, error);\n      }\n    }\n  }, {\n    key: \"onRequest\",\n    value: function onRequest(request, cancel) {\n      var info = {\n        expiration: new Date(Date.now() + this.timeout).toISOString().slice(0, -1)\n      };\n\n      if (this.link.transport.onSessionRequest) {\n        this.link.transport.onSessionRequest(this, request, cancel);\n      }\n\n      setTimeout(function () {\n        cancel(new SessionError('Wallet did not respond in time', 'E_TIMEOUT'));\n      }, this.timeout + 500);\n      request.data.info.push({\n        key: 'link',\n        value: abiEncode(info, 'link_info')\n      });\n      this.link.rpc.fetchBuiltin(this.channel.url, {\n        method: 'POST',\n        headers: {\n          'X-Buoy-Wait': (this.timeout / 1000).toFixed(0)\n        },\n        body: this.encrypt(request)\n      }).then(function (response) {\n        if (response.status !== 200) {\n          cancel(new SessionError('Unable to push message', 'E_DELIVERY'));\n        } else {// request delivered\n        }\n      }).catch(function (error) {\n        cancel(new SessionError(\"Unable to reach link service (\".concat(error.message || String(error), \")\"), 'E_DELIVERY'));\n      });\n    }\n  }, {\n    key: \"makeSignatureProvider\",\n    value: function makeSignatureProvider() {\n      return this.link.makeSignatureProvider([this.publicKey], this);\n    }\n  }, {\n    key: \"makeAuthorityProvider\",\n    value: function makeAuthorityProvider() {\n      return this.link.makeAuthorityProvider();\n    }\n  }, {\n    key: \"transact\",\n    value: function transact(tx, options) {\n      return this.link.transact(tx, options, this);\n    }\n  }]);\n\n  return LinkChannelSession;\n}(LinkSession);\n/**\n * Link session that sends every request over the transport.\n * @internal\n */\n\nexport var LinkFallbackSession =\n/*#__PURE__*/\nfunction (_LinkSession2) {\n  _inherits(LinkFallbackSession, _LinkSession2);\n\n  function LinkFallbackSession(link, data, metadata) {\n    var _this2;\n\n    _classCallCheck(this, LinkFallbackSession);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(LinkFallbackSession).call(this));\n    _this2.type = 'fallback';\n    _this2.link = link;\n    _this2.auth = data.auth;\n    _this2.publicKey = data.publicKey;\n    _this2.metadata = metadata || {};\n    _this2.identifier = data.identifier;\n\n    _this2.serialize = function () {\n      return {\n        type: _this2.type,\n        data: data,\n        metadata: _this2.metadata\n      };\n    };\n\n    return _this2;\n  }\n\n  _createClass(LinkFallbackSession, [{\n    key: \"onSuccess\",\n    value: function onSuccess(request, result) {\n      if (this.link.transport.onSuccess) {\n        this.link.transport.onSuccess(request, result);\n      }\n    }\n  }, {\n    key: \"onFailure\",\n    value: function onFailure(request, error) {\n      if (this.link.transport.onFailure) {\n        this.link.transport.onFailure(request, error);\n      }\n    }\n  }, {\n    key: \"onRequest\",\n    value: function onRequest(request, cancel) {\n      if (this.link.transport.onSessionRequest) {\n        this.link.transport.onSessionRequest(this, request, cancel);\n      } else {\n        this.link.transport.onRequest(request, cancel);\n      }\n    }\n  }, {\n    key: \"makeSignatureProvider\",\n    value: function makeSignatureProvider() {\n      return this.link.makeSignatureProvider([this.publicKey], this);\n    }\n  }, {\n    key: \"makeAuthorityProvider\",\n    value: function makeAuthorityProvider() {\n      return this.link.makeAuthorityProvider();\n    }\n  }, {\n    key: \"transact\",\n    value: function transact(tx, options) {\n      return this.link.transact(tx, options, this);\n    }\n  }]);\n\n  return LinkFallbackSession;\n}(LinkSession);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar assert = require('assert');\n\nvar ecurve = require('ecurve');\n\nvar BigInteger = require('bigi');\n\nvar secp256k1 = ecurve.getCurveByName('secp256k1');\n\nvar hash = require('./hash');\n\nvar keyUtils = require('./key_utils');\n\nvar G = secp256k1.G;\nvar n = secp256k1.n;\nmodule.exports = PublicKey;\n/**\n  @param {string|Buffer|PublicKey|ecurve.Point} public key\n  @param {string} [pubkey_prefix = 'EOS']\n*/\n\nfunction PublicKey(Q) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n\n  if (typeof Q === 'string') {\n    var publicKey = PublicKey.fromString(Q, pubkey_prefix);\n    assert(publicKey != null, 'Invalid public key');\n    return publicKey;\n  } else if (Buffer.isBuffer(Q)) {\n    return PublicKey.fromBuffer(Q);\n  } else if ((0, _typeof2[\"default\"])(Q) === 'object' && Q.Q) {\n    return PublicKey(Q.Q);\n  }\n\n  assert.equal((0, _typeof2[\"default\"])(Q), 'object', 'Invalid public key');\n  assert.equal((0, _typeof2[\"default\"])(Q.compressed), 'boolean', 'Invalid public key');\n\n  function toBuffer() {\n    var compressed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Q.compressed;\n    return Q.getEncoded(compressed);\n  }\n\n  var pubdata; // cache\n  // /**\n  //     @todo secp224r1\n  //     @return {string} PUB_K1_base58pubkey..\n  // */\n  // function toString() {\n  //     if(pubdata) {\n  //         return pubdata\n  //     }\n  //     pubdata = `PUB_K1_` + keyUtils.checkEncode(toBuffer(), 'K1')\n  //     return pubdata;\n  // }\n\n  /** @todo rename to toStringLegacy\n   * @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n  */\n\n  function toString() {\n    var pubkey_prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'EOS';\n    return pubkey_prefix + keyUtils.checkEncode(toBuffer());\n  }\n\n  function toUncompressed() {\n    var buf = Q.getEncoded(false);\n    var point = ecurve.Point.decodeFrom(secp256k1, buf);\n    return PublicKey.fromPoint(point);\n  }\n  /** @deprecated */\n\n\n  function child(offset) {\n    console.error('Deprecated warning: PublicKey.child');\n    assert(Buffer.isBuffer(offset), \"Buffer required: offset\");\n    assert.equal(offset.length, 32, \"offset length\");\n    offset = Buffer.concat([toBuffer(), offset]);\n    offset = hash.sha256(offset);\n    var c = BigInteger.fromBuffer(offset);\n    if (c.compareTo(n) >= 0) throw new Error(\"Child offset went out of bounds, try again\");\n    var cG = G.multiply(c);\n    var Qprime = Q.add(cG);\n    if (secp256k1.isInfinity(Qprime)) throw new Error(\"Child offset derived to an invalid key, try again\");\n    return PublicKey.fromPoint(Qprime);\n  }\n\n  function toHex() {\n    return toBuffer().toString('hex');\n  }\n\n  return {\n    Q: Q,\n    toString: toString,\n    // toStringLegacy,\n    toUncompressed: toUncompressed,\n    toBuffer: toBuffer,\n    child: child,\n    toHex: toHex\n  };\n}\n/**\n  @param {string|Buffer|PublicKey|ecurve.Point} pubkey - public key\n  @param {string} [pubkey_prefix = 'EOS']\n*/\n\n\nPublicKey.isValid = function (pubkey) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n\n  try {\n    PublicKey(pubkey, pubkey_prefix);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n\nPublicKey.fromBinary = function (bin) {\n  return PublicKey.fromBuffer(new Buffer(bin, 'binary'));\n};\n\nPublicKey.fromBuffer = function (buffer) {\n  return PublicKey(ecurve.Point.decodeFrom(secp256k1, buffer));\n};\n\nPublicKey.fromPoint = function (point) {\n  return PublicKey(point);\n};\n/**\n    @arg {string} public_key - like PUB_K1_base58pubkey..\n    @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n    @return PublicKey or `null` (invalid)\n*/\n\n\nPublicKey.fromString = function (public_key) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n\n  try {\n    return PublicKey.fromStringOrThrow(public_key, pubkey_prefix);\n  } catch (e) {\n    return null;\n  }\n};\n/**\n    @arg {string} public_key - like PUB_K1_base58pubkey..\n    @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n\n    @throws {Error} if public key is invalid\n\n    @return PublicKey\n*/\n\n\nPublicKey.fromStringOrThrow = function (public_key) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n  assert.equal((0, _typeof2[\"default\"])(public_key), 'string', 'public_key');\n  var match = public_key.match(/^PUB_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);\n\n  if (match === null) {\n    // legacy\n    var prefix_match = new RegExp(\"^\" + pubkey_prefix);\n\n    if (prefix_match.test(public_key)) {\n      public_key = public_key.substring(pubkey_prefix.length);\n    }\n\n    return PublicKey.fromBuffer(keyUtils.checkDecode(public_key));\n  }\n\n  assert(match.length === 3, 'Expecting public key like: PUB_K1_base58pubkey..');\n\n  var _match = (0, _slicedToArray2[\"default\"])(match, 3),\n      keyType = _match[1],\n      keyString = _match[2];\n\n  assert.equal(keyType, 'K1', 'K1 private key expected');\n  return PublicKey.fromBuffer(keyUtils.checkDecode(keyString, keyType));\n};\n\nPublicKey.fromHex = function (hex) {\n  return PublicKey.fromBuffer(new Buffer(hex, 'hex'));\n};\n\nPublicKey.fromStringHex = function (hex) {\n  return PublicKey.fromString(new Buffer(hex, 'hex'));\n};","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar base58 = require('bs58');\n\nvar assert = require('assert');\n\nvar randomBytes = require('randombytes');\n\nvar hash = require('./hash');\n\nmodule.exports = {\n  random32ByteBuffer: random32ByteBuffer,\n  addEntropy: addEntropy,\n  cpuEntropy: cpuEntropy,\n  entropyCount: function entropyCount() {\n    return _entropyCount;\n  },\n  checkDecode: checkDecode,\n  checkEncode: checkEncode\n};\nvar entropyPos = 0,\n    _entropyCount = 0;\nvar externalEntropyArray = randomBytes(101);\n/**\n    Additional forms of entropy are used.  A week random number generator can run out of entropy.  This should ensure even the worst random number implementation will be reasonably safe.\n\n    @arg {number} [cpuEntropyBits = 0] generate entropy on the fly.  This is\n    not required, entropy can be added in advanced via addEntropy or initialize().\n\n    @arg {boolean} [safe = true] false for testing, otherwise this will be\n    true to ensure initialize() was called.\n\n    @return a random buffer obtained from the secure random number generator.  Additional entropy is used.\n*/\n\nfunction random32ByteBuffer() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$cpuEntropyBits = _ref.cpuEntropyBits,\n      cpuEntropyBits = _ref$cpuEntropyBits === void 0 ? 0 : _ref$cpuEntropyBits,\n      _ref$safe = _ref.safe,\n      safe = _ref$safe === void 0 ? true : _ref$safe;\n\n  assert.equal((0, _typeof2[\"default\"])(cpuEntropyBits), 'number', 'cpuEntropyBits');\n  assert.equal((0, _typeof2[\"default\"])(safe), 'boolean', 'boolean');\n\n  if (safe) {\n    assert(_entropyCount >= 128, 'Call initialize() to add entropy');\n  } // if(entropyCount > 0) {\n  //     console.log(`Additional private key entropy: ${entropyCount} events`)\n  // }\n\n\n  var hash_array = [];\n  hash_array.push(randomBytes(32));\n  hash_array.push(Buffer.from(cpuEntropy(cpuEntropyBits)));\n  hash_array.push(externalEntropyArray);\n  hash_array.push(browserEntropy());\n  return hash.sha256(Buffer.concat(hash_array));\n}\n/**\n    Adds entropy.  This may be called many times while the amount of data saved\n    is accumulatively reduced to 101 integers.  Data is retained in RAM for the\n    life of this module.\n\n    @example React <code>\n    componentDidMount() {\n        this.refs.MyComponent.addEventListener(\"mousemove\", this.onEntropyEvent, {capture: false, passive: true})\n    }\n    componentWillUnmount() {\n        this.refs.MyComponent.removeEventListener(\"mousemove\", this.onEntropyEvent);\n    }\n    onEntropyEvent = (e) => {\n        if(e.type === 'mousemove')\n            key_utils.addEntropy(e.pageX, e.pageY, e.screenX, e.screenY)\n        else\n            console.log('onEntropyEvent Unknown', e.type, e)\n    }\n    </code>\n*/\n\n\nfunction addEntropy() {\n  assert.equal(externalEntropyArray.length, 101, 'externalEntropyArray');\n\n  for (var _len = arguments.length, ints = new Array(_len), _key = 0; _key < _len; _key++) {\n    ints[_key] = arguments[_key];\n  }\n\n  _entropyCount += ints.length;\n\n  for (var _i = 0, _ints = ints; _i < _ints.length; _i++) {\n    var i = _ints[_i];\n    var pos = entropyPos++ % 101;\n    var i2 = externalEntropyArray[pos] += i;\n    if (i2 > 9007199254740991) externalEntropyArray[pos] = 0;\n  }\n}\n/**\n    This runs in just under 1 second and ensures a minimum of cpuEntropyBits\n    bits of entropy are gathered.\n\n    Based on more-entropy. @see https://github.com/keybase/more-entropy/blob/master/src/generator.iced\n\n    @arg {number} [cpuEntropyBits = 128]\n    @return {array} counts gathered by measuring variations in the CPU speed during floating point operations.\n*/\n\n\nfunction cpuEntropy() {\n  var cpuEntropyBits = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 128;\n  var collected = [];\n  var lastCount = null;\n  var lowEntropySamples = 0;\n\n  while (collected.length < cpuEntropyBits) {\n    var count = floatingPointCount();\n\n    if (lastCount != null) {\n      var delta = count - lastCount;\n\n      if (Math.abs(delta) < 1) {\n        lowEntropySamples++;\n        continue;\n      } // how many bits of entropy were in this sample\n\n\n      var bits = Math.floor(log2(Math.abs(delta)) + 1);\n\n      if (bits < 4) {\n        if (bits < 2) {\n          lowEntropySamples++;\n        }\n\n        continue;\n      }\n\n      collected.push(delta);\n    }\n\n    lastCount = count;\n  }\n\n  if (lowEntropySamples > 10) {\n    var pct = Number(lowEntropySamples / cpuEntropyBits * 100).toFixed(2); // Is this algorithm getting inefficient?\n\n    console.warn(\"WARN: \".concat(pct, \"% low CPU entropy re-sampled\"));\n  }\n\n  return collected;\n}\n/**\n    @private\n    Count while performing floating point operations during a fixed time\n    (7 ms for example).  Using a fixed time makes this algorithm\n    predictable in runtime.\n*/\n\n\nfunction floatingPointCount() {\n  var workMinMs = 7;\n  var d = Date.now();\n  var i = 0,\n      x = 0;\n\n  while (Date.now() < d + workMinMs + 1) {\n    x = Math.sin(Math.sqrt(Math.log(++i + x)));\n  }\n\n  return i;\n}\n\nvar log2 = function log2(x) {\n  return Math.log(x) / Math.LN2;\n};\n/**\n    @private\n    Attempt to gather and hash information from the browser's window, history, and supported mime types.  For non-browser environments this simply includes secure random data.  In any event, the information is re-hashed in a loop for 25 milliseconds seconds.\n\n    @return {Buffer} 32 bytes\n*/\n\n\nfunction browserEntropy() {\n  var entropyStr = Array(randomBytes(101)).join();\n\n  try {\n    entropyStr += new Date().toString() + \" \" + window.screen.height + \" \" + window.screen.width + \" \" + window.screen.colorDepth + \" \" + \" \" + window.screen.availHeight + \" \" + window.screen.availWidth + \" \" + window.screen.pixelDepth + navigator.language + \" \" + window.location + \" \" + window.history.length;\n\n    for (var i = 0, mimeType; i < navigator.mimeTypes.length; i++) {\n      mimeType = navigator.mimeTypes[i];\n      entropyStr += mimeType.description + \" \" + mimeType.type + \" \" + mimeType.suffixes + \" \";\n    }\n  } catch (error) {\n    //nodejs:ReferenceError: window is not defined\n    entropyStr += hash.sha256(new Date().toString());\n  }\n\n  var b = new Buffer(entropyStr);\n  entropyStr += b.toString('binary') + \" \" + new Date().toString();\n  var entropy = entropyStr;\n  var start_t = Date.now();\n\n  while (Date.now() - start_t < 25) {\n    entropy = hash.sha256(entropy);\n  }\n\n  return entropy;\n}\n/**\n  @arg {Buffer} keyBuffer data\n  @arg {string} keyType = sha256x2, K1, etc\n  @return {string} checksum encoded base58 string\n*/\n\n\nfunction checkEncode(keyBuffer) {\n  var keyType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  assert(Buffer.isBuffer(keyBuffer), 'expecting keyBuffer<Buffer>');\n\n  if (keyType === 'sha256x2') {\n    // legacy\n    var checksum = hash.sha256(hash.sha256(keyBuffer)).slice(0, 4);\n    return base58.encode(Buffer.concat([keyBuffer, checksum]));\n  } else {\n    var check = [keyBuffer];\n\n    if (keyType) {\n      check.push(Buffer.from(keyType));\n    }\n\n    var _checksum = hash.ripemd160(Buffer.concat(check)).slice(0, 4);\n\n    return base58.encode(Buffer.concat([keyBuffer, _checksum]));\n  }\n}\n/**\n  @arg {Buffer} keyString data\n  @arg {string} keyType = sha256x2, K1, etc\n  @return {string} checksum encoded base58 string\n*/\n\n\nfunction checkDecode(keyString) {\n  var keyType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  assert(keyString != null, 'private key expected');\n  var buffer = new Buffer(base58.decode(keyString));\n  var checksum = buffer.slice(-4);\n  var key = buffer.slice(0, -4);\n  var newCheck;\n\n  if (keyType === 'sha256x2') {\n    // legacy\n    newCheck = hash.sha256(hash.sha256(key)).slice(0, 4); // WIF (legacy)\n  } else {\n    var check = [key];\n\n    if (keyType) {\n      check.push(Buffer.from(keyType));\n    }\n\n    newCheck = hash.ripemd160(Buffer.concat(check)).slice(0, 4); //PVT\n  }\n\n  if (checksum.toString('hex') !== newCheck.toString('hex')) {\n    throw new Error('Invalid checksum, ' + \"\".concat(checksum.toString('hex'), \" != \").concat(newCheck.toString('hex')));\n  }\n\n  return key;\n}","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar ecurve = require('ecurve');\n\nvar Point = ecurve.Point;\nvar secp256k1 = ecurve.getCurveByName('secp256k1');\n\nvar BigInteger = require('bigi');\n\nvar assert = require('assert');\n\nvar hash = require('./hash');\n\nvar PublicKey = require('./key_public');\n\nvar keyUtils = require('./key_utils');\n\nvar createHash = require('create-hash');\n\nvar promiseAsync = require('./promise-async');\n\nvar G = secp256k1.G;\nvar n = secp256k1.n;\nmodule.exports = PrivateKey;\n/**\n  @typedef {string} wif - https://en.bitcoin.it/wiki/Wallet_import_format\n  @typedef {string} pubkey - EOSKey..\n  @typedef {ecurve.Point} Point\n*/\n\n/**\n  @param {BigInteger} d\n*/\n\nfunction PrivateKey(d) {\n  if (typeof d === 'string') {\n    return PrivateKey.fromString(d);\n  } else if (Buffer.isBuffer(d)) {\n    return PrivateKey.fromBuffer(d);\n  } else if ((0, _typeof2[\"default\"])(d) === 'object' && BigInteger.isBigInteger(d.d)) {\n    return PrivateKey(d.d);\n  }\n\n  if (!BigInteger.isBigInteger(d)) {\n    throw new TypeError('Invalid private key');\n  }\n  /** @return {string} private key like PVT_K1_base58privatekey.. */\n\n\n  function toString() {\n    // todo, use PVT_K1_\n    // return 'PVT_K1_' + keyUtils.checkEncode(toBuffer(), 'K1')\n    return toWif();\n  }\n  /**\n      @return  {wif}\n  */\n\n\n  function toWif() {\n    var private_key = toBuffer(); // checksum includes the version\n\n    private_key = Buffer.concat([new Buffer([0x80]), private_key]);\n    return keyUtils.checkEncode(private_key, 'sha256x2');\n  }\n\n  var public_key;\n  /**\n      @return {Point}\n  */\n\n  function toPublic() {\n    if (public_key) {\n      // cache\n      // S L O W in the browser\n      return public_key;\n    }\n\n    var Q = secp256k1.G.multiply(d);\n    return public_key = PublicKey.fromPoint(Q);\n  }\n\n  function toBuffer() {\n    return d.toBuffer(32);\n  }\n  /**\n    ECIES\n    @arg {string|Object} pubkey wif, PublicKey object\n    @return {Buffer} 64 byte shared secret\n  */\n\n\n  function getSharedSecret(public_key) {\n    public_key = PublicKey(public_key);\n    var KB = public_key.toUncompressed().toBuffer();\n    var KBP = Point.fromAffine(secp256k1, BigInteger.fromBuffer(KB.slice(1, 33)), // x\n    BigInteger.fromBuffer(KB.slice(33, 65)) // y\n    );\n    var r = toBuffer();\n    var P = KBP.multiply(BigInteger.fromBuffer(r));\n    var S = P.affineX.toBuffer({\n      size: 32\n    }); // SHA512 used in ECIES\n\n    return hash.sha512(S);\n  } // /** ECIES TODO unit test\n  //   @arg {string|Object} pubkey wif, PublicKey object\n  //   @return {Buffer} 64 byte shared secret\n  // */\n  // function getSharedSecret(public_key) {\n  //     public_key = PublicKey(public_key).toUncompressed()\n  //     var P = public_key.Q.multiply( d );\n  //     var S = P.affineX.toBuffer({size: 32});\n  //     // ECIES, adds an extra sha512\n  //     return hash.sha512(S);\n  // }\n\n  /**\n    @arg {string} name - child key name.\n    @return {PrivateKey}\n     @example activePrivate = masterPrivate.getChildKey('owner').getChildKey('active')\n    @example activePrivate.getChildKey('mycontract').getChildKey('myperm')\n  */\n\n\n  function getChildKey(name) {\n    // console.error('WARNING: getChildKey untested against eosd'); // no eosd impl yet\n    var index = createHash('sha256').update(toBuffer()).update(name).digest();\n    return PrivateKey(index);\n  }\n\n  function toHex() {\n    return toBuffer().toString('hex');\n  }\n\n  return {\n    d: d,\n    toWif: toWif,\n    toString: toString,\n    toPublic: toPublic,\n    toBuffer: toBuffer,\n    getSharedSecret: getSharedSecret,\n    getChildKey: getChildKey\n  };\n}\n/** @private */\n\n\nfunction parseKey(privateStr) {\n  assert.equal((0, _typeof2[\"default\"])(privateStr), 'string', 'privateStr');\n  var match = privateStr.match(/^PVT_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);\n\n  if (match === null) {\n    // legacy WIF - checksum includes the version\n    var versionKey = keyUtils.checkDecode(privateStr, 'sha256x2');\n    var version = versionKey.readUInt8(0);\n    assert.equal(0x80, version, \"Expected version \".concat(0x80, \", instead got \", version));\n\n    var _privateKey = PrivateKey.fromBuffer(versionKey.slice(1));\n\n    var _keyType = 'K1';\n    var format = 'WIF';\n    return {\n      privateKey: _privateKey,\n      format: format,\n      keyType: _keyType\n    };\n  }\n\n  assert(match.length === 3, 'Expecting private key like: PVT_K1_base58privateKey..');\n\n  var _match = (0, _slicedToArray2[\"default\"])(match, 3),\n      keyType = _match[1],\n      keyString = _match[2];\n\n  assert.equal(keyType, 'K1', 'K1 private key expected');\n  var privateKey = PrivateKey.fromBuffer(keyUtils.checkDecode(keyString, keyType));\n  return {\n    privateKey: privateKey,\n    format: 'PVT',\n    keyType: keyType\n  };\n}\n\nPrivateKey.fromHex = function (hex) {\n  return PrivateKey.fromBuffer(new Buffer(hex, 'hex'));\n};\n\nPrivateKey.fromBuffer = function (buf) {\n  if (!Buffer.isBuffer(buf)) {\n    throw new Error(\"Expecting parameter to be a Buffer type\");\n  }\n\n  if (buf.length === 33 && buf[32] === 1) {\n    // remove compression flag\n    buf = buf.slice(0, -1);\n  }\n\n  if (32 !== buf.length) {\n    throw new Error(\"Expecting 32 bytes, instead got \".concat(buf.length));\n  }\n\n  return PrivateKey(BigInteger.fromBuffer(buf));\n};\n/**\n    @arg {string} seed - any length string.  This is private, the same seed\n    produces the same private key every time.\n\n    @return {PrivateKey}\n*/\n\n\nPrivateKey.fromSeed = function (seed) {\n  // generate_private_key\n  if (!(typeof seed === 'string')) {\n    throw new Error('seed must be of type string');\n  }\n\n  return PrivateKey.fromBuffer(hash.sha256(seed));\n};\n/**\n  @arg {wif} key\n  @return {boolean} true if key is in the Wallet Import Format\n*/\n\n\nPrivateKey.isWif = function (text) {\n  try {\n    assert(parseKey(text).format === 'WIF');\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n/**\n  @arg {wif|Buffer|PrivateKey} key\n  @return {boolean} true if key is convertable to a private key object.\n*/\n\n\nPrivateKey.isValid = function (key) {\n  try {\n    PrivateKey(key);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n/** @deprecated */\n\n\nPrivateKey.fromWif = function (str) {\n  console.log('PrivateKey.fromWif is deprecated, please use PrivateKey.fromString');\n  return PrivateKey.fromString(str);\n};\n/**\n    @throws {AssertError|Error} parsing key\n    @arg {string} privateStr Eosio or Wallet Import Format (wif) -- a secret\n*/\n\n\nPrivateKey.fromString = function (privateStr) {\n  return parseKey(privateStr).privateKey;\n};\n/**\n  Create a new random private key.\n\n  Call initialize() first to run some self-checking code and gather some CPU\n  entropy.\n\n  @arg {number} [cpuEntropyBits = 0] - additional CPU entropy, this already\n  happens once so it should not be needed again.\n\n  @return {Promise<PrivateKey>} - random private key\n*/\n\n\nPrivateKey.randomKey = function () {\n  var cpuEntropyBits = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return PrivateKey.initialize().then(function () {\n    return PrivateKey.fromBuffer(keyUtils.random32ByteBuffer({\n      cpuEntropyBits: cpuEntropyBits\n    }));\n  });\n};\n/**\n  @return {Promise<PrivateKey>} for testing, does not require initialize().\n*/\n\n\nPrivateKey.unsafeRandomKey = function () {\n  return Promise.resolve(PrivateKey.fromBuffer(keyUtils.random32ByteBuffer({\n    safe: false\n  })));\n};\n\nvar initialized = false,\n    unitTested = false;\n/**\n  Run self-checking code and gather CPU entropy.\n\n  Initialization happens once even if called multiple times.\n\n  @return {Promise}\n*/\n\nfunction initialize() {\n  if (initialized) {\n    return;\n  }\n\n  unitTest();\n  keyUtils.addEntropy.apply(keyUtils, (0, _toConsumableArray2[\"default\"])(keyUtils.cpuEntropy()));\n  assert(keyUtils.entropyCount() >= 128, 'insufficient entropy');\n  initialized = true;\n}\n\nPrivateKey.initialize = promiseAsync(initialize);\n/**\n  Unit test basic private and public key functionality.\n\n  @throws {AssertError}\n*/\n\nfunction unitTest() {\n  var pvt = PrivateKey(hash.sha256(''));\n  var pvtError = 'key comparison test failed on a known private key';\n  assert.equal(pvt.toWif(), '5KYZdUEo39z3FPrtuX2QbbwGnNP5zTd7yyr2SC1j299sBCnWjss', pvtError);\n  assert.equal(pvt.toString(), '5KYZdUEo39z3FPrtuX2QbbwGnNP5zTd7yyr2SC1j299sBCnWjss', pvtError); // assert.equal(pvt.toString(), 'PVT_K1_2jH3nnhxhR3zPUcsKaWWZC9ZmZAnKm3GAnFD1xynGJE1Znuvjd', pvtError)\n\n  var pub = pvt.toPublic();\n  var pubError = 'pubkey string comparison test failed on a known public key';\n  assert.equal(pub.toString(), 'EOS859gxfnXyUriMgUeThh1fWv3oqcpLFyHa3TfFYC4PK2HqhToVM', pubError); // assert.equal(pub.toString(), 'PUB_K1_859gxfnXyUriMgUeThh1fWv3oqcpLFyHa3TfFYC4PK2Ht7beeX', pubError)\n  // assert.equal(pub.toStringLegacy(), 'EOS859gxfnXyUriMgUeThh1fWv3oqcpLFyHa3TfFYC4PK2HqhToVM', pubError)\n\n  doesNotThrow(function () {\n    return PrivateKey.fromString(pvt.toWif());\n  }, 'converting known wif from string');\n  doesNotThrow(function () {\n    return PrivateKey.fromString(pvt.toString());\n  }, 'converting known pvt from string');\n  doesNotThrow(function () {\n    return PublicKey.fromString(pub.toString());\n  }, 'converting known public key from string'); // doesNotThrow(() => PublicKey.fromString(pub.toStringLegacy()), 'converting known public key from string')\n\n  unitTested = true;\n}\n/** @private */\n\n\nvar doesNotThrow = function doesNotThrow(cb, msg) {\n  try {\n    cb();\n  } catch (error) {\n    error.message = \"\".concat(msg, \" ==> \").concat(error.message);\n    throw error;\n  }\n};","import _objectSpread from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/aaron/projects/ual-anchor-demo/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport * as esr from 'eosio-signing-request';\nimport { JsonRpc } from 'eosjs';\nimport * as ecc from 'eosjs-ecc';\nimport makeFetch from 'fetch-ponyfill';\nimport WebSocket from 'isomorphic-ws';\nimport zlib from 'pako';\nimport { v4 as uuid } from 'uuid';\nimport { CancelError, IdentityError } from './errors';\nimport { defaults } from './link-options';\nimport { LinkChannelSession, LinkFallbackSession, LinkSession } from './link-session';\nimport { abiEncode, generatePrivateKey, normalizePublicKey, publicKeyEqual } from './utils';\n/** @internal */\n\nvar fetch = makeFetch().fetch;\n/**\n * Main class, also exposed as the default export of the library.\n *\n * Example:\n *\n * ```ts\n * import AnchorLink from 'anchor-link'\n * import ConsoleTransport from 'anchor-link-console-transport'\n *\n * const link = new AnchorLink({\n *     transport: new ConsoleTransport()\n * })\n *\n * const result = await link.transact({actions: myActions, broadcast: true})\n * ```\n */\n\nexport var Link =\n/*#__PURE__*/\nfunction () {\n  /** Create a new link instance. */\n  function Link(options) {\n    _classCallCheck(this, Link);\n\n    this.abiCache = new Map();\n\n    if (typeof options !== 'object') {\n      throw new TypeError('Missing options object');\n    }\n\n    if (!options.transport) {\n      throw new TypeError('options.transport is required, see https://github.com/greymass/anchor-link#transports');\n    }\n\n    if (options.rpc === undefined || typeof options.rpc === 'string') {\n      this.rpc = new JsonRpc(options.rpc || defaults.rpc, {\n        fetch: fetch\n      });\n    } else {\n      this.rpc = options.rpc;\n    }\n\n    if (options.chainId) {\n      this.chainId = typeof options.chainId === 'number' ? esr.nameToId(options.chainId) : options.chainId;\n    } else {\n      this.chainId = defaults.chainId;\n    }\n\n    this.serviceAddress = (options.service || defaults.service).trim().replace(/\\/$/, '');\n    this.transport = options.transport;\n\n    if (options.storage !== null) {\n      this.storage = options.storage || this.transport.storage;\n    }\n\n    this.requestOptions = {\n      abiProvider: this,\n      textDecoder: options.textDecoder || new TextDecoder(),\n      textEncoder: options.textEncoder || new TextEncoder(),\n      zlib: zlib\n    };\n  }\n  /**\n   * Fetch the ABI for given account, cached.\n   * @internal\n   */\n\n\n  _createClass(Link, [{\n    key: \"getAbi\",\n    value: function () {\n      var _getAbi = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(account) {\n        var rv;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                rv = this.abiCache.get(account);\n\n                if (rv) {\n                  _context.next = 6;\n                  break;\n                }\n\n                _context.next = 4;\n                return this.rpc.get_abi(account);\n\n              case 4:\n                rv = _context.sent.abi;\n\n                if (rv) {\n                  this.abiCache.set(account, rv);\n                }\n\n              case 6:\n                return _context.abrupt(\"return\", rv);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAbi(_x) {\n        return _getAbi.apply(this, arguments);\n      }\n\n      return getAbi;\n    }()\n    /**\n     * Create a new unique buoy callback url.\n     * @internal\n     */\n\n  }, {\n    key: \"createCallbackUrl\",\n    value: function createCallbackUrl() {\n      return \"\".concat(this.serviceAddress, \"/\").concat(uuid());\n    }\n    /**\n     * Create a SigningRequest instance configured for this link.\n     * @internal\n     */\n\n  }, {\n    key: \"createRequest\",\n    value: function () {\n      var _createRequest = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(args) {\n        var request;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return esr.SigningRequest.create(_objectSpread({}, args, {\n                  chainId: this.chainId,\n                  broadcast: false,\n                  callback: {\n                    url: this.createCallbackUrl(),\n                    background: true\n                  }\n                }), this.requestOptions);\n\n              case 2:\n                request = _context2.sent;\n                return _context2.abrupt(\"return\", request);\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function createRequest(_x2) {\n        return _createRequest.apply(this, arguments);\n      }\n\n      return createRequest;\n    }()\n    /**\n     * Send a SigningRequest instance using this link.\n     * @internal\n     */\n\n  }, {\n    key: \"sendRequest\",\n    value: function () {\n      var _sendRequest = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(request, transport) {\n        var broadcast,\n            t,\n            linkUrl,\n            ctx,\n            socket,\n            cancel,\n            payload,\n            signer,\n            signatures,\n            resolved,\n            serializedTransaction,\n            transaction,\n            result,\n            res,\n            _args3 = arguments;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                broadcast = _args3.length > 2 && _args3[2] !== undefined ? _args3[2] : false;\n                t = transport || this.transport;\n                _context3.prev = 2;\n                linkUrl = request.data.callback;\n\n                if (linkUrl.startsWith(this.serviceAddress)) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                throw new Error('Request must have a link callback');\n\n              case 6:\n                if (!(request.data.flags !== 2)) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                throw new Error('Invalid request flags');\n\n              case 8:\n                // wait for callback or user cancel\n                ctx = {};\n                socket = waitForCallback(linkUrl, ctx);\n                cancel = new Promise(function (resolve, reject) {\n                  t.onRequest(request, function (reason) {\n                    if (ctx.cancel) {\n                      ctx.cancel();\n                    }\n\n                    if (typeof reason === 'string') {\n                      reject(new CancelError(reason));\n                    } else {\n                      reject(reason);\n                    }\n                  });\n                });\n                _context3.next = 13;\n                return Promise.race([socket, cancel]);\n\n              case 13:\n                payload = _context3.sent;\n                signer = {\n                  actor: payload.sa,\n                  permission: payload.sp\n                };\n                signatures = Object.keys(payload).filter(function (key) {\n                  return key.startsWith('sig') && key !== 'sig0';\n                }).map(function (key) {\n                  return payload[key];\n                }); // recreate transaction from request response\n\n                _context3.next = 18;\n                return esr.ResolvedSigningRequest.fromPayload(payload, this.requestOptions);\n\n              case 18:\n                resolved = _context3.sent;\n                serializedTransaction = resolved.serializedTransaction, transaction = resolved.transaction;\n                result = {\n                  request: resolved.request,\n                  serializedTransaction: serializedTransaction,\n                  transaction: transaction,\n                  signatures: signatures,\n                  payload: payload,\n                  signer: signer\n                };\n\n                if (!broadcast) {\n                  _context3.next = 26;\n                  break;\n                }\n\n                _context3.next = 24;\n                return this.rpc.push_transaction({\n                  signatures: result.signatures,\n                  serializedTransaction: result.serializedTransaction\n                });\n\n              case 24:\n                res = _context3.sent;\n                result.processed = res.processed;\n\n              case 26:\n                if (t.onSuccess) {\n                  t.onSuccess(request, result);\n                }\n\n                return _context3.abrupt(\"return\", result);\n\n              case 30:\n                _context3.prev = 30;\n                _context3.t0 = _context3[\"catch\"](2);\n\n                if (t.onFailure) {\n                  t.onFailure(request, _context3.t0);\n                }\n\n                throw _context3.t0;\n\n              case 34:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[2, 30]]);\n      }));\n\n      function sendRequest(_x3, _x4) {\n        return _sendRequest.apply(this, arguments);\n      }\n\n      return sendRequest;\n    }()\n    /**\n     * Sign and optionally broadcast a EOSIO transaction (matching eosjs transact)\n     *\n     * Example:\n     *\n     * ```ts\n     * let result = await myLink.transact(transaction, options)\n     * ```\n     *\n     * @param transaction The transaction.\n     * @param options The eosjs options to use for the transaction.\n     * @param transport Transport override, for internal use.\n     */\n\n  }, {\n    key: \"transact\",\n    value: function () {\n      var _transact = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(transaction) {\n        var _ref,\n            _ref$broadcast,\n            broadcast,\n            _ref$sign,\n            sign,\n            blocksBehind,\n            expireSeconds,\n            transport,\n            tx,\n            _args4 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _ref = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : {}, _ref$broadcast = _ref.broadcast, broadcast = _ref$broadcast === void 0 ? true : _ref$broadcast, _ref$sign = _ref.sign, sign = _ref$sign === void 0 ? true : _ref$sign, blocksBehind = _ref.blocksBehind, expireSeconds = _ref.expireSeconds;\n                transport = _args4.length > 2 ? _args4[2] : undefined;\n                // Assemble data for internal transact method\n                tx = {\n                  broadcast: broadcast,\n                  blocksBehind: blocksBehind,\n                  expireSeconds: expireSeconds\n                }; // Translate the eosjs data into the most optimized ESR payload possible\n\n                if (Object.keys(transaction).length === 1) {\n                  // With one key being passed (actions) and one action, use an action\n                  if (transaction.actions.length === 1) {\n                    tx.action = transaction.actions[0];\n                  } else {\n                    // With one key being passed (actions) and more than one action, use an action[]\n                    tx.actions = transaction.actions;\n                  }\n                } else {\n                  // With more than just actions defined, pass the whole transaction\n                  tx.transaction = transaction;\n                } // Call internal transact method\n\n\n                return _context4.abrupt(\"return\", this.linkTransact(tx, transport));\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function transact(_x5) {\n        return _transact.apply(this, arguments);\n      }\n\n      return transact;\n    }()\n    /**\n     * Sign and optionally broadcast a EOSIO transaction, action or actions.\n     *\n     * Example:\n     *\n     * ```ts\n     * let result = await myLink.linkTransact({transaction: myTx})\n     * ```\n     *\n     * @param args The transact arguments.\n     * @param transport Transport override, for internal use.\n     */\n\n  }, {\n    key: \"linkTransact\",\n    value: function () {\n      var _linkTransact = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(args, transport) {\n        var t, broadcast, request, result;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                t = transport || this.transport;\n                broadcast = args.broadcast || false;\n                _context5.next = 4;\n                return this.createRequest(args);\n\n              case 4:\n                request = _context5.sent;\n                _context5.next = 7;\n                return this.sendRequest(request, t, broadcast);\n\n              case 7:\n                result = _context5.sent;\n                return _context5.abrupt(\"return\", result);\n\n              case 9:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function linkTransact(_x6, _x7) {\n        return _linkTransact.apply(this, arguments);\n      }\n\n      return linkTransact;\n    }()\n    /**\n     * Send an identity request and verify the identity proof.\n     * @param requestPermission Optional request permission if the request is for a specific account or permission.\n     * @param info Metadata to add to the request.\n     * @note This is for advanced use-cases, you probably want to use [[Link.login]] instead.\n     */\n\n  }, {\n    key: \"identify\",\n    value: function () {\n      var _identify = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(requestPermission, info) {\n        var request, res, message, signer, signerKey, account, permission, auth, keyAuth;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return this.createRequest({\n                  identity: {\n                    permission: requestPermission || null\n                  },\n                  info: info\n                });\n\n              case 2:\n                request = _context6.sent;\n                _context6.next = 5;\n                return this.sendRequest(request);\n\n              case 5:\n                res = _context6.sent;\n\n                if (res.request.isIdentity()) {\n                  _context6.next = 8;\n                  break;\n                }\n\n                throw new IdentityError(\"Unexpected response\");\n\n              case 8:\n                message = Buffer.concat([Buffer.from(request.getChainId(), 'hex'), Buffer.from(res.serializedTransaction), Buffer.alloc(32)]);\n                signer = res.signer;\n                signerKey = ecc.recover(res.signatures[0], message);\n                _context6.next = 13;\n                return this.rpc.get_account(signer.actor);\n\n              case 13:\n                account = _context6.sent;\n\n                if (account) {\n                  _context6.next = 16;\n                  break;\n                }\n\n                throw new IdentityError(\"Signature from unknown account: \".concat(signer.actor));\n\n              case 16:\n                permission = account.permissions.find(function (_ref2) {\n                  var perm_name = _ref2.perm_name;\n                  return perm_name === signer.permission;\n                });\n\n                if (permission) {\n                  _context6.next = 19;\n                  break;\n                }\n\n                throw new IdentityError(\"\".concat(signer.actor, \" signed for unknown permission: \").concat(signer.permission));\n\n              case 19:\n                auth = permission.required_auth;\n                keyAuth = auth.keys.find(function (_ref3) {\n                  var key = _ref3.key;\n                  return publicKeyEqual(key, signerKey);\n                });\n\n                if (keyAuth) {\n                  _context6.next = 23;\n                  break;\n                }\n\n                throw new IdentityError(\"\".concat(formatAuth(signer), \" has no key matching id signature\"));\n\n              case 23:\n                if (!(auth.threshold > keyAuth.weight)) {\n                  _context6.next = 25;\n                  break;\n                }\n\n                throw new IdentityError(\"\".concat(formatAuth(signer), \" signature does not reach auth threshold\"));\n\n              case 25:\n                if (!requestPermission) {\n                  _context6.next = 28;\n                  break;\n                }\n\n                if (!(requestPermission.actor !== esr.PlaceholderName && requestPermission.actor !== signer.actor || requestPermission.permission !== esr.PlaceholderPermission && requestPermission.permission !== signer.permission)) {\n                  _context6.next = 28;\n                  break;\n                }\n\n                throw new IdentityError(\"Unexpected identity proof from \".concat(formatAuth(signer), \", expected \").concat(formatAuth(requestPermission), \" \"));\n\n              case 28:\n                return _context6.abrupt(\"return\", _objectSpread({}, res, {\n                  account: account,\n                  signerKey: signerKey\n                }));\n\n              case 29:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function identify(_x8, _x9) {\n        return _identify.apply(this, arguments);\n      }\n\n      return identify;\n    }()\n    /**\n     * Login and create a persistent session.\n     * @param identifier The session identifier, an EOSIO name (`[a-z1-5]{1,12}`).\n     *                   Should be set to the contract account if applicable.\n     */\n\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(identifier) {\n        var privateKey, requestKey, createInfo, res, metadata, session;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return generatePrivateKey();\n\n              case 2:\n                privateKey = _context7.sent;\n                requestKey = ecc.privateToPublic(privateKey);\n                createInfo = {\n                  session_name: identifier,\n                  request_key: requestKey\n                };\n                _context7.next = 7;\n                return this.identify(undefined, {\n                  link: abiEncode(createInfo, 'link_create')\n                });\n\n              case 7:\n                res = _context7.sent;\n                metadata = {\n                  sameDevice: res.request.getRawInfo()['return_path'] !== undefined\n                };\n\n                if (res.payload.link_ch && res.payload.link_key && res.payload.link_name) {\n                  session = new LinkChannelSession(this, {\n                    identifier: identifier,\n                    auth: res.signer,\n                    publicKey: res.signerKey,\n                    channel: {\n                      url: res.payload.link_ch,\n                      key: res.payload.link_key,\n                      name: res.payload.link_name\n                    },\n                    requestKey: privateKey\n                  }, metadata);\n                } else {\n                  session = new LinkFallbackSession(this, {\n                    identifier: identifier,\n                    auth: res.signer,\n                    publicKey: res.signerKey\n                  }, metadata);\n                }\n\n                if (!this.storage) {\n                  _context7.next = 13;\n                  break;\n                }\n\n                _context7.next = 13;\n                return this.storeSession(identifier, session);\n\n              case 13:\n                return _context7.abrupt(\"return\", _objectSpread({}, res, {\n                  session: session\n                }));\n\n              case 14:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function login(_x10) {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n    /**\n     * Restore previous session, see [[Link.login]] to create a new session.\n     * @param identifier The session identifier, should be same as what was used when creating the session with [[Link.login]].\n     * @param auth A specific session auth to restore, if omitted the most recently used session will be restored.\n     * @returns A [[LinkSession]] instance or null if no session can be found.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error retrieving the session data.\n     **/\n\n  }, {\n    key: \"restoreSession\",\n    value: function () {\n      var _restoreSession = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(identifier, auth) {\n        var key, latest, data, sessionData, session;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                if (this.storage) {\n                  _context8.next = 2;\n                  break;\n                }\n\n                throw new Error('Unable to restore session: No storage adapter configured');\n\n              case 2:\n                if (!auth) {\n                  _context8.next = 6;\n                  break;\n                }\n\n                key = this.sessionKey(identifier, formatAuth(auth));\n                _context8.next = 12;\n                break;\n\n              case 6:\n                _context8.next = 8;\n                return this.listSessions(identifier);\n\n              case 8:\n                latest = _context8.sent[0];\n\n                if (latest) {\n                  _context8.next = 11;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\", null);\n\n              case 11:\n                key = this.sessionKey(identifier, formatAuth(latest));\n\n              case 12:\n                _context8.next = 14;\n                return this.storage.read(key);\n\n              case 14:\n                data = _context8.sent;\n\n                if (data) {\n                  _context8.next = 17;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\", null);\n\n              case 17:\n                _context8.prev = 17;\n                sessionData = JSON.parse(data);\n                _context8.next = 24;\n                break;\n\n              case 21:\n                _context8.prev = 21;\n                _context8.t0 = _context8[\"catch\"](17);\n                throw new Error(\"Unable to restore session: Stored JSON invalid (\".concat(_context8.t0.message || String(_context8.t0), \")\"));\n\n              case 24:\n                session = LinkSession.restore(this, sessionData);\n\n                if (!auth) {\n                  _context8.next = 28;\n                  break;\n                }\n\n                _context8.next = 28;\n                return this.touchSession(identifier, auth);\n\n              case 28:\n                return _context8.abrupt(\"return\", session);\n\n              case 29:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[17, 21]]);\n      }));\n\n      function restoreSession(_x11, _x12) {\n        return _restoreSession.apply(this, arguments);\n      }\n\n      return restoreSession;\n    }()\n    /**\n     * List stored session auths for given identifier.\n     * The most recently used session is at the top (index 0).\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error retrieving the session list.\n     **/\n\n  }, {\n    key: \"listSessions\",\n    value: function () {\n      var _listSessions = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee9(identifier) {\n        var key, list;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                if (this.storage) {\n                  _context9.next = 2;\n                  break;\n                }\n\n                throw new Error('Unable to list sessions: No storage adapter configured');\n\n              case 2:\n                key = this.sessionKey(identifier, 'list');\n                _context9.prev = 3;\n                _context9.t0 = JSON;\n                _context9.next = 7;\n                return this.storage.read(key);\n\n              case 7:\n                _context9.t1 = _context9.sent;\n\n                if (_context9.t1) {\n                  _context9.next = 10;\n                  break;\n                }\n\n                _context9.t1 = '[]';\n\n              case 10:\n                _context9.t2 = _context9.t1;\n                list = _context9.t0.parse.call(_context9.t0, _context9.t2);\n                _context9.next = 17;\n                break;\n\n              case 14:\n                _context9.prev = 14;\n                _context9.t3 = _context9[\"catch\"](3);\n                throw new Error(\"Unable to list sessions: Stored JSON invalid (\".concat(_context9.t3.message || String(_context9.t3), \")\"));\n\n              case 17:\n                return _context9.abrupt(\"return\", list);\n\n              case 18:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this, [[3, 14]]);\n      }));\n\n      function listSessions(_x13) {\n        return _listSessions.apply(this, arguments);\n      }\n\n      return listSessions;\n    }()\n    /**\n     * Remove stored session for given identifier and auth.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error removing the session data.\n     */\n\n  }, {\n    key: \"removeSession\",\n    value: function () {\n      var _removeSession = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee10(identifier, auth) {\n        var key;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                if (this.storage) {\n                  _context10.next = 2;\n                  break;\n                }\n\n                throw new Error('Unable to remove session: No storage adapter configured');\n\n              case 2:\n                key = this.sessionKey(identifier, formatAuth(auth));\n                _context10.next = 5;\n                return this.storage.remove(key);\n\n              case 5:\n                _context10.next = 7;\n                return this.touchSession(identifier, auth, true);\n\n              case 7:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function removeSession(_x14, _x15) {\n        return _removeSession.apply(this, arguments);\n      }\n\n      return removeSession;\n    }()\n    /**\n     * Remove all stored sessions for given identifier.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error removing the session data.\n     */\n\n  }, {\n    key: \"clearSessions\",\n    value: function () {\n      var _clearSessions = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee11(identifier) {\n        var _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, auth;\n\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                if (this.storage) {\n                  _context11.next = 2;\n                  break;\n                }\n\n                throw new Error('Unable to clear sessions: No storage adapter configured');\n\n              case 2:\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context11.prev = 5;\n                _context11.next = 8;\n                return this.listSessions(identifier);\n\n              case 8:\n                _context11.t0 = Symbol.iterator;\n                _iterator = _context11.sent[_context11.t0]();\n\n              case 10:\n                if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                  _context11.next = 17;\n                  break;\n                }\n\n                auth = _step.value;\n                _context11.next = 14;\n                return this.removeSession(identifier, auth);\n\n              case 14:\n                _iteratorNormalCompletion = true;\n                _context11.next = 10;\n                break;\n\n              case 17:\n                _context11.next = 23;\n                break;\n\n              case 19:\n                _context11.prev = 19;\n                _context11.t1 = _context11[\"catch\"](5);\n                _didIteratorError = true;\n                _iteratorError = _context11.t1;\n\n              case 23:\n                _context11.prev = 23;\n                _context11.prev = 24;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 26:\n                _context11.prev = 26;\n\n                if (!_didIteratorError) {\n                  _context11.next = 29;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 29:\n                return _context11.finish(26);\n\n              case 30:\n                return _context11.finish(23);\n\n              case 31:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this, [[5, 19, 23, 31], [24,, 26, 30]]);\n      }));\n\n      function clearSessions(_x16) {\n        return _clearSessions.apply(this, arguments);\n      }\n\n      return clearSessions;\n    }()\n    /**\n     * Create an eosjs compatible signature provider using this link.\n     * @param availableKeys Keys the created provider will claim to be able to sign for.\n     * @param transport (internal) Transport override for this call.\n     * @note We don't know what keys are available so those have to be provided,\n     *       to avoid this use [[LinkSession.makeSignatureProvider]] instead. Sessions can be created with [[Link.login]].\n     */\n\n  }, {\n    key: \"makeSignatureProvider\",\n    value: function makeSignatureProvider(availableKeys, transport) {\n      var _this = this;\n\n      return {\n        getAvailableKeys: function () {\n          var _getAvailableKeys = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee12() {\n            return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n              while (1) {\n                switch (_context12.prev = _context12.next) {\n                  case 0:\n                    return _context12.abrupt(\"return\", availableKeys);\n\n                  case 1:\n                  case \"end\":\n                    return _context12.stop();\n                }\n              }\n            }, _callee12);\n          }));\n\n          function getAvailableKeys() {\n            return _getAvailableKeys.apply(this, arguments);\n          }\n\n          return getAvailableKeys;\n        }(),\n        sign: function () {\n          var _sign = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee13(args) {\n            var request, _ref4, signatures;\n\n            return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n              while (1) {\n                switch (_context13.prev = _context13.next) {\n                  case 0:\n                    request = esr.SigningRequest.fromTransaction(args.chainId, args.serializedTransaction, _this.requestOptions);\n                    request.setCallback(_this.createCallbackUrl(), true);\n                    request.setBroadcast(false);\n                    _context13.next = 5;\n                    return _this.sendRequest(request, transport);\n\n                  case 5:\n                    _ref4 = _context13.sent;\n                    signatures = _ref4.signatures;\n                    return _context13.abrupt(\"return\", _objectSpread({}, args, {\n                      signatures: signatures\n                    }));\n\n                  case 8:\n                  case \"end\":\n                    return _context13.stop();\n                }\n              }\n            }, _callee13);\n          }));\n\n          function sign(_x17) {\n            return _sign.apply(this, arguments);\n          }\n\n          return sign;\n        }()\n      };\n    }\n    /**\n     * Create an eosjs authority provider using this link.\n     * @note Uses the configured RPC Node's `/v1/chain/get_required_keys` API to resolve keys.\n     */\n\n  }, {\n    key: \"makeAuthorityProvider\",\n    value: function makeAuthorityProvider() {\n      var rpc = this.rpc;\n      return {\n        getRequiredKeys: function getRequiredKeys(args) {\n          return _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee14() {\n            var availableKeys, transaction, result;\n            return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n              while (1) {\n                switch (_context14.prev = _context14.next) {\n                  case 0:\n                    availableKeys = args.availableKeys, transaction = args.transaction;\n                    _context14.next = 3;\n                    return rpc.fetch('/v1/chain/get_required_keys', {\n                      transaction: transaction,\n                      available_keys: availableKeys.map(normalizePublicKey)\n                    });\n\n                  case 3:\n                    result = _context14.sent;\n                    return _context14.abrupt(\"return\", result.required_keys.map(normalizePublicKey));\n\n                  case 5:\n                  case \"end\":\n                    return _context14.stop();\n                }\n              }\n            }, _callee14);\n          }))();\n        }\n      };\n    }\n    /** Makes sure session is in storage list of sessions and moves it to top (most recently used). */\n\n  }, {\n    key: \"touchSession\",\n    value: function () {\n      var _touchSession = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee15(identifier, auth) {\n        var remove,\n            auths,\n            formattedAuth,\n            existing,\n            key,\n            _args15 = arguments;\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                remove = _args15.length > 2 && _args15[2] !== undefined ? _args15[2] : false;\n                _context15.next = 3;\n                return this.listSessions(identifier);\n\n              case 3:\n                auths = _context15.sent;\n                formattedAuth = formatAuth(auth);\n                existing = auths.findIndex(function (a) {\n                  return formatAuth(a) === formattedAuth;\n                });\n\n                if (existing >= 0) {\n                  auths.splice(existing, 1);\n                }\n\n                if (remove === false) {\n                  auths.unshift(auth);\n                }\n\n                key = this.sessionKey(identifier, 'list');\n                _context15.next = 11;\n                return this.storage.write(key, JSON.stringify(auths));\n\n              case 11:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      function touchSession(_x18, _x19) {\n        return _touchSession.apply(this, arguments);\n      }\n\n      return touchSession;\n    }()\n    /** Makes sure session is in storage list of sessions and moves it to top (most recently used). */\n\n  }, {\n    key: \"storeSession\",\n    value: function () {\n      var _storeSession = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee16(identifier, session) {\n        var key, data;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                key = this.sessionKey(identifier, formatAuth(session.auth));\n                data = JSON.stringify(session.serialize());\n                _context16.next = 4;\n                return this.storage.write(key, data);\n\n              case 4:\n                _context16.next = 6;\n                return this.touchSession(identifier, session.auth);\n\n              case 6:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function storeSession(_x20, _x21) {\n        return _storeSession.apply(this, arguments);\n      }\n\n      return storeSession;\n    }()\n    /** Session storage key for identifier and suffix. */\n\n  }, {\n    key: \"sessionKey\",\n    value: function sessionKey(identifier, suffix) {\n      return [this.chainId, identifier, suffix].join('-');\n    }\n  }]);\n\n  return Link;\n}();\n/**\n * Connect to a WebSocket channel and wait for a message.\n * @internal\n */\n\nfunction waitForCallback(url, ctx) {\n  return new Promise(function (resolve, reject) {\n    var active = true;\n    var retries = 0;\n    var socketUrl = url.replace(/^http/, 'ws');\n\n    var handleResponse = function handleResponse(response) {\n      try {\n        resolve(JSON.parse(response));\n      } catch (error) {\n        error.message = 'Unable to parse callback JSON: ' + error.message;\n        reject(error);\n      }\n    };\n\n    var connect = function connect() {\n      var socket = new WebSocket(socketUrl);\n\n      ctx.cancel = function () {\n        active = false;\n\n        if (socket.readyState === WebSocket.OPEN || socket.readyState === WebSocket.CONNECTING) {\n          socket.close();\n        }\n      };\n\n      socket.onmessage = function (event) {\n        active = false;\n\n        if (socket.readyState === WebSocket.OPEN) {\n          socket.close();\n        }\n\n        if (typeof Blob !== 'undefined' && event.data instanceof Blob) {\n          var reader = new FileReader();\n\n          reader.onload = function () {\n            handleResponse(reader.result);\n          };\n\n          reader.onerror = function (error) {\n            reject(error);\n          };\n\n          reader.readAsText(event.data);\n        } else {\n          if (typeof event.data === 'string') {\n            handleResponse(event.data);\n          } else {\n            handleResponse(event.data.toString());\n          }\n        }\n      };\n\n      socket.onopen = function () {\n        retries = 0;\n      };\n\n      socket.onerror = function (error) {};\n\n      socket.onclose = function (close) {\n        if (active) {\n          setTimeout(connect, backoff(retries++));\n        }\n      };\n    };\n\n    connect();\n  });\n}\n/**\n * Exponential backoff function that caps off at 10s after 10 tries.\n * https://i.imgur.com/IrUDcJp.png\n * @internal\n */\n\n\nfunction backoff(tries) {\n  return Math.min(Math.pow(tries * 10, 2), 10 * 1000);\n}\n/**\n * Format a EOSIO permission level in the format `actor@permission` taking placeholders into consideration.\n * @internal\n */\n\n\nfunction formatAuth(auth) {\n  var actor = auth.actor,\n      permission = auth.permission;\n\n  if (actor === esr.PlaceholderName) {\n    actor = '<any>';\n  }\n\n  if (permission === esr.PlaceholderName || permission === esr.PlaceholderPermission) {\n    permission = '<any>';\n  }\n\n  return \"\".concat(actor, \"@\").concat(permission);\n}","/** @internal */\nexport var defaults = {\n  chainId: 'aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906',\n  rpc: 'https://eos.greymass.com',\n  service: 'https://cb.anchor.link'\n};"],"sourceRoot":""}