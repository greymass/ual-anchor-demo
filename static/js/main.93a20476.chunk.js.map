{"version":3,"sources":["../../../eosjs-ecc/lib/index.js","../../../eosjs-ecc/lib/aes.js","../../../eosjs-ecc/lib/signature.js","../../../eosjs-ecc/lib/enforce_types.js","../../anchor-link/lib/link-session.js","../../anchor-link/lib/utils.js","../../anchor-link/lib/index.js","../../anchor-link/lib/link.js","../../../eosjs-ecc/lib/api_common.js","../../../eosjs-ecc/lib/hash.js","../../../eosjs-ecc/lib/promise-async.js","../../../eosjs-ecc/lib/ecdsa.js","../../../eosjs-ecc/lib/ecsignature.js","../../../eosjs-ecc/lib/api_object.js","../../anchor-link/ws-browser.js","../../anchor-link/lib/link-options.js","../../anchor-link/lib/link-abi-data.js","../../../eosjs-ecc/lib/key_public.js","../../../eosjs-ecc/lib/key_utils.js","App.js","serviceWorker.js","index.js","../../../eosjs-ecc/lib/key_private.js","../../anchor-link/lib/errors.js"],"names":["commonApi","objectApi","ecc","Object","assign","module","exports","randomBytes","ByteBuffer","crypto","assert","PublicKey","PrivateKey","hash","Long","crypt","private_key","public_key","nonce","message","checksum","TypeError","toLongObj","Buffer","isBuffer","S","getSharedSecret","ebuf","DEFAULT_CAPACITY","LITTLE_ENDIAN","writeUint64","append","toString","copy","offset","toBinary","encryption_key","sha512","iv","slice","key","check","sha256","cbuf","fromBinary","readUint32","Error","toBinaryBuffer","decipher","createDecipheriv","concat","update","cryptoJsDecrypt","cipher","createCipheriv","cryptoJsEncrypt","uniqueNonce","unique_nonce_entropy","b","Uint8Array","parseInt","_long","fromNumber","Date","now","entropy","shiftLeft","or","encrypt","arguments","length","undefined","decrypt","o","isLong","fromString","_interopRequireDefault","_slicedToArray2","_typeof2","ecdsa","curve","getCurveByName","BigInteger","keyUtils","Signature","r","s","i","verify","data","pubkey","encoding","from","verifyHash","dataSha256","publicKey","Q","recover","console","log","recoverHash","e","fromBuffer","i2","recoverPubKey","fromPoint","toBuffer","buf","writeUInt8","signatureCache","equal","verifyHex","hex","toHex","checkEncode","verifyBuffer","apply","recoverPublicKey","recoverPublicKeyFromBuffer","sign","privateKey","signHash","der","ecsignature","lenR","lenS","d","toDER","calcPubKeyRecoveryParam","toPublic","readUInt8","fromHex","signature","fromStringOrThrow","match","_match","keyType","keyString","checkDecode","getName","fn","type","value","Array","isArray","constructor","__extends","this","_extendStatics","setPrototypeOf","__proto__","p","hasOwnProperty","__","prototype","create","__assign","t","n","call","defineProperty","errors_1","utils_1","LinkSession","restore","link","LinkChannelSession","metadata","LinkFallbackSession","_super","_this","timeout","auth","channel","request","sealMessage","encode","requestKey","name","serialize","onSuccess","result","transport","onFailure","error","onRequest","cancel","info","expiration","toISOString","onSessionRequest","setTimeout","SessionError","push","abiEncode","rpc","fetchBuiltin","url","method","headers","toFixed","body","then","response","status","catch","String","makeSignatureProvider","transact","args","__importStar","mod","__esModule","k","__importDefault","eosjs_1","link_abi_data_1","types","Serialize","getTypesFromAbi","createInitialTypes","default","typeName","get","SerialBuffer","asUint8Array","abiDecode","hexToUint8Array","array","deserialize","res","Aes","privateToPublic","ciphertext","__export","m","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","__generator","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","pop","esr","fetch_ponyfill_1","zlib","uuid_1","ws_1","link_options_1","link_session_1","fetch","Link","options","abiCache","Map","JsonRpc","defaults","chainId","serviceAddress","service","trim","replace","requestOptions","abiProvider","textDecoder","TextDecoder","textEncoder","TextEncoder","getAbi","account","rv","_a","get_abi","abi","set","createCallbackUrl","v4","createRequest","SigningRequest","broadcast","callback","background","sendRequest","linkUrl","ctx_1","socket","payload_1","signer","signatures","resolved","serializedTransaction","transaction","error_1","startsWith","flags","ctx","active","retries","socketUrl","handleResponse","JSON","parse","connect","readyState","OPEN","CONNECTING","close","onmessage","event","Blob","reader_1","FileReader","onload","onerror","readAsText","onopen","onclose","tries","Math","min","pow","reason","CancelError","race","actor","sa","permission","sp","keys","filter","map","ResolvedSigningRequest","fromPayload","payload","push_transaction","processed","identify","requestPermission","signerKey","keyAuth","identity","isIdentity","IdentityError","getChainId","alloc","get_account","permissions","find","perm_name","required_auth","formatAuth","threshold","weight","PlaceholderName","PlaceholderPermission","login","sessionName","createInfo","session","randomKey","session_name","request_key","sameDevice","getRawInfo","link_ch","link_key","link_name","availableKeys","getAvailableKeys","fromTransaction","setCallback","setBroadcast","initialize","unsafeRandomKey","cpuEntropyBits","seedPrivate","seed","fromSeed","wif","pubkey_prefix","isValidPublic","isValid","isValidPrivate","resultEncoding","createHash","createHmac","sha1","digest","HmacSHA256","buffer","secret","ripemd160","func","_len","_key","err","enforceType","ECSignature","deterministicGenerateK","checkSig","x","fill","T","signum","compareTo","verifyRaw","G","c","modInverse","u1","multiply","u2","R","multiplyTwo","isInfinity","affineX","equals","strictEqual","isYOdd","add","pointFromX","nR","eNeg","negate","rInv","validate","N_OVER_TWO","shiftRight","subtract","rBa","toDERInteger","sBa","sequence","unshift","toCompact","compressed","toScriptSignature","hashType","hashTypeBuffer","parseCompact","fromDER","rLen","sLen","rB","sB","fromDERInteger","parseScriptSignature","hashTypeMod","key_utils","window","WebSocket","MozWebSocket","version","structs","base","fields","actions","ricardian_clauses","error_messages","tables","abi_extensions","ecurve","secp256k1","getEncoded","toUncompressed","point","Point","decodeFrom","child","cG","Qprime","bin","prefix_match","RegExp","test","substring","fromStringHex","base58","random32ByteBuffer","_ref","_ref$cpuEntropyBits","_ref$safe","safe","_entropyCount","hash_array","cpuEntropy","externalEntropyArray","browserEntropy","addEntropy","ints","_i","_ints","pos","entropyPos","entropyCount","newCheck","decode","keyBuffer","_checksum","collected","lastCount","lowEntropySamples","count","floatingPointCount","delta","abs","bits","floor","log2","pct","Number","warn","sin","sqrt","LN2","entropyStr","join","screen","height","width","colorDepth","availHeight","availWidth","pixelDepth","navigator","language","location","history","mimeType","mimeTypes","description","suffixes","start_t","chains","rpcEndpoints","protocol","host","port","getTransaction","to","quantity","getTransactionAmount","memo","payee_public_key","amount","max_fee","tpid","authorization","symbol","TestApp","Component","props","super","purchase","a","activeUser","ual","accountName","chain","demoTransaction","signTransaction","expireSeconds","blocksBehind","setState","resetMessage","renderLoggedInView","state","style","styles","announcementBar","baseText","onClick","button","blueBG","td","logout","renderLoginButton","showModal","buttonText","render","UALWrapper","setChain","target","search","URLSearchParams","available","anchor","Anchor","appName","ledger","Ledger","scatter","Scatter","container","defaultValue","onChange","select","authenticators","TestAppConsumer","display","backgroundColor","alignItems","justifyContent","marginTop","flexDirection","padding","textAlign","borderRadius","color","fontSize","fontWeight","marginBottom","top","position","withUAL","App","Boolean","hostname","ReactDOM","document","getElementById","serviceWorker","ready","registration","unregister","_toConsumableArray2","promiseAsync","isBigInteger","toWif","KB","KBP","fromAffine","size","getChildKey","parseKey","privateStr","versionKey","format","isWif","text","fromWif","str","initialized","pvt","pvtError","pub","doesNotThrow","unitTest","cb","msg","code"],"mappings":"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","file":"static/js/main.93a20476.chunk.js","sourcesContent":["\"use strict\";\n\nvar commonApi = require('./api_common');\n\nvar objectApi = require('./api_object');\n\nvar ecc = Object.assign({}, commonApi, objectApi);\nmodule.exports = ecc;","\"use strict\";\n\nvar randomBytes = require('randombytes');\n\nvar ByteBuffer = require('bytebuffer');\n\nvar crypto = require('browserify-aes');\n\nvar assert = require('assert');\n\nvar PublicKey = require('./key_public');\n\nvar PrivateKey = require('./key_private');\n\nvar hash = require('./hash');\n\nvar Long = ByteBuffer.Long;\nmodule.exports = {\n  encrypt: encrypt,\n  decrypt: decrypt\n};\n/**\n    Spec: http://localhost:3002/steem/@dantheman/how-to-encrypt-a-memo-when-transferring-steem\n\n    @throws {Error|TypeError} - \"Invalid Key, ...\"\n\n    @arg {PrivateKey} private_key - required and used for decryption\n    @arg {PublicKey} public_key - required and used to calcualte the shared secret\n    @arg {string} [nonce = uniqueNonce()] - assigned a random unique uint64\n\n    @return {object}\n    @property {string} nonce - random or unique uint64, provides entropy when re-using the same private/public keys.\n    @property {Buffer} message - Plain text message\n    @property {number} checksum - shared secret checksum\n*/\n\nfunction encrypt(private_key, public_key, message) {\n  var nonce = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : uniqueNonce();\n  return crypt(private_key, public_key, nonce, message);\n}\n/**\n    Spec: http://localhost:3002/steem/@dantheman/how-to-encrypt-a-memo-when-transferring-steem\n\n    @arg {PrivateKey} private_key - required and used for decryption\n    @arg {PublicKey} public_key - required and used to calcualte the shared secret\n    @arg {string} nonce - random or unique uint64, provides entropy when re-using the same private/public keys.\n    @arg {Buffer} message - Encrypted or plain text message\n    @arg {number} checksum - shared secret checksum\n\n    @throws {Error|TypeError} - \"Invalid Key, ...\"\n\n    @return {Buffer} - message\n*/\n\n\nfunction decrypt(private_key, public_key, nonce, message, checksum) {\n  return crypt(private_key, public_key, nonce, message, checksum).message;\n}\n/**\n    @arg {Buffer} message - Encrypted or plain text message (see checksum)\n    @arg {number} checksum - shared secret checksum (null to encrypt, non-null to decrypt)\n    @private\n*/\n\n\nfunction crypt(private_key, public_key, nonce, message, checksum) {\n  private_key = PrivateKey(private_key);\n  if (!private_key) throw new TypeError('private_key is required');\n  public_key = PublicKey(public_key);\n  if (!public_key) throw new TypeError('public_key is required');\n  nonce = toLongObj(nonce);\n  if (!nonce) throw new TypeError('nonce is required');\n\n  if (!Buffer.isBuffer(message)) {\n    if (typeof message !== 'string') throw new TypeError('message should be buffer or string');\n    message = new Buffer(message, 'binary');\n  }\n\n  if (checksum && typeof checksum !== 'number') throw new TypeError('checksum should be a number');\n  var S = private_key.getSharedSecret(public_key);\n  var ebuf = new ByteBuffer(ByteBuffer.DEFAULT_CAPACITY, ByteBuffer.LITTLE_ENDIAN);\n  ebuf.writeUint64(nonce);\n  ebuf.append(S.toString('binary'), 'binary');\n  ebuf = new Buffer(ebuf.copy(0, ebuf.offset).toBinary(), 'binary');\n  var encryption_key = hash.sha512(ebuf); // D E B U G\n  // console.log('crypt', {\n  //     priv_to_pub: private_key.toPublic().toString(),\n  //     pub: public_key.toString(),\n  //     nonce: nonce.toString(),\n  //     message: message.length,\n  //     checksum,\n  //     S: S.toString('hex'),\n  //     encryption_key: encryption_key.toString('hex'),\n  // })\n\n  var iv = encryption_key.slice(32, 48);\n  var key = encryption_key.slice(0, 32); // check is first 64 bit of sha256 hash treated as uint64_t truncated to 32 bits.\n\n  var check = hash.sha256(encryption_key);\n  check = check.slice(0, 4);\n  var cbuf = ByteBuffer.fromBinary(check.toString('binary'), ByteBuffer.DEFAULT_CAPACITY, ByteBuffer.LITTLE_ENDIAN);\n  check = cbuf.readUint32();\n\n  if (checksum) {\n    if (check !== checksum) throw new Error('Invalid key');\n    message = cryptoJsDecrypt(message, key, iv);\n  } else {\n    message = cryptoJsEncrypt(message, key, iv);\n  }\n\n  return {\n    nonce: nonce,\n    message: message,\n    checksum: check\n  };\n}\n/** This method does not use a checksum, the returned data must be validated some other way.\n\n    @arg {string|Buffer} message - ciphertext binary format\n    @arg {string<utf8>|Buffer} key - 256bit\n    @arg {string<utf8>|Buffer} iv - 128bit\n\n    @return {Buffer}\n*/\n\n\nfunction cryptoJsDecrypt(message, key, iv) {\n  assert(message, \"Missing cipher text\");\n  message = toBinaryBuffer(message);\n  var decipher = crypto.createDecipheriv('aes-256-cbc', key, iv); // decipher.setAutoPadding(true)\n\n  message = Buffer.concat([decipher.update(message), decipher[\"final\"]()]);\n  return message;\n}\n/** This method does not use a checksum, the returned data must be validated some other way.\n    @arg {string|Buffer} message - plaintext binary format\n    @arg {string<utf8>|Buffer} key - 256bit\n    @arg {string<utf8>|Buffer} iv - 128bit\n\n    @return {Buffer}\n*/\n\n\nfunction cryptoJsEncrypt(message, key, iv) {\n  assert(message, \"Missing plain text\");\n  message = toBinaryBuffer(message);\n  var cipher = crypto.createCipheriv('aes-256-cbc', key, iv); // cipher.setAutoPadding(true)\n\n  message = Buffer.concat([cipher.update(message), cipher[\"final\"]()]);\n  return message;\n}\n/** @return {string} unique 64 bit unsigned number string.  Being time based, this is careful to never choose the same nonce twice.  This value could be recorded in the blockchain for a long time.\n*/\n\n\nfunction uniqueNonce() {\n  if (unique_nonce_entropy === null) {\n    var b = new Uint8Array(randomBytes(2));\n    unique_nonce_entropy = parseInt(b[0] << 8 | b[1], 10);\n  }\n\n  var _long = Long.fromNumber(Date.now());\n\n  var entropy = ++unique_nonce_entropy % 0xFFFF; // console.log('uniqueNonce date\\t', ByteBuffer.allocate(8).writeUint64(long).toHex(0))\n  // console.log('uniqueNonce entropy\\t', ByteBuffer.allocate(8).writeUint64(Long.fromNumber(entropy)).toHex(0))\n\n  _long = _long.shiftLeft(16).or(Long.fromNumber(entropy)); // console.log('uniqueNonce final\\t', ByteBuffer.allocate(8).writeUint64(long).toHex(0))\n\n  return _long.toString();\n}\n\nvar unique_nonce_entropy = null; // for(let i=1; i < 10; i++) key.uniqueNonce()\n\nvar toLongObj = function toLongObj(o) {\n  return o ? Long.isLong(o) ? o : Long.fromString(o) : o;\n};\n\nvar toBinaryBuffer = function toBinaryBuffer(o) {\n  return o ? Buffer.isBuffer(o) ? o : new Buffer(o, 'binary') : o;\n};","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar ecdsa = require('./ecdsa');\n\nvar hash = require('./hash');\n\nvar curve = require('ecurve').getCurveByName('secp256k1');\n\nvar assert = require('assert');\n\nvar BigInteger = require('bigi');\n\nvar keyUtils = require('./key_utils');\n\nvar PublicKey = require('./key_public');\n\nvar PrivateKey = require('./key_private');\n\nmodule.exports = Signature;\n\nfunction Signature(r, s, i) {\n  assert.equal(r != null, true, 'Missing parameter');\n  assert.equal(s != null, true, 'Missing parameter');\n  assert.equal(i != null, true, 'Missing parameter');\n  /**\n      Verify signed data.\n       @arg {String|Buffer} data - full data\n      @arg {pubkey|PublicKey} pubkey - EOSKey..\n      @arg {String} [encoding = 'utf8'] - data encoding (if data is a string)\n       @return {boolean}\n  */\n\n  function verify(data, pubkey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n    if (typeof data === 'string') {\n      data = Buffer.from(data, encoding);\n    }\n\n    assert(Buffer.isBuffer(data), 'data is a required String or Buffer');\n    data = hash.sha256(data);\n    return verifyHash(data, pubkey);\n  }\n  /**\n      Verify a buffer of exactally 32 bytes in size (sha256(text))\n       @arg {String|Buffer} dataSha256 - 32 byte buffer or string\n      @arg {String|PublicKey} pubkey - EOSKey..\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n       @return {boolean}\n  */\n\n\n  function verifyHash(dataSha256, pubkey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n\n    if (typeof dataSha256 === 'string') {\n      dataSha256 = Buffer.from(dataSha256, encoding);\n    }\n\n    if (dataSha256.length !== 32 || !Buffer.isBuffer(dataSha256)) throw new Error(\"dataSha256: 32 bytes required\");\n    var publicKey = PublicKey(pubkey);\n    assert(publicKey, 'pubkey required');\n    return ecdsa.verify(curve, dataSha256, {\n      r: r,\n      s: s\n    }, publicKey.Q);\n  }\n\n  ;\n  /** @deprecated\n       Verify hex data by converting to a buffer then hashing.\n       @return {boolean}\n  */\n\n  function verifyHex(hex, pubkey) {\n    console.log('Deprecated: use verify(data, pubkey, \"hex\")');\n    var buf = Buffer.from(hex, 'hex');\n    return verify(buf, pubkey);\n  }\n\n  ;\n  /**\n      Recover the public key used to create this signature using full data.\n       @arg {String|Buffer} data - full data\n      @arg {String} [encoding = 'utf8'] - data encoding (if string)\n       @return {PublicKey}\n  */\n\n  function recover(data) {\n    var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'utf8';\n\n    if (typeof data === 'string') {\n      data = Buffer.from(data, encoding);\n    }\n\n    console.log(data);\n    assert(Buffer.isBuffer(data), 'data is a required String or Buffer');\n    data = hash.sha256(data);\n    return recoverHash(data);\n  }\n\n  ;\n  /**\n      @arg {String|Buffer} dataSha256 - sha256 hash 32 byte buffer or hex string\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n       @return {PublicKey}\n  */\n\n  function recoverHash(dataSha256) {\n    var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'hex';\n\n    if (typeof dataSha256 === 'string') {\n      dataSha256 = Buffer.from(dataSha256, encoding);\n    }\n\n    if (dataSha256.length !== 32 || !Buffer.isBuffer(dataSha256)) {\n      throw new Error(\"dataSha256: 32 byte String or buffer requred\");\n    }\n\n    var e = BigInteger.fromBuffer(dataSha256);\n    var i2 = i;\n    i2 -= 27;\n    i2 = i2 & 3;\n    var Q = ecdsa.recoverPubKey(curve, e, {\n      r: r,\n      s: s,\n      i: i\n    }, i2);\n    return PublicKey.fromPoint(Q);\n  }\n\n  ;\n\n  function toBuffer() {\n    var buf;\n    buf = new Buffer(65);\n    buf.writeUInt8(i, 0);\n    r.toBuffer(32).copy(buf, 1);\n    s.toBuffer(32).copy(buf, 33);\n    return buf;\n  }\n\n  ;\n\n  function toHex() {\n    return toBuffer().toString(\"hex\");\n  }\n\n  ;\n  var signatureCache;\n\n  function toString() {\n    if (signatureCache) {\n      return signatureCache;\n    }\n\n    signatureCache = 'SIG_K1_' + keyUtils.checkEncode(toBuffer(), 'K1');\n    return signatureCache;\n  }\n\n  return {\n    r: r,\n    s: s,\n    i: i,\n    toBuffer: toBuffer,\n    verify: verify,\n    verifyHash: verifyHash,\n    verifyHex: verifyHex,\n    // deprecated\n    recover: recover,\n    recoverHash: recoverHash,\n    toHex: toHex,\n    toString: toString,\n\n    /** @deprecated use verify (same arguments and return) */\n    verifyBuffer: function verifyBuffer() {\n      console.log('Deprecated: use signature.verify instead (same arguments)');\n      return verify.apply(void 0, arguments);\n    },\n\n    /** @deprecated use recover (same arguments and return) */\n    recoverPublicKey: function recoverPublicKey() {\n      console.log('Deprecated: use signature.recover instead (same arguments)');\n      return recover.apply(void 0, arguments);\n    },\n\n    /** @deprecated use recoverHash (same arguments and return) */\n    recoverPublicKeyFromBuffer: function recoverPublicKeyFromBuffer() {\n      console.log('Deprecated: use signature.recoverHash instead (same arguments)');\n      return recoverHash.apply(void 0, arguments);\n    }\n  };\n}\n/**\n    Hash and sign arbitrary data.\n\n    @arg {string|Buffer} data - full data\n    @arg {wif|PrivateKey} privateKey\n    @arg {String} [encoding = 'utf8'] - data encoding (if string)\n\n    @return {Signature}\n*/\n\n\nSignature.sign = function (data, privateKey) {\n  var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n  if (typeof data === 'string') {\n    data = Buffer.from(data, encoding);\n  }\n\n  assert(Buffer.isBuffer(data), 'data is a required String or Buffer');\n  data = hash.sha256(data);\n  return Signature.signHash(data, privateKey);\n};\n/**\n    Sign a buffer of exactally 32 bytes in size (sha256(text))\n\n    @arg {string|Buffer} dataSha256 - 32 byte buffer or string\n    @arg {wif|PrivateKey} privateKey\n    @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n\n    @return {Signature}\n*/\n\n\nSignature.signHash = function (dataSha256, privateKey) {\n  var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n\n  if (typeof dataSha256 === 'string') {\n    dataSha256 = Buffer.from(dataSha256, encoding);\n  }\n\n  if (dataSha256.length !== 32 || !Buffer.isBuffer(dataSha256)) throw new Error(\"dataSha256: 32 byte buffer requred\");\n  privateKey = PrivateKey(privateKey);\n  assert(privateKey, 'privateKey required');\n  var der, e, ecsignature, i, lenR, lenS, nonce;\n  i = null;\n  nonce = 0;\n  e = BigInteger.fromBuffer(dataSha256);\n\n  while (true) {\n    ecsignature = ecdsa.sign(curve, dataSha256, privateKey.d, nonce++);\n    der = ecsignature.toDER();\n    lenR = der[3];\n    lenS = der[5 + lenR];\n\n    if (lenR === 32 && lenS === 32) {\n      i = ecdsa.calcPubKeyRecoveryParam(curve, e, ecsignature, privateKey.toPublic().Q);\n      i += 4; // compressed\n\n      i += 27; // compact  //  24 or 27 :( forcing odd-y 2nd key candidate)\n\n      break;\n    }\n\n    if (nonce % 10 === 0) {\n      console.log(\"WARN: \" + nonce + \" attempts to find canonical signature\");\n    }\n  }\n\n  return Signature(ecsignature.r, ecsignature.s, i);\n};\n\nSignature.fromBuffer = function (buf) {\n  var i, r, s;\n  assert(Buffer.isBuffer(buf), 'Buffer is required');\n  assert.equal(buf.length, 65, 'Invalid signature length');\n  i = buf.readUInt8(0);\n  assert.equal(i - 27, i - 27 & 7, 'Invalid signature parameter');\n  r = BigInteger.fromBuffer(buf.slice(1, 33));\n  s = BigInteger.fromBuffer(buf.slice(33));\n  return Signature(r, s, i);\n};\n\nSignature.fromHex = function (hex) {\n  return Signature.fromBuffer(Buffer.from(hex, \"hex\"));\n};\n/**\n    @arg {string} signature - like SIG_K1_base58signature..\n    @return {Signature} or `null` (invalid)\n*/\n\n\nSignature.fromString = function (signature) {\n  try {\n    return Signature.fromStringOrThrow(signature);\n  } catch (e) {\n    return null;\n  }\n};\n/**\n    @arg {string} signature - like SIG_K1_base58signature..\n    @throws {Error} invalid\n    @return {Signature}\n*/\n\n\nSignature.fromStringOrThrow = function (signature) {\n  assert.equal((0, _typeof2[\"default\"])(signature), 'string', 'signature');\n  var match = signature.match(/^SIG_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);\n  assert(match != null && match.length === 3, 'Expecting signature like: SIG_K1_base58signature..');\n\n  var _match = (0, _slicedToArray2[\"default\"])(match, 3),\n      keyType = _match[1],\n      keyString = _match[2];\n\n  assert.equal(keyType, 'K1', 'K1 signature expected');\n  return Signature.fromBuffer(keyUtils.checkDecode(keyString, keyType));\n};\n/**\n    @arg {String|Signature} o - hex string\n    @return {Signature}\n*/\n\n\nSignature.from = function (o) {\n  var signature = o ? o.r && o.s && o.i ? o : typeof o === 'string' && o.length === 130 ? Signature.fromHex(o) : typeof o === 'string' && o.length !== 130 ? Signature.fromStringOrThrow(o) : Buffer.isBuffer(o) ? Signature.fromBuffer(o) : null : o;\n  /*null or undefined*/\n\n  if (!signature) {\n    throw new TypeError('signature should be a hex string or buffer');\n  }\n\n  return signature;\n};","\"use strict\";\n\nmodule.exports = function enforce(type, value) {\n  // Copied from https://github.com/bitcoinjs/bitcoinjs-lib\n  switch (type) {\n    case 'Array':\n      {\n        if (Array.isArray(value)) return;\n        break;\n      }\n\n    case 'Boolean':\n      {\n        if (typeof value === 'boolean') return;\n        break;\n      }\n\n    case 'Buffer':\n      {\n        if (Buffer.isBuffer(value)) return;\n        break;\n      }\n\n    case 'Number':\n      {\n        if (typeof value === 'number') return;\n        break;\n      }\n\n    case 'String':\n      {\n        if (typeof value === 'string') return;\n        break;\n      }\n\n    default:\n      {\n        if (getName(value.constructor) === getName(type)) return;\n      }\n  }\n\n  throw new TypeError('Expected ' + (getName(type) || type) + ', got ' + value);\n};\n\nfunction getName(fn) {\n  // Why not fn.name: https://kangax.github.io/compat-table/es6/#function_name_property\n  var match = fn.toString().match(/function (.*?)\\(/);\n  return match ? match[1] : null;\n}","\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar errors_1 = require(\"./errors\");\n\nvar utils_1 = require(\"./utils\");\n/**\n * Type describing a link session that can create a eosjs compatible\n * signature provider and transact for a specific auth.\n */\n\n\nvar LinkSession =\n/** @class */\nfunction () {\n  function LinkSession() {}\n  /** Restore a previously serialized session. */\n\n\n  LinkSession.restore = function (link, data) {\n    switch (data.type) {\n      case 'channel':\n        return new LinkChannelSession(link, data.data, data.metadata);\n\n      case 'fallback':\n        return new LinkFallbackSession(link, data.data, data.metadata);\n\n      default:\n        throw new Error('Unable to restore, session data invalid');\n    }\n  };\n\n  return LinkSession;\n}();\n\nexports.LinkSession = LinkSession;\n/**\n * Link session that pushes requests over a channel.\n */\n\nvar LinkChannelSession =\n/** @class */\nfunction (_super) {\n  __extends(LinkChannelSession, _super);\n\n  function LinkChannelSession(link, data, metadata) {\n    var _this = _super.call(this) || this;\n\n    _this.type = 'channel';\n    _this.timeout = 2 * 60 * 1000; // ms\n\n    _this.link = link;\n    _this.auth = data.auth;\n    _this.publicKey = data.publicKey;\n    _this.channel = data.channel;\n\n    _this.encrypt = function (request) {\n      return utils_1.sealMessage(request.encode(true, false), data.requestKey, data.channel.key);\n    };\n\n    _this.metadata = __assign(__assign({}, metadata || {}), {\n      timeout: _this.timeout,\n      name: _this.channel.name\n    });\n\n    _this.serialize = function () {\n      return {\n        type: 'channel',\n        data: data,\n        metadata: _this.metadata\n      };\n    };\n\n    return _this;\n  }\n\n  LinkChannelSession.prototype.onSuccess = function (request, result) {\n    if (this.link.transport.onSuccess) {\n      this.link.transport.onSuccess(request, result);\n    }\n  };\n\n  LinkChannelSession.prototype.onFailure = function (request, error) {\n    if (this.link.transport.onFailure) {\n      this.link.transport.onFailure(request, error);\n    }\n  };\n\n  LinkChannelSession.prototype.onRequest = function (request, cancel) {\n    var info = {\n      expiration: new Date(Date.now() + this.timeout).toISOString().slice(0, -1)\n    };\n\n    if (this.link.transport.onSessionRequest) {\n      this.link.transport.onSessionRequest(this, request, cancel);\n    }\n\n    setTimeout(function () {\n      cancel(new errors_1.SessionError('Wallet did not respond in time', 'E_TIMEOUT'));\n    }, this.timeout + 500);\n    request.data.info.push({\n      key: 'link',\n      value: utils_1.abiEncode(info, 'link_info')\n    });\n    this.link.rpc.fetchBuiltin(this.channel.url, {\n      method: 'POST',\n      headers: {\n        'X-Buoy-Wait': (this.timeout / 1000).toFixed(0)\n      },\n      body: this.encrypt(request)\n    }).then(function (response) {\n      if (response.status !== 200) {\n        cancel(new errors_1.SessionError('Unable to push message', 'E_DELIVERY'));\n      } else {// request delivered\n      }\n    }).catch(function (error) {\n      cancel(new errors_1.SessionError(\"Unable to reach link service (\" + (error.message || String(error)) + \")\", 'E_DELIVERY'));\n    });\n  };\n\n  LinkChannelSession.prototype.makeSignatureProvider = function () {\n    return this.link.makeSignatureProvider([this.publicKey], this);\n  };\n\n  LinkChannelSession.prototype.transact = function (args) {\n    return this.link.transact(args, this);\n  };\n\n  return LinkChannelSession;\n}(LinkSession);\n\nexports.LinkChannelSession = LinkChannelSession;\n\nvar LinkFallbackSession =\n/** @class */\nfunction (_super) {\n  __extends(LinkFallbackSession, _super);\n\n  function LinkFallbackSession(link, data, metadata) {\n    var _this = _super.call(this) || this;\n\n    _this.type = 'fallback';\n    _this.link = link;\n    _this.auth = data.auth;\n    _this.publicKey = data.publicKey;\n    _this.metadata = metadata || {};\n\n    _this.serialize = function () {\n      return {\n        type: _this.type,\n        data: data,\n        metadata: _this.metadata\n      };\n    };\n\n    return _this;\n  }\n\n  LinkFallbackSession.prototype.onSuccess = function (request, result) {\n    if (this.link.transport.onSuccess) {\n      this.link.transport.onSuccess(request, result);\n    }\n  };\n\n  LinkFallbackSession.prototype.onFailure = function (request, error) {\n    if (this.link.transport.onFailure) {\n      this.link.transport.onFailure(request, error);\n    }\n  };\n\n  LinkFallbackSession.prototype.onRequest = function (request, cancel) {\n    if (this.link.transport.onSessionRequest) {\n      this.link.transport.onSessionRequest(this, request, cancel);\n    } else {\n      this.link.transport.onRequest(request, cancel);\n    }\n  };\n\n  LinkFallbackSession.prototype.makeSignatureProvider = function () {\n    return this.link.makeSignatureProvider([this.publicKey], this);\n  };\n\n  LinkFallbackSession.prototype.transact = function (args) {\n    return this.link.transact(args, this);\n  };\n\n  return LinkFallbackSession;\n}(LinkSession);\n\nexports.LinkFallbackSession = LinkFallbackSession;","\"use strict\";\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar eosjs_1 = require(\"eosjs\");\n\nvar ecc = __importStar(require(\"eosjs-ecc\"));\n\nvar link_abi_data_1 = __importDefault(require(\"./link-abi-data\"));\n\nvar types = eosjs_1.Serialize.getTypesFromAbi(eosjs_1.Serialize.createInitialTypes(), link_abi_data_1.default);\n\nfunction abiEncode(value, typeName) {\n  var type = types.get(typeName);\n\n  if (!type) {\n    throw new Error(\"No such type: \" + typeName);\n  }\n\n  var buf = new eosjs_1.Serialize.SerialBuffer();\n  type.serialize(buf, value);\n  return buf.asUint8Array();\n}\n\nexports.abiEncode = abiEncode;\n\nfunction abiDecode(data, typeName) {\n  var type = types.get(typeName);\n\n  if (!type) {\n    throw new Error(\"No such type: \" + typeName);\n  }\n\n  if (typeof data === 'string') {\n    data = eosjs_1.Serialize.hexToUint8Array(data);\n  } else if (!(data instanceof Uint8Array)) {\n    data = new Uint8Array(data);\n  }\n\n  var buf = new eosjs_1.Serialize.SerialBuffer({\n    array: data\n  });\n  return type.deserialize(buf);\n}\n\nexports.abiDecode = abiDecode;\n\nfunction sealMessage(message, privateKey, publicKey) {\n  var res = ecc.Aes.encrypt(privateKey, publicKey, message);\n  var data = {\n    from: ecc.privateToPublic(privateKey),\n    nonce: res.nonce.toString(),\n    ciphertext: res.message,\n    checksum: res.checksum\n  };\n  return abiEncode(data, 'sealed_message');\n}\n\nexports.sealMessage = sealMessage;","\"use strict\";\n\nfunction __export(m) {\n  for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__export(require(\"./link\"));\n\n__export(require(\"./link-session\"));\n\n__export(require(\"./errors\"));","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar esr = __importStar(require(\"eosio-signing-request\"));\n\nvar eosjs_1 = require(\"eosjs\");\n\nvar ecc = __importStar(require(\"eosjs-ecc\"));\n\nvar fetch_ponyfill_1 = __importDefault(require(\"fetch-ponyfill\"));\n\nvar zlib = __importStar(require(\"pako\"));\n\nvar uuid_1 = require(\"uuid\");\n\nvar ws_1 = __importDefault(require(\"ws\"));\n\nvar errors_1 = require(\"./errors\");\n\nvar link_options_1 = require(\"./link-options\");\n\nvar link_session_1 = require(\"./link-session\");\n\nvar utils_1 = require(\"./utils\");\n\nvar fetch = fetch_ponyfill_1.default().fetch;\n\nvar Link =\n/** @class */\nfunction () {\n  function Link(options) {\n    this.abiCache = new Map();\n\n    if (options.rpc === undefined || typeof options.rpc === 'string') {\n      this.rpc = new eosjs_1.JsonRpc(options.rpc || link_options_1.defaults.rpc, {\n        fetch: fetch\n      });\n    } else {\n      this.rpc = options.rpc;\n    }\n\n    this.chainId = options.chainId || link_options_1.defaults.chainId;\n    this.serviceAddress = (options.service || link_options_1.defaults.service).trim().replace(/\\/$/, '');\n    this.transport = options.transport;\n    this.requestOptions = {\n      abiProvider: this,\n      textDecoder: options.textDecoder || new TextDecoder(),\n      textEncoder: options.textEncoder || new TextEncoder(),\n      zlib: zlib\n    };\n  }\n\n  Link.prototype.getAbi = function (account) {\n    return __awaiter(this, void 0, void 0, function () {\n      var rv;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            rv = this.abiCache.get(account);\n            if (!!rv) return [3\n            /*break*/\n            , 2];\n            return [4\n            /*yield*/\n            , this.rpc.get_abi(account)];\n\n          case 1:\n            rv = _a.sent().abi;\n\n            if (rv) {\n              this.abiCache.set(account, rv);\n            }\n\n            _a.label = 2;\n\n          case 2:\n            return [2\n            /*return*/\n            , rv];\n        }\n      });\n    });\n  };\n\n  Link.prototype.createCallbackUrl = function () {\n    return this.serviceAddress + \"/\" + uuid_1.v4();\n  };\n\n  Link.prototype.createRequest = function (args) {\n    return __awaiter(this, void 0, void 0, function () {\n      var request;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , esr.SigningRequest.create(__assign(__assign({}, args), {\n              chainId: this.chainId,\n              broadcast: false,\n              callback: {\n                url: this.createCallbackUrl(),\n                background: true\n              }\n            }), this.requestOptions)];\n\n          case 1:\n            request = _a.sent();\n            return [2\n            /*return*/\n            , request];\n        }\n      });\n    });\n  };\n\n  Link.prototype.sendRequest = function (request, transport) {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, linkUrl, ctx_1, socket, cancel, payload_1, signer, signatures, resolved, serializedTransaction, transaction, result, error_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            t = transport || this.transport;\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 4,, 5]);\n\n            linkUrl = request.data.callback;\n\n            if (!linkUrl.startsWith(this.serviceAddress)) {\n              throw new Error('Request must have a link callback');\n            }\n\n            if (request.data.flags !== 2) {\n              throw new Error('Invalid request flags');\n            }\n\n            ctx_1 = {};\n            socket = waitForCallback(linkUrl, ctx_1);\n            cancel = new Promise(function (resolve, reject) {\n              t.onRequest(request, function (reason) {\n                if (ctx_1.cancel) {\n                  ctx_1.cancel();\n                }\n\n                if (typeof reason === 'string') {\n                  reject(new errors_1.CancelError(reason));\n                } else {\n                  reject(reason);\n                }\n              });\n            });\n            return [4\n            /*yield*/\n            , Promise.race([socket, cancel])];\n\n          case 2:\n            payload_1 = _a.sent();\n            signer = {\n              actor: payload_1.sa,\n              permission: payload_1.sp\n            };\n            signatures = Object.keys(payload_1).filter(function (key) {\n              return key.startsWith('sig') && key !== 'sig0';\n            }).map(function (key) {\n              return payload_1[key];\n            });\n            return [4\n            /*yield*/\n            , esr.ResolvedSigningRequest.fromPayload(payload_1, this.requestOptions)];\n\n          case 3:\n            resolved = _a.sent();\n            serializedTransaction = resolved.serializedTransaction, transaction = resolved.transaction;\n            result = {\n              request: resolved.request,\n              serializedTransaction: serializedTransaction,\n              transaction: transaction,\n              signatures: signatures,\n              payload: payload_1,\n              signer: signer\n            };\n\n            if (t.onSuccess) {\n              t.onSuccess(request, result);\n            }\n\n            return [2\n            /*return*/\n            , result];\n\n          case 4:\n            error_1 = _a.sent();\n\n            if (t.onFailure) {\n              t.onFailure(request, error_1);\n            }\n\n            throw error_1;\n\n          case 5:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  Link.prototype.transact = function (args, transport) {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, request, result, broadcast, res;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            t = transport || this.transport;\n            return [4\n            /*yield*/\n            , this.createRequest(args)];\n\n          case 1:\n            request = _a.sent();\n            return [4\n            /*yield*/\n            , this.sendRequest(request, t) // broadcast transaction if requested\n            ];\n\n          case 2:\n            result = _a.sent();\n            broadcast = args.broadcast || false;\n            if (!broadcast) return [3\n            /*break*/\n            , 4];\n            return [4\n            /*yield*/\n            , this.rpc.push_transaction({\n              signatures: result.signatures,\n              serializedTransaction: result.serializedTransaction\n            })];\n\n          case 3:\n            res = _a.sent();\n            result.processed = res.processed;\n            _a.label = 4;\n\n          case 4:\n            return [2\n            /*return*/\n            , result];\n        }\n      });\n    });\n  };\n  /**\n   * Create a identity request.\n   * @param requestPermission Optional request permission if the request is for a specific account or permission.\n   * @param info Metadata to add to the request.\n   */\n\n\n  Link.prototype.identify = function (requestPermission, info) {\n    return __awaiter(this, void 0, void 0, function () {\n      var request, res, message, signer, signerKey, account, permission, auth, keyAuth;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.createRequest({\n              identity: {\n                permission: requestPermission || null\n              },\n              info: info\n            })];\n\n          case 1:\n            request = _a.sent();\n            return [4\n            /*yield*/\n            , this.sendRequest(request)];\n\n          case 2:\n            res = _a.sent();\n\n            if (!res.request.isIdentity()) {\n              throw new errors_1.IdentityError(\"Unexpected response\");\n            }\n\n            message = Buffer.concat([Buffer.from(request.getChainId(), 'hex'), Buffer.from(res.serializedTransaction), Buffer.alloc(32)]);\n            signer = res.signer;\n            signerKey = ecc.recover(res.signatures[0], message);\n            console.log(ecc, signerKey);\n            return [4\n            /*yield*/\n            , this.rpc.get_account(signer.actor)];\n\n          case 3:\n            account = _a.sent();\n\n            if (!account) {\n              throw new errors_1.IdentityError(\"Signature from unknown account: \" + signer.actor);\n            }\n\n            permission = account.permissions.find(function (_a) {\n              var perm_name = _a.perm_name;\n              return perm_name === signer.permission;\n            });\n\n            if (!permission) {\n              throw new errors_1.IdentityError(signer.actor + \" signed for unknown permission: \" + signer.permission);\n            }\n\n            auth = permission.required_auth;\n            keyAuth = auth.keys.find(function (_a) {\n              var key = _a.key;\n              return key.slice(3) === signerKey.slice(3);\n            });\n\n            if (!keyAuth) {\n              throw new errors_1.IdentityError(formatAuth(signer) + \" has no key matching id signature\");\n            }\n\n            if (auth.threshold > keyAuth.weight) {\n              throw new errors_1.IdentityError(formatAuth(signer) + \" signature does not reach auth threshold\");\n            }\n\n            if (requestPermission) {\n              if (requestPermission.actor !== esr.PlaceholderName && requestPermission.actor !== signer.actor || requestPermission.permission !== esr.PlaceholderPermission && requestPermission.permission !== signer.permission) {\n                throw new errors_1.IdentityError(\"Unexpected identity proof from \" + formatAuth(signer) + \", expected \" + formatAuth(requestPermission) + \" \");\n              }\n            }\n\n            return [2\n            /*return*/\n            , __assign(__assign({}, res), {\n              account: account,\n              signerKey: signerKey\n            })];\n        }\n      });\n    });\n  };\n  /**\n   * Login and create a persistent session.\n   */\n\n\n  Link.prototype.login = function (sessionName) {\n    return __awaiter(this, void 0, void 0, function () {\n      var privateKey, requestKey, createInfo, res, metadata, session;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , ecc.randomKey()];\n\n          case 1:\n            privateKey = _a.sent();\n            requestKey = ecc.privateToPublic(privateKey);\n            createInfo = {\n              session_name: sessionName,\n              request_key: requestKey\n            };\n            return [4\n            /*yield*/\n            , this.identify(undefined, {\n              link: utils_1.abiEncode(createInfo, 'link_create')\n            })];\n\n          case 2:\n            res = _a.sent();\n            metadata = {\n              sameDevice: res.request.getRawInfo()['return_path'] !== undefined\n            };\n\n            if (res.payload.link_ch && res.payload.link_key && res.payload.link_name) {\n              session = new link_session_1.LinkChannelSession(this, {\n                auth: res.signer,\n                publicKey: res.signerKey,\n                channel: {\n                  url: res.payload.link_ch,\n                  key: res.payload.link_key,\n                  name: res.payload.link_name\n                },\n                requestKey: privateKey\n              }, metadata);\n            } else {\n              session = new link_session_1.LinkFallbackSession(this, {\n                auth: res.signer,\n                publicKey: res.signerKey\n              }, metadata);\n            }\n\n            return [2\n            /*return*/\n            , __assign(__assign({}, res), {\n              session: session\n            })];\n        }\n      });\n    });\n  };\n  /**\n   * Create an eosjs signature provider using this link.\n   * Note that we don't know what keys are available so those have to be provided.\n   */\n\n\n  Link.prototype.makeSignatureProvider = function (availableKeys, transport) {\n    var _this = this;\n\n    return {\n      getAvailableKeys: function getAvailableKeys() {\n        return __awaiter(_this, void 0, void 0, function () {\n          return __generator(this, function (_a) {\n            return [2\n            /*return*/\n            , availableKeys];\n          });\n        });\n      },\n      sign: function sign(args) {\n        return __awaiter(_this, void 0, void 0, function () {\n          var request, signatures;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                request = esr.SigningRequest.fromTransaction(args.chainId, args.serializedTransaction, this.requestOptions);\n                request.setCallback(this.createCallbackUrl(), true);\n                request.setBroadcast(false);\n                return [4\n                /*yield*/\n                , this.sendRequest(request, transport)];\n\n              case 1:\n                signatures = _a.sent().signatures;\n                return [2\n                /*return*/\n                , __assign(__assign({}, args), {\n                  signatures: signatures\n                })];\n            }\n          });\n        });\n      }\n    };\n  };\n\n  return Link;\n}();\n\nexports.Link = Link;\n\nfunction waitForCallback(url, ctx) {\n  return new Promise(function (resolve, reject) {\n    var active = true;\n    var retries = 0;\n    var socketUrl = url.replace(/^http/, 'ws');\n\n    var handleResponse = function handleResponse(response) {\n      try {\n        resolve(JSON.parse(response));\n      } catch (error) {\n        error.message = 'Unable to parse callback JSON: ' + error.message;\n        reject(error);\n      }\n    };\n\n    var connect = function connect() {\n      var socket = new ws_1.default(socketUrl);\n\n      ctx.cancel = function () {\n        active = false;\n\n        if (socket.readyState === ws_1.default.OPEN || socket.readyState === ws_1.default.CONNECTING) {\n          socket.close();\n        }\n      };\n\n      socket.onmessage = function (event) {\n        active = false;\n\n        if (socket.readyState === ws_1.default.OPEN) {\n          socket.close();\n        }\n\n        if (typeof Blob !== 'undefined' && event.data instanceof Blob) {\n          var reader_1 = new FileReader();\n\n          reader_1.onload = function () {\n            handleResponse(reader_1.result);\n          };\n\n          reader_1.onerror = function (error) {\n            reject(error);\n          };\n\n          reader_1.readAsText(event.data);\n        } else {\n          if (typeof event.data === 'string') {\n            handleResponse(event.data);\n          } else {\n            handleResponse(event.data.toString());\n          }\n        }\n      };\n\n      socket.onopen = function () {\n        retries = 0;\n      };\n\n      socket.onerror = function (error) {};\n\n      socket.onclose = function (close) {\n        if (active) {\n          setTimeout(connect, backoff(retries++));\n        }\n      };\n    };\n\n    connect();\n  });\n}\n/**\n * Exponential backoff function that caps off at 10s after 10 tries.\n * https://i.imgur.com/IrUDcJp.png\n */\n\n\nfunction backoff(tries) {\n  return Math.min(Math.pow(tries * 10, 2), 10 * 1000);\n}\n/** Format a EOSIO permission level in the format `actor@permission` taking placeholders into consideration. */\n\n\nfunction formatAuth(auth) {\n  var actor = auth.actor,\n      permission = auth.permission;\n\n  if (actor === esr.PlaceholderName) {\n    actor = '<any>';\n  }\n\n  if (permission === esr.PlaceholderName || permission === esr.PlaceholderPermission) {\n    permission = '<any>';\n  }\n\n  return actor + \"@\" + permission;\n}","\"use strict\";\n\nvar Aes = require(\"./aes\");\n\nvar PrivateKey = require(\"./key_private\");\n\nvar PublicKey = require(\"./key_public\");\n\nvar Signature = require(\"./signature\");\n\nvar key_utils = require(\"./key_utils\");\n\nvar hash = require(\"./hash\");\n/**\n    [Wallet Import Format](https://en.bitcoin.it/wiki/Wallet_import_format)\n    @typedef {string} wif\n*/\n\n/**\n    EOSKey..\n    @typedef {string} pubkey\n*/\n\n/** @namespace */\n\n\nvar ecc = {\n  /**\n    Initialize by running some self-checking code.  This should take a\n    second to gather additional CPU entropy used during private key\n    generation.\n     Initialization happens once even if called multiple times.\n     @return {Promise}\n  */\n  initialize: PrivateKey.initialize,\n\n  /**\n    Does not pause to gather CPU entropy.\n    @return {Promise<PrivateKey>} test key\n  */\n  unsafeRandomKey: function unsafeRandomKey() {\n    return PrivateKey.unsafeRandomKey().then(function (key) {\n      return key.toString();\n    });\n  },\n\n  /**\n      @arg {number} [cpuEntropyBits = 0] gather additional entropy\n      from a CPU mining algorithm.  This will already happen once by\n      default.\n       @return {Promise<wif>}\n       @example\n  ecc.randomKey().then(privateKey => {\n  console.log('Private Key:\\t', privateKey) // wif\n  console.log('Public Key:\\t', ecc.privateToPublic(privateKey)) // EOSkey...\n  })\n  */\n  randomKey: function randomKey(cpuEntropyBits) {\n    return PrivateKey.randomKey(cpuEntropyBits).then(function (key) {\n      return key.toString();\n    });\n  },\n\n  /**\n       @arg {string} seed - any length string.  This is private.  The same\n      seed produces the same private key every time.  At least 128 random\n      bits should be used to produce a good private key.\n      @return {wif}\n       @example ecc.seedPrivate('secret') === wif\n  */\n  seedPrivate: function seedPrivate(seed) {\n    return PrivateKey.fromSeed(seed).toString();\n  },\n\n  /**\n      @arg {wif} wif\n      @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n       @return {pubkey}\n       @example ecc.privateToPublic(wif) === pubkey\n  */\n  privateToPublic: function privateToPublic(wif) {\n    var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n    return PrivateKey(wif).toPublic().toString(pubkey_prefix);\n  },\n\n  /**\n      @arg {pubkey} pubkey - like EOSKey..\n      @arg {string} [pubkey_prefix = 'EOS']\n       @return {boolean} valid\n       @example ecc.isValidPublic(pubkey) === true\n  */\n  isValidPublic: function isValidPublic(pubkey) {\n    var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n    return PublicKey.isValid(pubkey, pubkey_prefix);\n  },\n\n  /**\n      @arg {wif} wif\n      @return {boolean} valid\n       @example ecc.isValidPrivate(wif) === true\n  */\n  isValidPrivate: function isValidPrivate(wif) {\n    return PrivateKey.isValid(wif);\n  },\n\n  /**\n      Create a signature using data or a hash.\n       @arg {string|Buffer} data\n      @arg {wif|PrivateKey} privateKey\n      @arg {String} [encoding = 'utf8'] - data encoding (if string)\n       @return {string} string signature\n       @example ecc.sign('I am alive', wif)\n  */\n  sign: function sign(data, privateKey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n    if (encoding === true) {\n      throw new TypeError('API changed, use signHash(..) instead');\n    } else {\n      if (encoding === false) {\n        console.log('Warning: ecc.sign hashData parameter was removed');\n      }\n    }\n\n    return Signature.sign(data, privateKey, encoding).toString();\n  },\n\n  /**\n      @arg {String|Buffer} dataSha256 - sha256 hash 32 byte buffer or string\n      @arg {wif|PrivateKey} privateKey\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if string)\n       @return {string} string signature\n  */\n  signHash: function signHash(dataSha256, privateKey) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n    return Signature.signHash(dataSha256, privateKey, encoding).toString();\n  },\n\n  /**\n      Verify signed data.\n       @arg {string|Buffer} signature - buffer or hex string\n      @arg {string|Buffer} data\n      @arg {pubkey|PublicKey} pubkey\n      @arg {boolean} [hashData = true] - sha256 hash data before verify\n      @return {boolean}\n       @example ecc.verify(signature, 'I am alive', pubkey) === true\n  */\n  verify: function verify(signature, data, pubkey) {\n    var encoding = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'utf8';\n\n    if (encoding === true) {\n      throw new TypeError('API changed, use verifyHash(..) instead');\n    } else {\n      if (encoding === false) {\n        console.log('Warning: ecc.verify hashData parameter was removed');\n      }\n    }\n\n    signature = Signature.from(signature);\n    return signature.verify(data, pubkey, encoding);\n  },\n  verifyHash: function verifyHash(signature, dataSha256, pubkey) {\n    var encoding = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'hex';\n    signature = Signature.from(signature);\n    return signature.verifyHash(dataSha256, pubkey, encoding);\n  },\n\n  /**\n      Recover the public key used to create the signature.\n       @arg {String|Buffer} signature (EOSbase58sig.., Hex, Buffer)\n      @arg {String|Buffer} data - full data\n      @arg {String} [encoding = 'utf8'] - data encoding (if data is a string)\n       @return {pubkey}\n       @example ecc.recover(signature, 'I am alive') === pubkey\n  */\n  recover: function recover(signature, data) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'utf8';\n\n    if (encoding === true) {\n      throw new TypeError('API changed, use recoverHash(signature, data) instead');\n    } else {\n      if (encoding === false) {\n        console.log('Warning: ecc.recover hashData parameter was removed');\n      }\n    }\n\n    signature = Signature.from(signature);\n    return signature.recover(data, encoding).toString();\n  },\n\n  /**\n      @arg {String|Buffer} signature (EOSbase58sig.., Hex, Buffer)\n      @arg {String|Buffer} dataSha256 - sha256 hash 32 byte buffer or hex string\n      @arg {String} [encoding = 'hex'] - dataSha256 encoding (if dataSha256 is a string)\n       @return {PublicKey}\n  */\n  recoverHash: function recoverHash(signature, dataSha256) {\n    var encoding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'hex';\n    signature = Signature.from(signature);\n    return signature.recoverHash(dataSha256, encoding).toString();\n  },\n\n  /** @arg {string|Buffer} data - always binary, you may need Buffer.from(data, 'hex')\n      @arg {string} [encoding = 'hex'] - result encoding 'hex', 'binary' or 'base64'\n      @return {string|Buffer} - Buffer when encoding is null, or string\n       @example ecc.sha256('hashme') === '02208b..'\n      @example ecc.sha256(Buffer.from('02208b', 'hex')) === '29a23..'\n  */\n  sha256: function sha256(data) {\n    var resultEncoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'hex';\n    return hash.sha256(data, resultEncoding);\n  }\n};\nmodule.exports = ecc;","\"use strict\";\n\nvar createHash = require('create-hash');\n\nvar createHmac = require('create-hmac');\n/** @namespace hash */\n\n/** @arg {string|Buffer} data\n    @arg {string} [resultEncoding = null] - 'hex', 'binary' or 'base64'\n    @return {string|Buffer} - Buffer when resultEncoding is null, or string\n*/\n\n\nfunction sha1(data, resultEncoding) {\n  return createHash('sha1').update(data).digest(resultEncoding);\n}\n/** @arg {string|Buffer} data\n    @arg {string} [resultEncoding = null] - 'hex', 'binary' or 'base64'\n    @return {string|Buffer} - Buffer when resultEncoding is null, or string\n*/\n\n\nfunction sha256(data, resultEncoding) {\n  return createHash('sha256').update(data).digest(resultEncoding);\n}\n/** @arg {string|Buffer} data\n    @arg {string} [resultEncoding = null] - 'hex', 'binary' or 'base64'\n    @return {string|Buffer} - Buffer when resultEncoding is null, or string\n*/\n\n\nfunction sha512(data, resultEncoding) {\n  return createHash('sha512').update(data).digest(resultEncoding);\n}\n\nfunction HmacSHA256(buffer, secret) {\n  return createHmac('sha256', secret).update(buffer).digest();\n}\n\nfunction ripemd160(data) {\n  try {\n    return createHash('rmd160').update(data).digest();\n  } catch (e) {\n    return createHash('ripemd160').update(data).digest();\n  }\n} // function hash160(buffer) {\n//   return ripemd160(sha256(buffer))\n// }\n//\n// function hash256(buffer) {\n//   return sha256(sha256(buffer))\n// }\n//\n// function HmacSHA512(buffer, secret) {\n//   return crypto.createHmac('sha512', secret).update(buffer).digest()\n// }\n\n\nmodule.exports = {\n  sha1: sha1,\n  sha256: sha256,\n  sha512: sha512,\n  HmacSHA256: HmacSHA256,\n  ripemd160: ripemd160 // hash160: hash160,\n  // hash256: hash256,\n  // HmacSHA512: HmacSHA512\n\n};","\"use strict\";\n/**\n  Convert a synchronous function into a asynchronous one (via setTimeout)\n  wrapping it in a promise.  This does not expect the function to have a\n  callback paramter.\n\n  @arg {function} func - non-callback function\n\n  @example promiseAsync(myfunction)\n*/\n\nmodule.exports = function (func) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return new Promise(function (resolve, reject) {\n      setTimeout(function () {\n        try {\n          resolve(func.apply(void 0, args));\n        } catch (err) {\n          reject(err);\n        }\n      });\n    });\n  };\n};","\"use strict\";\n\nvar assert = require('assert'); // from github.com/bitcoinjs/bitcoinjs-lib from github.com/cryptocoinjs/ecdsa\n\n\nvar crypto = require('./hash');\n\nvar enforceType = require('./enforce_types');\n\nvar BigInteger = require('bigi');\n\nvar ECSignature = require('./ecsignature'); // https://tools.ietf.org/html/rfc6979#section-3.2\n\n\nfunction deterministicGenerateK(curve, hash, d, checkSig, nonce) {\n  enforceType('Buffer', hash);\n  enforceType(BigInteger, d);\n\n  if (nonce) {\n    hash = crypto.sha256(Buffer.concat([hash, new Buffer(nonce)]));\n  } // sanity check\n\n\n  assert.equal(hash.length, 32, 'Hash must be 256 bit');\n  var x = d.toBuffer(32);\n  var k = new Buffer(32);\n  var v = new Buffer(32); // Step B\n\n  v.fill(1); // Step C\n\n  k.fill(0); // Step D\n\n  k = crypto.HmacSHA256(Buffer.concat([v, new Buffer([0]), x, hash]), k); // Step E\n\n  v = crypto.HmacSHA256(v, k); // Step F\n\n  k = crypto.HmacSHA256(Buffer.concat([v, new Buffer([1]), x, hash]), k); // Step G\n\n  v = crypto.HmacSHA256(v, k); // Step H1/H2a, ignored as tlen === qlen (256 bit)\n  // Step H2b\n\n  v = crypto.HmacSHA256(v, k);\n  var T = BigInteger.fromBuffer(v); // Step H3, repeat until T is within the interval [1, n - 1]\n\n  while (T.signum() <= 0 || T.compareTo(curve.n) >= 0 || !checkSig(T)) {\n    k = crypto.HmacSHA256(Buffer.concat([v, new Buffer([0])]), k);\n    v = crypto.HmacSHA256(v, k); // Step H1/H2a, again, ignored as tlen === qlen (256 bit)\n    // Step H2b again\n\n    v = crypto.HmacSHA256(v, k);\n    T = BigInteger.fromBuffer(v);\n  }\n\n  return T;\n}\n\nfunction sign(curve, hash, d, nonce) {\n  var e = BigInteger.fromBuffer(hash);\n  var n = curve.n;\n  var G = curve.G;\n  var r, s;\n  var k = deterministicGenerateK(curve, hash, d, function (k) {\n    // find canonically valid signature\n    var Q = G.multiply(k);\n    if (curve.isInfinity(Q)) return false;\n    r = Q.affineX.mod(n);\n    if (r.signum() === 0) return false;\n    s = k.modInverse(n).multiply(e.add(d.multiply(r))).mod(n);\n    if (s.signum() === 0) return false;\n    return true;\n  }, nonce);\n  var N_OVER_TWO = n.shiftRight(1); // enforce low S values, see bip62: 'low s values in signatures'\n\n  if (s.compareTo(N_OVER_TWO) > 0) {\n    s = n.subtract(s);\n  }\n\n  return ECSignature(r, s);\n}\n\nfunction verifyRaw(curve, e, signature, Q) {\n  var n = curve.n;\n  var G = curve.G;\n  var r = signature.r;\n  var s = signature.s; // 1.4.1 Enforce r and s are both integers in the interval [1, n − 1]\n\n  if (r.signum() <= 0 || r.compareTo(n) >= 0) return false;\n  if (s.signum() <= 0 || s.compareTo(n) >= 0) return false; // c = s^-1 mod n\n\n  var c = s.modInverse(n); // 1.4.4 Compute u1 = es^−1 mod n\n  //               u2 = rs^−1 mod n\n\n  var u1 = e.multiply(c).mod(n);\n  var u2 = r.multiply(c).mod(n); // 1.4.5 Compute R = (xR, yR) = u1G + u2Q\n\n  var R = G.multiplyTwo(u1, Q, u2); // 1.4.5 (cont.) Enforce R is not at infinity\n\n  if (curve.isInfinity(R)) return false; // 1.4.6 Convert the field element R.x to an integer\n\n  var xR = R.affineX; // 1.4.7 Set v = xR mod n\n\n  var v = xR.mod(n); // 1.4.8 If v = r, output \"valid\", and if v != r, output \"invalid\"\n\n  return v.equals(r);\n}\n\nfunction verify(curve, hash, signature, Q) {\n  // 1.4.2 H = Hash(M), already done by the user\n  // 1.4.3 e = H\n  var e = BigInteger.fromBuffer(hash);\n  return verifyRaw(curve, e, signature, Q);\n}\n/**\n  * Recover a public key from a signature.\n  *\n  * See SEC 1: Elliptic Curve Cryptography, section 4.1.6, \"Public\n  * Key Recovery Operation\".\n  *\n  * http://www.secg.org/download/aid-780/sec1-v2.pdf\n  */\n\n\nfunction recoverPubKey(curve, e, signature, i) {\n  assert.strictEqual(i & 3, i, 'Recovery param is more than two bits');\n  var n = curve.n;\n  var G = curve.G;\n  var r = signature.r;\n  var s = signature.s;\n  assert(r.signum() > 0 && r.compareTo(n) < 0, 'Invalid r value');\n  assert(s.signum() > 0 && s.compareTo(n) < 0, 'Invalid s value'); // A set LSB signifies that the y-coordinate is odd\n\n  var isYOdd = i & 1; // The more significant bit specifies whether we should use the\n  // first or second candidate key.\n\n  var isSecondKey = i >> 1; // 1.1 Let x = r + jn\n\n  var x = isSecondKey ? r.add(n) : r;\n  var R = curve.pointFromX(isYOdd, x); // 1.4 Check that nR is at infinity\n\n  var nR = R.multiply(n);\n  assert(curve.isInfinity(nR), 'nR is not a valid curve point'); // Compute -e from e\n\n  var eNeg = e.negate().mod(n); // 1.6.1 Compute Q = r^-1 (sR -  eG)\n  //               Q = r^-1 (sR + -eG)\n\n  var rInv = r.modInverse(n);\n  var Q = R.multiplyTwo(s, G, eNeg).multiply(rInv);\n  curve.validate(Q);\n  return Q;\n}\n/**\n  * Calculate pubkey extraction parameter.\n  *\n  * When extracting a pubkey from a signature, we have to\n  * distinguish four different cases. Rather than putting this\n  * burden on the verifier, Bitcoin includes a 2-bit value with the\n  * signature.\n  *\n  * This function simply tries all four cases and returns the value\n  * that resulted in a successful pubkey recovery.\n  */\n\n\nfunction calcPubKeyRecoveryParam(curve, e, signature, Q) {\n  for (var i = 0; i < 4; i++) {\n    var Qprime = recoverPubKey(curve, e, signature, i); // 1.6.2 Verify Q\n\n    if (Qprime.equals(Q)) {\n      return i;\n    }\n  }\n\n  throw new Error('Unable to find valid recovery factor');\n}\n\nmodule.exports = {\n  calcPubKeyRecoveryParam: calcPubKeyRecoveryParam,\n  deterministicGenerateK: deterministicGenerateK,\n  recoverPubKey: recoverPubKey,\n  sign: sign,\n  verify: verify,\n  verifyRaw: verifyRaw\n};","\"use strict\";\n\nvar assert = require('assert'); // from https://github.com/bitcoinjs/bitcoinjs-lib\n\n\nvar enforceType = require('./enforce_types');\n\nvar BigInteger = require('bigi');\n\nfunction ECSignature(r, s) {\n  enforceType(BigInteger, r);\n  enforceType(BigInteger, s);\n\n  function toCompact(i, compressed) {\n    if (compressed) i += 4;\n    i += 27;\n    var buffer = new Buffer(65);\n    buffer.writeUInt8(i, 0);\n    r.toBuffer(32).copy(buffer, 1);\n    s.toBuffer(32).copy(buffer, 33);\n    return buffer;\n  }\n\n  function toDER() {\n    var rBa = r.toDERInteger();\n    var sBa = s.toDERInteger();\n    var sequence = []; // INTEGER\n\n    sequence.push(0x02, rBa.length);\n    sequence = sequence.concat(rBa); // INTEGER\n\n    sequence.push(0x02, sBa.length);\n    sequence = sequence.concat(sBa); // SEQUENCE\n\n    sequence.unshift(0x30, sequence.length);\n    return new Buffer(sequence);\n  }\n\n  function toScriptSignature(hashType) {\n    var hashTypeBuffer = new Buffer(1);\n    hashTypeBuffer.writeUInt8(hashType, 0);\n    return Buffer.concat([toDER(), hashTypeBuffer]);\n  }\n\n  return {\n    r: r,\n    s: s,\n    toCompact: toCompact,\n    toDER: toDER,\n    toScriptSignature: toScriptSignature\n  };\n} // Import operations\n\n\nECSignature.parseCompact = function (buffer) {\n  assert.equal(buffer.length, 65, 'Invalid signature length');\n  var i = buffer.readUInt8(0) - 27; // At most 3 bits\n\n  assert.equal(i, i & 7, 'Invalid signature parameter');\n  var compressed = !!(i & 4); // Recovery param only\n\n  i = i & 3;\n  var r = BigInteger.fromBuffer(buffer.slice(1, 33));\n  var s = BigInteger.fromBuffer(buffer.slice(33));\n  return {\n    compressed: compressed,\n    i: i,\n    signature: ECSignature(r, s)\n  };\n};\n\nECSignature.fromDER = function (buffer) {\n  assert.equal(buffer.readUInt8(0), 0x30, 'Not a DER sequence');\n  assert.equal(buffer.readUInt8(1), buffer.length - 2, 'Invalid sequence length');\n  assert.equal(buffer.readUInt8(2), 0x02, 'Expected a DER integer');\n  var rLen = buffer.readUInt8(3);\n  assert(rLen > 0, 'R length is zero');\n  var offset = 4 + rLen;\n  assert.equal(buffer.readUInt8(offset), 0x02, 'Expected a DER integer (2)');\n  var sLen = buffer.readUInt8(offset + 1);\n  assert(sLen > 0, 'S length is zero');\n  var rB = buffer.slice(4, offset);\n  var sB = buffer.slice(offset + 2);\n  offset += 2 + sLen;\n\n  if (rLen > 1 && rB.readUInt8(0) === 0x00) {\n    assert(rB.readUInt8(1) & 0x80, 'R value excessively padded');\n  }\n\n  if (sLen > 1 && sB.readUInt8(0) === 0x00) {\n    assert(sB.readUInt8(1) & 0x80, 'S value excessively padded');\n  }\n\n  assert.equal(offset, buffer.length, 'Invalid DER encoding');\n  var r = BigInteger.fromDERInteger(rB);\n  var s = BigInteger.fromDERInteger(sB);\n  assert(r.signum() >= 0, 'R value is negative');\n  assert(s.signum() >= 0, 'S value is negative');\n  return ECSignature(r, s);\n}; // FIXME: 0x00, 0x04, 0x80 are SIGHASH_* boundary constants, importing Transaction causes a circular dependency\n\n\nECSignature.parseScriptSignature = function (buffer) {\n  var hashType = buffer.readUInt8(buffer.length - 1);\n  var hashTypeMod = hashType & ~0x80;\n  assert(hashTypeMod > 0x00 && hashTypeMod < 0x04, 'Invalid hashType');\n  return {\n    signature: ECSignature.fromDER(buffer.slice(0, -1)),\n    hashType: hashType\n  };\n};\n\nmodule.exports = ECSignature;","\"use strict\";\n\nvar Aes = require(\"./aes\");\n\nvar PrivateKey = require(\"./key_private\");\n\nvar PublicKey = require(\"./key_public\");\n\nvar Signature = require(\"./signature\");\n\nvar key_utils = require(\"./key_utils\");\n\nmodule.exports = {\n  Aes: Aes,\n  PrivateKey: PrivateKey,\n  PublicKey: PublicKey,\n  Signature: Signature,\n  key_utils: key_utils\n};","module.exports = window.WebSocket || window.MozWebSocket;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.defaults = {\n  chainId: 'aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906',\n  rpc: 'https://eos.greymass.com',\n  service: 'https://cb.anchor.link'\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = {\n  version: 'eosio::abi/1.1',\n  types: [],\n  structs: [{\n    name: 'sealed_message',\n    base: '',\n    fields: [{\n      name: 'from',\n      type: 'public_key'\n    }, {\n      name: 'nonce',\n      type: 'uint64'\n    }, {\n      name: 'ciphertext',\n      type: 'bytes'\n    }, {\n      name: 'checksum',\n      type: 'uint32'\n    }]\n  }, {\n    name: 'link_create',\n    base: '',\n    fields: [{\n      name: 'session_name',\n      type: 'name'\n    }, {\n      name: 'request_key',\n      type: 'public_key'\n    }]\n  }, {\n    name: 'link_info',\n    base: '',\n    fields: [{\n      name: 'expiration',\n      type: 'time_point_sec'\n    }]\n  }],\n  actions: [],\n  ricardian_clauses: [],\n  error_messages: [],\n  tables: [],\n  abi_extensions: []\n};","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar assert = require('assert');\n\nvar ecurve = require('ecurve');\n\nvar BigInteger = require('bigi');\n\nvar secp256k1 = ecurve.getCurveByName('secp256k1');\n\nvar hash = require('./hash');\n\nvar keyUtils = require('./key_utils');\n\nvar G = secp256k1.G;\nvar n = secp256k1.n;\nmodule.exports = PublicKey;\n/**\n  @param {string|Buffer|PublicKey|ecurve.Point} public key\n  @param {string} [pubkey_prefix = 'EOS']\n*/\n\nfunction PublicKey(Q) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n\n  if (typeof Q === 'string') {\n    var publicKey = PublicKey.fromString(Q, pubkey_prefix);\n    assert(publicKey != null, 'Invalid public key');\n    return publicKey;\n  } else if (Buffer.isBuffer(Q)) {\n    return PublicKey.fromBuffer(Q);\n  } else if ((0, _typeof2[\"default\"])(Q) === 'object' && Q.Q) {\n    return PublicKey(Q.Q);\n  }\n\n  assert.equal((0, _typeof2[\"default\"])(Q), 'object', 'Invalid public key');\n  assert.equal((0, _typeof2[\"default\"])(Q.compressed), 'boolean', 'Invalid public key');\n\n  function toBuffer() {\n    var compressed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Q.compressed;\n    return Q.getEncoded(compressed);\n  }\n\n  var pubdata; // cache\n  // /**\n  //     @todo secp224r1\n  //     @return {string} PUB_K1_base58pubkey..\n  // */\n  // function toString() {\n  //     if(pubdata) {\n  //         return pubdata\n  //     }\n  //     pubdata = `PUB_K1_` + keyUtils.checkEncode(toBuffer(), 'K1')\n  //     return pubdata;\n  // }\n\n  /** @todo rename to toStringLegacy\n   * @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n  */\n\n  function toString() {\n    var pubkey_prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'EOS';\n    return pubkey_prefix + keyUtils.checkEncode(toBuffer());\n  }\n\n  function toUncompressed() {\n    var buf = Q.getEncoded(false);\n    var point = ecurve.Point.decodeFrom(secp256k1, buf);\n    return PublicKey.fromPoint(point);\n  }\n  /** @deprecated */\n\n\n  function child(offset) {\n    console.error('Deprecated warning: PublicKey.child');\n    assert(Buffer.isBuffer(offset), \"Buffer required: offset\");\n    assert.equal(offset.length, 32, \"offset length\");\n    offset = Buffer.concat([toBuffer(), offset]);\n    offset = hash.sha256(offset);\n    var c = BigInteger.fromBuffer(offset);\n    if (c.compareTo(n) >= 0) throw new Error(\"Child offset went out of bounds, try again\");\n    var cG = G.multiply(c);\n    var Qprime = Q.add(cG);\n    if (secp256k1.isInfinity(Qprime)) throw new Error(\"Child offset derived to an invalid key, try again\");\n    return PublicKey.fromPoint(Qprime);\n  }\n\n  function toHex() {\n    return toBuffer().toString('hex');\n  }\n\n  return {\n    Q: Q,\n    toString: toString,\n    // toStringLegacy,\n    toUncompressed: toUncompressed,\n    toBuffer: toBuffer,\n    child: child,\n    toHex: toHex\n  };\n}\n/**\n  @param {string|Buffer|PublicKey|ecurve.Point} pubkey - public key\n  @param {string} [pubkey_prefix = 'EOS']\n*/\n\n\nPublicKey.isValid = function (pubkey) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n\n  try {\n    PublicKey(pubkey, pubkey_prefix);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n\nPublicKey.fromBinary = function (bin) {\n  return PublicKey.fromBuffer(new Buffer(bin, 'binary'));\n};\n\nPublicKey.fromBuffer = function (buffer) {\n  return PublicKey(ecurve.Point.decodeFrom(secp256k1, buffer));\n};\n\nPublicKey.fromPoint = function (point) {\n  return PublicKey(point);\n};\n/**\n    @arg {string} public_key - like PUB_K1_base58pubkey..\n    @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n    @return PublicKey or `null` (invalid)\n*/\n\n\nPublicKey.fromString = function (public_key) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n\n  try {\n    return PublicKey.fromStringOrThrow(public_key, pubkey_prefix);\n  } catch (e) {\n    return null;\n  }\n};\n/**\n    @arg {string} public_key - like PUB_K1_base58pubkey..\n    @arg {string} [pubkey_prefix = 'EOS'] - public key prefix\n\n    @throws {Error} if public key is invalid\n\n    @return PublicKey\n*/\n\n\nPublicKey.fromStringOrThrow = function (public_key) {\n  var pubkey_prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'EOS';\n  assert.equal((0, _typeof2[\"default\"])(public_key), 'string', 'public_key');\n  var match = public_key.match(/^PUB_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);\n\n  if (match === null) {\n    // legacy\n    var prefix_match = new RegExp(\"^\" + pubkey_prefix);\n\n    if (prefix_match.test(public_key)) {\n      public_key = public_key.substring(pubkey_prefix.length);\n    }\n\n    return PublicKey.fromBuffer(keyUtils.checkDecode(public_key));\n  }\n\n  assert(match.length === 3, 'Expecting public key like: PUB_K1_base58pubkey..');\n\n  var _match = (0, _slicedToArray2[\"default\"])(match, 3),\n      keyType = _match[1],\n      keyString = _match[2];\n\n  assert.equal(keyType, 'K1', 'K1 private key expected');\n  return PublicKey.fromBuffer(keyUtils.checkDecode(keyString, keyType));\n};\n\nPublicKey.fromHex = function (hex) {\n  return PublicKey.fromBuffer(new Buffer(hex, 'hex'));\n};\n\nPublicKey.fromStringHex = function (hex) {\n  return PublicKey.fromString(new Buffer(hex, 'hex'));\n};","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar base58 = require('bs58');\n\nvar assert = require('assert');\n\nvar randomBytes = require('randombytes');\n\nvar hash = require('./hash');\n\nmodule.exports = {\n  random32ByteBuffer: random32ByteBuffer,\n  addEntropy: addEntropy,\n  cpuEntropy: cpuEntropy,\n  entropyCount: function entropyCount() {\n    return _entropyCount;\n  },\n  checkDecode: checkDecode,\n  checkEncode: checkEncode\n};\nvar entropyPos = 0,\n    _entropyCount = 0;\nvar externalEntropyArray = randomBytes(101);\n/**\n    Additional forms of entropy are used.  A week random number generator can run out of entropy.  This should ensure even the worst random number implementation will be reasonably safe.\n\n    @arg {number} [cpuEntropyBits = 0] generate entropy on the fly.  This is\n    not required, entropy can be added in advanced via addEntropy or initialize().\n\n    @arg {boolean} [safe = true] false for testing, otherwise this will be\n    true to ensure initialize() was called.\n\n    @return a random buffer obtained from the secure random number generator.  Additional entropy is used.\n*/\n\nfunction random32ByteBuffer() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$cpuEntropyBits = _ref.cpuEntropyBits,\n      cpuEntropyBits = _ref$cpuEntropyBits === void 0 ? 0 : _ref$cpuEntropyBits,\n      _ref$safe = _ref.safe,\n      safe = _ref$safe === void 0 ? true : _ref$safe;\n\n  assert.equal((0, _typeof2[\"default\"])(cpuEntropyBits), 'number', 'cpuEntropyBits');\n  assert.equal((0, _typeof2[\"default\"])(safe), 'boolean', 'boolean');\n\n  if (safe) {\n    assert(_entropyCount >= 128, 'Call initialize() to add entropy');\n  } // if(entropyCount > 0) {\n  //     console.log(`Additional private key entropy: ${entropyCount} events`)\n  // }\n\n\n  var hash_array = [];\n  hash_array.push(randomBytes(32));\n  hash_array.push(Buffer.from(cpuEntropy(cpuEntropyBits)));\n  hash_array.push(externalEntropyArray);\n  hash_array.push(browserEntropy());\n  return hash.sha256(Buffer.concat(hash_array));\n}\n/**\n    Adds entropy.  This may be called many times while the amount of data saved\n    is accumulatively reduced to 101 integers.  Data is retained in RAM for the\n    life of this module.\n\n    @example React <code>\n    componentDidMount() {\n        this.refs.MyComponent.addEventListener(\"mousemove\", this.onEntropyEvent, {capture: false, passive: true})\n    }\n    componentWillUnmount() {\n        this.refs.MyComponent.removeEventListener(\"mousemove\", this.onEntropyEvent);\n    }\n    onEntropyEvent = (e) => {\n        if(e.type === 'mousemove')\n            key_utils.addEntropy(e.pageX, e.pageY, e.screenX, e.screenY)\n        else\n            console.log('onEntropyEvent Unknown', e.type, e)\n    }\n    </code>\n*/\n\n\nfunction addEntropy() {\n  assert.equal(externalEntropyArray.length, 101, 'externalEntropyArray');\n\n  for (var _len = arguments.length, ints = new Array(_len), _key = 0; _key < _len; _key++) {\n    ints[_key] = arguments[_key];\n  }\n\n  _entropyCount += ints.length;\n\n  for (var _i = 0, _ints = ints; _i < _ints.length; _i++) {\n    var i = _ints[_i];\n    var pos = entropyPos++ % 101;\n    var i2 = externalEntropyArray[pos] += i;\n    if (i2 > 9007199254740991) externalEntropyArray[pos] = 0;\n  }\n}\n/**\n    This runs in just under 1 second and ensures a minimum of cpuEntropyBits\n    bits of entropy are gathered.\n\n    Based on more-entropy. @see https://github.com/keybase/more-entropy/blob/master/src/generator.iced\n\n    @arg {number} [cpuEntropyBits = 128]\n    @return {array} counts gathered by measuring variations in the CPU speed during floating point operations.\n*/\n\n\nfunction cpuEntropy() {\n  var cpuEntropyBits = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 128;\n  var collected = [];\n  var lastCount = null;\n  var lowEntropySamples = 0;\n\n  while (collected.length < cpuEntropyBits) {\n    var count = floatingPointCount();\n\n    if (lastCount != null) {\n      var delta = count - lastCount;\n\n      if (Math.abs(delta) < 1) {\n        lowEntropySamples++;\n        continue;\n      } // how many bits of entropy were in this sample\n\n\n      var bits = Math.floor(log2(Math.abs(delta)) + 1);\n\n      if (bits < 4) {\n        if (bits < 2) {\n          lowEntropySamples++;\n        }\n\n        continue;\n      }\n\n      collected.push(delta);\n    }\n\n    lastCount = count;\n  }\n\n  if (lowEntropySamples > 10) {\n    var pct = Number(lowEntropySamples / cpuEntropyBits * 100).toFixed(2); // Is this algorithm getting inefficient?\n\n    console.warn(\"WARN: \".concat(pct, \"% low CPU entropy re-sampled\"));\n  }\n\n  return collected;\n}\n/**\n    @private\n    Count while performing floating point operations during a fixed time\n    (7 ms for example).  Using a fixed time makes this algorithm\n    predictable in runtime.\n*/\n\n\nfunction floatingPointCount() {\n  var workMinMs = 7;\n  var d = Date.now();\n  var i = 0,\n      x = 0;\n\n  while (Date.now() < d + workMinMs + 1) {\n    x = Math.sin(Math.sqrt(Math.log(++i + x)));\n  }\n\n  return i;\n}\n\nvar log2 = function log2(x) {\n  return Math.log(x) / Math.LN2;\n};\n/**\n    @private\n    Attempt to gather and hash information from the browser's window, history, and supported mime types.  For non-browser environments this simply includes secure random data.  In any event, the information is re-hashed in a loop for 25 milliseconds seconds.\n\n    @return {Buffer} 32 bytes\n*/\n\n\nfunction browserEntropy() {\n  var entropyStr = Array(randomBytes(101)).join();\n\n  try {\n    entropyStr += new Date().toString() + \" \" + window.screen.height + \" \" + window.screen.width + \" \" + window.screen.colorDepth + \" \" + \" \" + window.screen.availHeight + \" \" + window.screen.availWidth + \" \" + window.screen.pixelDepth + navigator.language + \" \" + window.location + \" \" + window.history.length;\n\n    for (var i = 0, mimeType; i < navigator.mimeTypes.length; i++) {\n      mimeType = navigator.mimeTypes[i];\n      entropyStr += mimeType.description + \" \" + mimeType.type + \" \" + mimeType.suffixes + \" \";\n    }\n  } catch (error) {\n    //nodejs:ReferenceError: window is not defined\n    entropyStr += hash.sha256(new Date().toString());\n  }\n\n  var b = new Buffer(entropyStr);\n  entropyStr += b.toString('binary') + \" \" + new Date().toString();\n  var entropy = entropyStr;\n  var start_t = Date.now();\n\n  while (Date.now() - start_t < 25) {\n    entropy = hash.sha256(entropy);\n  }\n\n  return entropy;\n}\n/**\n  @arg {Buffer} keyBuffer data\n  @arg {string} keyType = sha256x2, K1, etc\n  @return {string} checksum encoded base58 string\n*/\n\n\nfunction checkEncode(keyBuffer) {\n  var keyType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  assert(Buffer.isBuffer(keyBuffer), 'expecting keyBuffer<Buffer>');\n\n  if (keyType === 'sha256x2') {\n    // legacy\n    var checksum = hash.sha256(hash.sha256(keyBuffer)).slice(0, 4);\n    return base58.encode(Buffer.concat([keyBuffer, checksum]));\n  } else {\n    var check = [keyBuffer];\n\n    if (keyType) {\n      check.push(Buffer.from(keyType));\n    }\n\n    var _checksum = hash.ripemd160(Buffer.concat(check)).slice(0, 4);\n\n    return base58.encode(Buffer.concat([keyBuffer, _checksum]));\n  }\n}\n/**\n  @arg {Buffer} keyString data\n  @arg {string} keyType = sha256x2, K1, etc\n  @return {string} checksum encoded base58 string\n*/\n\n\nfunction checkDecode(keyString) {\n  var keyType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  assert(keyString != null, 'private key expected');\n  var buffer = new Buffer(base58.decode(keyString));\n  var checksum = buffer.slice(-4);\n  var key = buffer.slice(0, -4);\n  var newCheck;\n\n  if (keyType === 'sha256x2') {\n    // legacy\n    newCheck = hash.sha256(hash.sha256(key)).slice(0, 4); // WIF (legacy)\n  } else {\n    var check = [key];\n\n    if (keyType) {\n      check.push(Buffer.from(keyType));\n    }\n\n    newCheck = hash.ripemd160(Buffer.concat(check)).slice(0, 4); //PVT\n  }\n\n  if (checksum.toString('hex') !== newCheck.toString('hex')) {\n    throw new Error('Invalid checksum, ' + \"\".concat(checksum.toString('hex'), \" != \").concat(newCheck.toString('hex')));\n  }\n\n  return key;\n}","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { Anchor } from 'ual-anchor'\nimport { Ledger } from 'ual-ledger'\nimport { Scatter } from 'ual-scatter'\nimport { UALProvider, withUAL } from 'ual-reactjs-renderer'\n\nconst chains = [{\n  chainId: 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e',\n  name: 'FIO (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'fiotestnet.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: 'e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473',\n  name: 'Jungle 2 (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'jungle.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: '2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840',\n  name: 'Jungle 3 (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'jungle3.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: 'f11d5128e07177823924a07df63bf59fbd07e52c44bc77d16acc1c6e9d22d37b',\n  name: 'Lynx (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'lynxtestnet.greymass.com',\n    port: 443,\n  }]\n},{\n  chainId: '1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f',\n  name: 'Telos (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'testnet.eos.miami',\n    port: 443,\n  }]\n},{\n  chainId: 'f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12',\n  name: 'WAX (Testnet)',\n  rpcEndpoints: [{\n    protocol: 'https',\n    host: 'waxtestnet.greymass.com',\n    port: 443,\n  }]\n}];\n\nconst getTransaction = (actor, permission, chainId) => {\n  // default contract/action\n  let account = 'eosio.token';\n  let name = 'transfer';\n  // default data\n  let data = {\n    from: actor,\n    to: 'teamgreymass',\n    quantity: getTransactionAmount(chainId),\n    memo: 'ual-anchor-demo'\n  }\n  switch (chainId) {\n    case 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e': {\n      account = 'fio.token'\n      name = 'trnsfiopubky'\n      data = {\n        payee_public_key: 'FIO6smr7ThQMWYBHzEvkzTZdxNNmUwxqh2VXdXZdDdzYHgakgqCeb',\n        amount: getTransactionAmount(chainId),\n        max_fee: 2000000000,\n        actor: account,\n        tpid: null,\n      }\n    }\n  }\n  return {\n    actions: [{\n      account,\n      name,\n      authorization: [{ actor, permission }],\n      data,\n    }],\n  }\n}\n\nconst getTransactionAmount = (chainId) => {\n  let symbol = 'EOS'\n  let quantity = '0.0001'\n  switch (chainId) {\n    case 'f11d5128e07177823924a07df63bf59fbd07e52c44bc77d16acc1c6e9d22d37b': {\n      symbol = 'LNX'\n      quantity = '0.00000001'\n      break\n    }\n    case '1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f': {\n      symbol = 'TLOS'\n      break\n    }\n    case 'f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12': {\n      symbol = 'WAX'\n      quantity = '0.00000001'\n      break\n    }\n    case 'b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e': {\n      return parseInt(0.00000001, 10)\n    }\n  }\n  return `${quantity} ${symbol}`\n}\n\nclass TestApp extends Component {\n  static propTypes = {\n    ual: PropTypes.shape({\n      activeUser: PropTypes.object,\n      activeAuthenticator: PropTypes.object,\n      logout: PropTypes.func,\n      showModal: PropTypes.func,\n    }).isRequired,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      chainId: props.chainId,\n      message: '',\n    }\n  }\n\n  purchase = async () => {\n    const { ual: { activeUser } } = this.props\n    try {\n      const { accountName, chain, requestPermission } = activeUser\n      const { chainId } = chain\n      const demoTransaction = getTransaction(accountName, requestPermission, chainId)\n      const result = await activeUser.signTransaction(demoTransaction, { expireSeconds: 120, blocksBehind: 3 })\n      this.setState({\n        message: `Transfer Successful!`,\n      }, () => {\n        setTimeout(this.resetMessage, 5000)\n      })\n      console.info('SUCCESS:', result)\n    } catch (e) {\n      console.error('ERROR:', e)\n    }\n  }\n\n  resetMessage = () => this.setState({ message: '' })\n\n  renderLoggedInView = () => (\n    <>\n      {!!this.state.message\n        && (\n          <div style={styles.announcementBar}>\n            <p style={styles.baseText}>{this.state.message}</p>\n          </div>\n        )\n      }\n      <button type='button' onClick={this.purchase} style={{ ...styles.button, ...styles.blueBG }}>\n        <p style={styles.baseText}>{`Transfer 0.0001`}</p>\n      </button>\n      <table>\n        <tbody>\n          <tr>\n            <td style={styles.td}>Blockchain</td>\n            <td style={styles.td}>{this.props.ual.chains[0].name}</td>\n          </tr>\n          <tr>\n            <td style={styles.td}>Account</td>\n            <td style={styles.td}>{this.props.ual.activeUser.accountName}</td>\n          </tr>\n          <tr>\n            <td style={styles.td}>Permission</td>\n            <td style={styles.td}>{this.props.ual.activeUser.requestPermission}</td>\n          </tr>\n        </tbody>\n      </table>\n      <button type='button' onClick={this.props.ual.logout} style={styles.logout}>\n        <p>Logout</p>\n      </button>\n    </>\n  )\n\n  renderLoginButton = () => (\n    <button type='button' onClick={this.props.ual.showModal} style={styles.button}>\n      <p style={{buttonText: styles.buttonText, baseText: styles.baseText}}>Login using {this.props.ual.chains[0].name}</p>\n    </button>\n  )\n\n  render() {\n    const { ual: { activeUser } } = this.props\n    return (activeUser) ? this.renderLoggedInView() : this.renderLoginButton()\n  }\n}\n\nclass UALWrapper extends Component {\n  constructor(props) {\n    super(props)\n    const search = window.location.search;\n    const params = new URLSearchParams(search);\n    const chainId = params.get('chain');\n    this.state = {\n      chainId: chainId || chains[0].chainId\n    }\n  }\n  setChain = (event) => this.setState({ chainId: event.target.value })\n  render () {\n    const { chainId } = this.state\n    const { available } = this.props\n    const [ chain ] = available.filter((c) => c.chainId === chainId)\n    if (!chain) {\n      return (\n        <div>Invalid Chain ID</div>\n      )\n    }\n    const anchor = new Anchor([chain], { appName: 'ual-anchor-demo' })\n    const ledger = new Ledger([chain])\n    const scatter = new Scatter([chain], { appName: 'ual-anchor-demo' })\n    return (\n      <div style={styles.container}>\n        <p>\n          <select\n            defaultValue={chainId}\n            onChange={this.setChain}\n            style={styles.select}\n          >\n            {chains.map((chain) => (\n              <option\n                key={chain.chainId}\n                value={chain.chainId}\n              >\n                {chain.name}\n              </option>\n            ))}\n          </select>\n        </p>\n        <UALProvider\n          appName='Anchor + Authenticator Test App'\n          authenticators={[anchor, ledger, scatter]}\n          chains={[chain]}\n          key={chain.chainId}\n        >\n          <TestAppConsumer />\n        </UALProvider>\n      </div>\n    )\n  }\n}\n\nconst styles = {\n  container: {\n    display: 'flex',\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'top',\n    height: '100vh',\n    marginTop: '10vh',\n    flexDirection: 'column',\n  },\n  button: {\n    padding: '10px 60px',\n    backgroundColor: '#EA2E2E',\n    textAlign: 'center',\n    borderRadius: 5,\n    color: '#FFFFFF',\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: '2em',\n  },\n  select: {\n    textAlign: 'center',\n    borderRadius: 5,\n    fontSize: 24,\n    fontWeight: 'bold',\n    width: '200px',\n  },\n  logout: {\n    marginTop: 20,\n  },\n  baseText: {\n    color: '#fff',\n    fontSize: 18,\n  },\n  blueBG: {\n    backgroundColor: '#447DD8',\n  },\n  announcementBar: {\n    width: '100%',\n    padding: '10px 50px 10px 20px',\n    textAlign: 'center',\n    backgroundColor: '#3de13d',\n    top: 0,\n    position: 'absolute',\n    alignItems: 'center',\n  },\n}\n\nconst TestAppConsumer = withUAL(TestApp)\n\nconst App = () => (\n  <UALWrapper available={chains} />\n)\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister()","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar ecurve = require('ecurve');\n\nvar Point = ecurve.Point;\nvar secp256k1 = ecurve.getCurveByName('secp256k1');\n\nvar BigInteger = require('bigi');\n\nvar assert = require('assert');\n\nvar hash = require('./hash');\n\nvar PublicKey = require('./key_public');\n\nvar keyUtils = require('./key_utils');\n\nvar createHash = require('create-hash');\n\nvar promiseAsync = require('./promise-async');\n\nvar G = secp256k1.G;\nvar n = secp256k1.n;\nmodule.exports = PrivateKey;\n/**\n  @typedef {string} wif - https://en.bitcoin.it/wiki/Wallet_import_format\n  @typedef {string} pubkey - EOSKey..\n  @typedef {ecurve.Point} Point\n*/\n\n/**\n  @param {BigInteger} d\n*/\n\nfunction PrivateKey(d) {\n  if (typeof d === 'string') {\n    return PrivateKey.fromString(d);\n  } else if (Buffer.isBuffer(d)) {\n    return PrivateKey.fromBuffer(d);\n  } else if ((0, _typeof2[\"default\"])(d) === 'object' && BigInteger.isBigInteger(d.d)) {\n    return PrivateKey(d.d);\n  }\n\n  if (!BigInteger.isBigInteger(d)) {\n    throw new TypeError('Invalid private key');\n  }\n  /** @return {string} private key like PVT_K1_base58privatekey.. */\n\n\n  function toString() {\n    // todo, use PVT_K1_\n    // return 'PVT_K1_' + keyUtils.checkEncode(toBuffer(), 'K1')\n    return toWif();\n  }\n  /**\n      @return  {wif}\n  */\n\n\n  function toWif() {\n    var private_key = toBuffer(); // checksum includes the version\n\n    private_key = Buffer.concat([new Buffer([0x80]), private_key]);\n    return keyUtils.checkEncode(private_key, 'sha256x2');\n  }\n\n  var public_key;\n  /**\n      @return {Point}\n  */\n\n  function toPublic() {\n    if (public_key) {\n      // cache\n      // S L O W in the browser\n      return public_key;\n    }\n\n    var Q = secp256k1.G.multiply(d);\n    return public_key = PublicKey.fromPoint(Q);\n  }\n\n  function toBuffer() {\n    return d.toBuffer(32);\n  }\n  /**\n    ECIES\n    @arg {string|Object} pubkey wif, PublicKey object\n    @return {Buffer} 64 byte shared secret\n  */\n\n\n  function getSharedSecret(public_key) {\n    public_key = PublicKey(public_key);\n    var KB = public_key.toUncompressed().toBuffer();\n    var KBP = Point.fromAffine(secp256k1, BigInteger.fromBuffer(KB.slice(1, 33)), // x\n    BigInteger.fromBuffer(KB.slice(33, 65)) // y\n    );\n    var r = toBuffer();\n    var P = KBP.multiply(BigInteger.fromBuffer(r));\n    var S = P.affineX.toBuffer({\n      size: 32\n    }); // SHA512 used in ECIES\n\n    return hash.sha512(S);\n  } // /** ECIES TODO unit test\n  //   @arg {string|Object} pubkey wif, PublicKey object\n  //   @return {Buffer} 64 byte shared secret\n  // */\n  // function getSharedSecret(public_key) {\n  //     public_key = PublicKey(public_key).toUncompressed()\n  //     var P = public_key.Q.multiply( d );\n  //     var S = P.affineX.toBuffer({size: 32});\n  //     // ECIES, adds an extra sha512\n  //     return hash.sha512(S);\n  // }\n\n  /**\n    @arg {string} name - child key name.\n    @return {PrivateKey}\n     @example activePrivate = masterPrivate.getChildKey('owner').getChildKey('active')\n    @example activePrivate.getChildKey('mycontract').getChildKey('myperm')\n  */\n\n\n  function getChildKey(name) {\n    // console.error('WARNING: getChildKey untested against eosd'); // no eosd impl yet\n    var index = createHash('sha256').update(toBuffer()).update(name).digest();\n    return PrivateKey(index);\n  }\n\n  function toHex() {\n    return toBuffer().toString('hex');\n  }\n\n  return {\n    d: d,\n    toWif: toWif,\n    toString: toString,\n    toPublic: toPublic,\n    toBuffer: toBuffer,\n    getSharedSecret: getSharedSecret,\n    getChildKey: getChildKey\n  };\n}\n/** @private */\n\n\nfunction parseKey(privateStr) {\n  assert.equal((0, _typeof2[\"default\"])(privateStr), 'string', 'privateStr');\n  var match = privateStr.match(/^PVT_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);\n\n  if (match === null) {\n    // legacy WIF - checksum includes the version\n    var versionKey = keyUtils.checkDecode(privateStr, 'sha256x2');\n    var version = versionKey.readUInt8(0);\n    assert.equal(0x80, version, \"Expected version \".concat(0x80, \", instead got \", version));\n\n    var _privateKey = PrivateKey.fromBuffer(versionKey.slice(1));\n\n    var _keyType = 'K1';\n    var format = 'WIF';\n    return {\n      privateKey: _privateKey,\n      format: format,\n      keyType: _keyType\n    };\n  }\n\n  assert(match.length === 3, 'Expecting private key like: PVT_K1_base58privateKey..');\n\n  var _match = (0, _slicedToArray2[\"default\"])(match, 3),\n      keyType = _match[1],\n      keyString = _match[2];\n\n  assert.equal(keyType, 'K1', 'K1 private key expected');\n  var privateKey = PrivateKey.fromBuffer(keyUtils.checkDecode(keyString, keyType));\n  return {\n    privateKey: privateKey,\n    format: 'PVT',\n    keyType: keyType\n  };\n}\n\nPrivateKey.fromHex = function (hex) {\n  return PrivateKey.fromBuffer(new Buffer(hex, 'hex'));\n};\n\nPrivateKey.fromBuffer = function (buf) {\n  if (!Buffer.isBuffer(buf)) {\n    throw new Error(\"Expecting parameter to be a Buffer type\");\n  }\n\n  if (buf.length === 33 && buf[32] === 1) {\n    // remove compression flag\n    buf = buf.slice(0, -1);\n  }\n\n  if (32 !== buf.length) {\n    throw new Error(\"Expecting 32 bytes, instead got \".concat(buf.length));\n  }\n\n  return PrivateKey(BigInteger.fromBuffer(buf));\n};\n/**\n    @arg {string} seed - any length string.  This is private, the same seed\n    produces the same private key every time.\n\n    @return {PrivateKey}\n*/\n\n\nPrivateKey.fromSeed = function (seed) {\n  // generate_private_key\n  if (!(typeof seed === 'string')) {\n    throw new Error('seed must be of type string');\n  }\n\n  return PrivateKey.fromBuffer(hash.sha256(seed));\n};\n/**\n  @arg {wif} key\n  @return {boolean} true if key is in the Wallet Import Format\n*/\n\n\nPrivateKey.isWif = function (text) {\n  try {\n    assert(parseKey(text).format === 'WIF');\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n/**\n  @arg {wif|Buffer|PrivateKey} key\n  @return {boolean} true if key is convertable to a private key object.\n*/\n\n\nPrivateKey.isValid = function (key) {\n  try {\n    PrivateKey(key);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n/** @deprecated */\n\n\nPrivateKey.fromWif = function (str) {\n  console.log('PrivateKey.fromWif is deprecated, please use PrivateKey.fromString');\n  return PrivateKey.fromString(str);\n};\n/**\n    @throws {AssertError|Error} parsing key\n    @arg {string} privateStr Eosio or Wallet Import Format (wif) -- a secret\n*/\n\n\nPrivateKey.fromString = function (privateStr) {\n  return parseKey(privateStr).privateKey;\n};\n/**\n  Create a new random private key.\n\n  Call initialize() first to run some self-checking code and gather some CPU\n  entropy.\n\n  @arg {number} [cpuEntropyBits = 0] - additional CPU entropy, this already\n  happens once so it should not be needed again.\n\n  @return {Promise<PrivateKey>} - random private key\n*/\n\n\nPrivateKey.randomKey = function () {\n  var cpuEntropyBits = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return PrivateKey.initialize().then(function () {\n    return PrivateKey.fromBuffer(keyUtils.random32ByteBuffer({\n      cpuEntropyBits: cpuEntropyBits\n    }));\n  });\n};\n/**\n  @return {Promise<PrivateKey>} for testing, does not require initialize().\n*/\n\n\nPrivateKey.unsafeRandomKey = function () {\n  return Promise.resolve(PrivateKey.fromBuffer(keyUtils.random32ByteBuffer({\n    safe: false\n  })));\n};\n\nvar initialized = false,\n    unitTested = false;\n/**\n  Run self-checking code and gather CPU entropy.\n\n  Initialization happens once even if called multiple times.\n\n  @return {Promise}\n*/\n\nfunction initialize() {\n  if (initialized) {\n    return;\n  }\n\n  unitTest();\n  keyUtils.addEntropy.apply(keyUtils, (0, _toConsumableArray2[\"default\"])(keyUtils.cpuEntropy()));\n  assert(keyUtils.entropyCount() >= 128, 'insufficient entropy');\n  initialized = true;\n}\n\nPrivateKey.initialize = promiseAsync(initialize);\n/**\n  Unit test basic private and public key functionality.\n\n  @throws {AssertError}\n*/\n\nfunction unitTest() {\n  var pvt = PrivateKey(hash.sha256(''));\n  var pvtError = 'key comparison test failed on a known private key';\n  assert.equal(pvt.toWif(), '5KYZdUEo39z3FPrtuX2QbbwGnNP5zTd7yyr2SC1j299sBCnWjss', pvtError);\n  assert.equal(pvt.toString(), '5KYZdUEo39z3FPrtuX2QbbwGnNP5zTd7yyr2SC1j299sBCnWjss', pvtError); // assert.equal(pvt.toString(), 'PVT_K1_2jH3nnhxhR3zPUcsKaWWZC9ZmZAnKm3GAnFD1xynGJE1Znuvjd', pvtError)\n\n  var pub = pvt.toPublic();\n  var pubError = 'pubkey string comparison test failed on a known public key';\n  assert.equal(pub.toString(), 'EOS859gxfnXyUriMgUeThh1fWv3oqcpLFyHa3TfFYC4PK2HqhToVM', pubError); // assert.equal(pub.toString(), 'PUB_K1_859gxfnXyUriMgUeThh1fWv3oqcpLFyHa3TfFYC4PK2Ht7beeX', pubError)\n  // assert.equal(pub.toStringLegacy(), 'EOS859gxfnXyUriMgUeThh1fWv3oqcpLFyHa3TfFYC4PK2HqhToVM', pubError)\n\n  doesNotThrow(function () {\n    return PrivateKey.fromString(pvt.toWif());\n  }, 'converting known wif from string');\n  doesNotThrow(function () {\n    return PrivateKey.fromString(pvt.toString());\n  }, 'converting known pvt from string');\n  doesNotThrow(function () {\n    return PublicKey.fromString(pub.toString());\n  }, 'converting known public key from string'); // doesNotThrow(() => PublicKey.fromString(pub.toStringLegacy()), 'converting known public key from string')\n\n  unitTested = true;\n}\n/** @private */\n\n\nvar doesNotThrow = function doesNotThrow(cb, msg) {\n  try {\n    cb();\n  } catch (error) {\n    error.message = \"\".concat(msg, \" ==> \").concat(error.message);\n    throw error;\n  }\n};","\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/** Error that is thrown if a LinkPresenter calls the cancel callback. */\n\nvar CancelError =\n/** @class */\nfunction (_super) {\n  __extends(CancelError, _super);\n\n  function CancelError(reason) {\n    var _this = _super.call(this, \"User canceled request \" + (reason ? '(' + reason + ')' : '')) || this;\n\n    _this.code = 'E_CANCEL';\n    return _this;\n  }\n\n  return CancelError;\n}(Error);\n\nexports.CancelError = CancelError;\n/** Error that is thrown if an identity request fails to verify. */\n\nvar IdentityError =\n/** @class */\nfunction (_super) {\n  __extends(IdentityError, _super);\n\n  function IdentityError(reason) {\n    var _this = _super.call(this, \"Unable to verify identity \" + (reason ? '(' + reason + ')' : '')) || this;\n\n    _this.code = 'E_IDENTITY';\n    return _this;\n  }\n\n  return IdentityError;\n}(Error);\n\nexports.IdentityError = IdentityError;\n/** Error that is thrown by session transport. */\n\nvar SessionError =\n/** @class */\nfunction (_super) {\n  __extends(SessionError, _super);\n\n  function SessionError(reason, code) {\n    var _this = _super.call(this, reason) || this;\n\n    _this.code = code;\n    return _this;\n  }\n\n  return SessionError;\n}(Error);\n\nexports.SessionError = SessionError;"],"sourceRoot":""}